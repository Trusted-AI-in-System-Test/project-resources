[
  {
    "title": "Fixedwing RTL failsafe makes the vehicle crash right after takeoff",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/20260",
    "body": "## Describe the bug\r\nWhen running takeoff in SITL without QGC running, the plane immediately goes into failsafe, goes into RTL and then crases\r\n\r\n## To Reproduce\r\nSteps to reproduce the behavior: (Make sure no QGC is running)\r\n1. Start plane SITL simulation\r\n```\r\nmake px4_sitl gazebo_plane\r\n```\r\n2. Command takeoff\r\n```\r\ncommander takeoff\r\n```\r\n\r\n## Expected behavior\r\n- Vehicle should either takes off or rejects the takeoff command\r\n\r\n## Log Files and Screenshots\r\n![plane_bug](https://user-images.githubusercontent.com/5248102/191316218-3a925953-5b73-4fca-82e9-a51dd60b0ded.gif)\r\n- Flight log: https://review.px4.io/plot_app?log=0314e693-cb1e-4675-a7ef-bad36473a129\r\n- Log:\r\n```\r\npxh> commander takeoff\r\npxh> INFO  [commander] Armed by internal command\t\r\nINFO  [tone_alarm] arming warning\r\nINFO  [navigator] Using minimum takeoff altitude: 30.00 m\t\r\nINFO  [fw_pos_control_l1] Takeoff on runway\t\r\nINFO  [commander] Takeoff detected\t\r\nWARN  [commander] Failsafe enabled: no datalink\t\r\nINFO  [commander] Failsafe mode activated\t\r\nINFO  [tone_alarm] battery warning (fast)\r\nINFO  [navigator] RTL: landing at home position.\t\r\nINFO  [navigator] RTL: climb to 589 m (100 m above destination)\t\r\nINFO  [commander] Failsafe mode deactivated\t\r\nWARN  [health_and_arming_checks] Preflight Fail: velocity estimate error\r\nERROR [commander] Critical failure detected: lockdown\t\r\nWARN  [commander] Motor failure detected\t\r\nWARN  [health_and_arming_checks] Preflight Fail: velocity estimate error\r\n```\r\n\r\n## Additional context\r\n",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Issue with heading estimation",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/19846",
    "body": "We are developing a drone with the PX4 firmware, running on a holybro V5x FCU.\r\n\r\nWe have run into an issue which we can't understand within the team, so I am hoping for someone to help us.\r\nThe issue has happened in multiple flights, but can be easiest seen in the following flight log: \r\n[log](https://review.px4.io/plot_app?log=9d997dff-c93e-4d6b-a257-8a581f824e0a)\r\n\r\nThe heading estimate is very unstable (a jump of >90 degrees at the 1:12 mark), after which the drone is almost uncontrollable, since all orientations are messed up. This has started happening repeatedly, but we have also made more than 10 flights before where the issue did not arise.\r\n\r\nI have noticed that the EKFs are also using the internal magnetometer, while it is set at a lower priority and the external magnetometer does produce data.\r\n\r\nIf anyone can assist (even if only giving some pointers on how to analyse this issue) that'd be greatly appreciated.",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "v1.13.0-beta1 UAVCAN Battery Can't Take Off Due to RTL Time Estimate",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/19642",
    "body": "I am unable to take off on v1.13.0-beta1 using a uavcan battery in any mode. As soon as I start throttling up, it throws a \"Remaining flight time low, returning to land\" error and switches into RTL.\r\n\r\nhttps://review.px4.io/plot_app?log=761b3a20-94ae-43d9-aba3-1205751f58ce\r\nhttps://review.px4.io/plot_app?log=25386252-9972-4f8f-bac0-716c54559f68\r\n\r\nBeta on a different non uavcan battery drone. ARK GPS + ARK Flow flies well.\r\nhttps://review.px4.io/plot_app?log=3618593a-4485-4606-9236-2316af742a07\r\n\r\nComparing the two, in the failure case, the RTL Time Estimate values are very low, below 100. But in the working case, the values are in the 1000000's.",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "X500V2 kit Jumps when switching to AltHold",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/19046",
    "body": "After trying to fly with the Holybro X500 V2 kit which flies well with Stabilized mode, I noticed that the drone jumps up and down when switching to Altitude mode. The kit is equipped with Pixhawk 5X. A log is also as below:\r\n\r\nhttps://review.px4.io/plot_app?log=21beb351-f2bb-4767-b71f-725946098ec0\r\n\r\nI found something which might be relevant [here](https://github.com/PX4/PX4-Autopilot/issues/11717) but not sure if it is the case!!! \r\n",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Catapult launch: Motor delay not working",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/18354",
    "body": "PX4 (SW 1.12.3 / HW holibro pixhawk 4)\r\nThe Motor starts immedialtely after launch is detected.\r\nThis causes damage to the propeller, because it hits the catapult.\r\n**Actual behaviour:**\r\nIf Accelerometer threshold > LAUN_CAT_A    then  Motor starts immediately\r\n**Expected behaviour:**\r\nIf Accelerometer threshold > LAUN_CAT_A    then  Motorstart is delayed by value of LAUN_CATMDEL  waits then motors starts.\r\n\r\nParameters: LAUN_CAT_MDEL and LAUN_CAT_T have no effect. Motor startup is not delayed as expected.\r\nhttps://review.px4.io/plot_app?log=e1c738f7-7be6-4f54-9af0-c12667ef83d9\r\nThis was working in 1.9.1\r\n\r\n",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "1.12 Release everything great except Weather Vane",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/17911",
    "body": "**Describe the bug**\r\nsince the beginning of 2021 Weather Vane no longer works and also in the 1.12.0 release. Is there a trick to activate WV, or is something important missing?\r\n\r\n**To Reproduce**\r\nConvergence Airframe\r\ngps+HereFlow\r\nUSB disabled to have enough ram left \r\n(without airspeed sensor)\r\nForward Thrust enabled\r\nEnough wind\r\nenable wv\r\nstart position, mission or rtl\r\n\r\n**Expected behavior**\r\nWV should work and turn the aircraft into the wind from a slight roll inclination.\r\nlike it was in 1.11 with the same setup\r\n\r\n**Log Files and Screenshots**\r\nhttps://review.px4.io/plot_app?log=a8f081af-ee68-42a0-81e4-71768cec0ed2",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Motors spin up to ~1500 pwm when vehicle is armed. [Control Allocation V1.12.0Beta]",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/17220",
    "body": "**The bug**\r\nMotors spin up to ~1500 pwm when vehicle [ Hexacopter Control Allocation V1.12.0Beta] is armed. No response to throttle or stick inputs.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Drone switched on\r\n2. Arm via RC or QGC\r\n3. See motors spin to ~1500 pwm\r\n\r\n**Expected behavior**\r\nMotors spin at idle speed (1075 pwm default)\r\n\r\n**Log Files and Screenshots**\r\nhttps://review.px4.io/plot_app?log=f2aa0437-ef1d-416c-aa16-5c64591922fa\r\n\r\n**Drone :**\r\n- Pixhawk 4, hexacopter\r\n- 6 x motors connected to PX4 IO out, and 6 x servos connected to FMU out\r\n\r\n**Firmware:**\r\n- px4 v1.12.0 beta1 (935c5df)\r\n- Control allocation hexacopter (6003_hexa_x_ctrlalloc)\r\n\r\n**Additional context**\r\n- Tried the same setup with normal hexacopter airframe (6001_hexa_x), the issue did not show up.\r\n- CA_ACTX parameters have MIN 0, MAX 1\r\n- Changing PWM_MAIN_MIN did not affect the issue\r\n- Throttling up and down shows no changes in motor PWM\r\n",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "HITL Simulation very jumpy",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/16670",
    "body": "**Describe the bug**\r\nI performed HITL Simulation with Pixhawk 1 hardware using 1.10.2 firmware version with jMAVsim simulator. The controller performance for a simple mission was very jumpy and not smooth at all.  \r\n\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Flash the [1.10.2 firmware](https://github.com/PX4/PX4-Autopilot/releases/tag/v1.10.2) on Pixhawk 1.\r\n2. Follow the steps mentioned in this [doc](https://docs.px4.io/master/en/simulation/hitl.html#setting-up-hitl)  on how to set up the QGC for HITL.\r\n3. Follow the steps mentioned [here](https://docs.px4.io/master/en/simulation/hitl.html#jmavsim-quadrotor-only) for starting the jMAVSim simulator in HITL mode.\r\n4. Create a simple mission, upload it and start. Follow the instructions mentioned [here](https://docs.px4.io/master/en/simulation/hitl.html#fly-an-autonomous-mission-in-hitl) .\r\n5. Observe the jumpy behaviour\r\n\r\n**Expected behavior**\r\nI expect a smooth controller performance. \r\n\r\n**Log Files and Screenshots**\r\n- The log flight review can be found [here](https://review.px4.io/plot_app?log=ef92140a-b1bc-4c82-80c6-48ccb6224838). \r\n- The video of the quadcopter performing the mission in jMAVSim can be seen [here](https://drive.google.com/file/d/13PI-148FiCjFmpaoCSy16xiPDDERk-RD/view?usp=sharing).\r\n\r\n",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "PX4 Rover, mission mode doesn't work in a real vehicle.",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/16586",
    "body": "**Describe the bug**\r\nIn SITL rover in master mission mode works in qgroundcontrol with takeoff waypoint. but in the a real vehicle in mission mode,\r\nrover stands still. it arms and works in stabilized mode, but does nothing on the mission mode.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Upload any mission to a rover that is working in stabilized mode.\r\n2. switch to mission mode (either from the transmitter or from the qgc )\r\n3. it goes to mission mode (shows in qgc)\r\n4. actuators doesn't respond.\r\n\r\n**Expected behavior**\r\nRover should navigate the mission just like in the SITL\r\n\r\n**Log Files and Screenshots**\r\n\r\nlog file ----> it's on master, i only did change some comments as i was going through the code. \r\nhttps://review.px4.io/plot_app?log=a108e8e8-a0b8-41ce-93b5-8ed9ef1a7720\r\n\r\n\r\n**Rover Hardware\r\n- just a generic rover frame with Pixhawk 4 - px4_fmu_v5 with a brushless motor and an esc.\r\n\r\n\r\n",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "VTOL Tailsitter: Thrust issue during transition",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/16057",
    "body": "**Describe the bug**\r\nWhen we are performing a VTOL transition with a tailsitter type drone We are getting very weird thrust fluctuations. It seems that it's taking two references basically at the same time, I would assume from the MC and FW controllers.\r\nAlso in simulation we don't get this issue.\r\n\r\nMore over @xdwgood also reported this issue on PX4 slack, thus proving that this issue is on upstream PX4 and not custom software.\r\n\r\n**To Reproduce**\r\nUse a VTOL Tailsitter type drone and perform a transition.\r\n\r\n**Expected behavior**\r\nThe thrust reference should be smooth during transition.\r\n\r\n**Log Files and Screenshots**\r\n\r\n![bokeh_plot (6)](https://user-images.githubusercontent.com/11491719/97275750-9ad6c880-1836-11eb-9a59-ae861984b5b8.png)\r\n\r\nhttps://logs.px4.io/plot_app?log=1e0b41e7-79d0-4d75-be15-27168f4274cc\r\n\r\n![bokeh_plot (5)](https://user-images.githubusercontent.com/11491719/97275673-82ff4480-1836-11eb-8d75-1d0fb814896b.png)\r\n\r\nhttps://review.px4.io/plot_app?log=6ce3fbeb-33d0-44db-8232-f3f9dd0f87b2\r\n\r\n**Additional context**\r\n@xdwgood reported that setting MPC_USE_HTE to 0, i.e. disabling the hover throttle estimator, seems to solve the issue. It's still to be confirmed but I'm still creating this issue to keep track of the problem as it should be fixed entirely.\r\n\r\n@sfuhrer @RomanBapst  FYI",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "hovergames disarm in air",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/15810",
    "body": "\r\nhttps://review.px4.io/plot_app?log=37ee74be-7c86-41b9-b172-115dcd91cd5b\r\nhttps://www.youtube.com/watch?v=6e8kV0kW_Gk\r\n\r\n![Screenshot from 2020-09-24 11-12-02](https://user-images.githubusercontent.com/84712/94164261-d0168200-fe56-11ea-9e45-b9f9e6f2eb65.png)\r\n\r\nhttps://github.com/PX4/Firmware/pull/13992#issuecomment-698317062\r\n\r\n@igalloway ",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "USB connection is only accessible if connected in a window of few seconds",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/15667",
    "body": "**Describe the bug**\r\n\r\nIf we do not connect the USB to a consumer right after the bootloader, once the RGB LED starts breathing blue (in a window of few seconds), the Pixhawk is inaccessible, no message can be received or sent anymore, but the TTY ACM driver is still up and running, thinking it can communicate.\r\n\r\nI could replicate the exact same behavior going one level down, using `libusb1.0` instead of using the kernel `usb-cdc-acm` driver but the exact same behavior happened. This seems to indicate that the last burst would come from the Pixhawk's buffer and not the tty driver buffer. As the log shows below, if nobody subscribes to the data in `/dev/ttyACM0`, the USB connection is not initialized.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Power the Pixhawk with the USB\r\n2. Wait for the LED to be blue breathing\r\n3. Wait an additional 10 seconds\r\n4. Try to connect Mavros, QGc or `cat /dev/ttyACM0`\r\n5. When connecting, few messages are received\r\n6. The connection hangs: No message can be sent or received\r\n\r\nSteps to reproduce the behavior after successful connection:\r\n1. Power the Pixhawk with the USB\r\n2. Wait for the LED to be blue breathing\r\n3. ~Wait an additional 10 seconds~\r\n4. Try to connect Mavros, QGc or `cat /dev/ttyACM0`\r\n5. The connection is successful and can be used for any time you want\r\n6. Disconnect (stop the node)\r\n7. Wait 10 seconds\r\n8. Try to reconnect with the same method\r\n9. When connecting, few messages are received\r\n10. The connection hangs: No message can be sent or received\r\n\r\n**Expected behavior**\r\n\r\nSteps to reproduce the behavior after successful connection:\r\n1. Power the Pixhawk with the USB\r\n2. Wait for the LED to be blue breathing\r\n3. You can wait any time you want before connecting\r\n4. Try to connect Mavros, QGc or `cat /dev/ttyACM0`\r\n5. The connection is successful and can be used for any time you want\r\n\r\n**Log Files and Screenshots**\r\n\r\n`sudo apt install vusb-analyzer usbmon`\r\n\r\nFollowing a USB log file showing the problem. The Pixhawk in this log is DEV 1018. To view it, download it, rename it to remove the `.txt` and open it with vusb-analyzer:\r\n\r\n[usbmon.mon.txt](https://github.com/PX4/Firmware/files/5160810/usbmon.mon.txt)\r\n\r\n```bash\r\nmv usbmon.mon.txt usbmon.mon # .mon files are not supported on Github\r\nvusb-analyzer usbmon.mon\r\n```\r\n\r\n*History of the log:*\r\n* `0.00s`: Start the log\r\n* `6.00s`: Connect Pixhawk\r\n* `12.50s`: Pixhawk left the Bootloader (CDC driver advertised)\r\n* `13.50s`: Mavlink node started on `/dev/ttyACM0` (showing normal behavior)\r\n* `21.25s`: Mavlink node manually stopped\r\n* `37.70s`: Mavlink node started on `/dev/ttyACM0` (showing a stuck behavior)\r\n    * The messages **do contain data**\r\n\r\nNormal start:\r\n![image](https://user-images.githubusercontent.com/6976744/91954802-998b9280-ed02-11ea-9220-a5228873eb45.png)\r\n\r\nFailing start:\r\n![image](https://user-images.githubusercontent.com/6976744/91954851-ac05cc00-ed02-11ea-973e-404da6cb89f4.png)\r\n\r\nExample log https://review.px4.io/plot_app?log=85f3ab21-074b-4a19-9baa-820d606824c2\r\n\r\n**To reproduce the log:**\r\n\r\n```bash\r\nsudo su\r\nmodprobe usbmon\r\ncat /sys/kernel/debug/usb/usbmon/1u > usbmon.mon\r\n```\r\n\r\n**Drone:**\r\n- Pixhawk 1 (original 3DR)\r\n- Firmware: px4_fmuv2_default 1.11.0, also tested (same error) on 1.9.0\r\n",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Possible attitude estimation bug",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/15612",
    "body": "**Describe the bug**\r\n[Flight 1](https://review.px4.io/plot_app?log=70d80c6c-46f4-4d45-a710-bcc0ed0cae1c)\r\nAfter ~30s of full manual indoor flight (~5m height above floor), the estimated attitude began to drift significantly in the roll angle (even in pitch, but not so much), even though the pose desired by the pilot was the hover state. The pilot tried to compensate by tilting the drone in the opposite direction, however, he reached the limit position of the roll stick on the RC and the roll still continued to drift. The high velocity led to a rough crash into a wooden bench. There was no RC signal loss and we checked that the RC had no trims and subtrims in effect.\r\n\r\nThis was the first time we experienced this behavior after ~4 years working with PX4 firmware.\r\n\r\n[Flight 2](https://review.px4.io/plot_app?log=5dc3d4bb-5c16-4ec6-b7ad-17f2456e4f3b)\r\nThe second incident we had was the next day on the same location with different hardware, but the same symptoms. After ~30s of manual flight in altitude mode (~5m height above floor) the UAV started tilting uncontrollably and then crashed into a wall. Again no RC signal losses, no trims and subtrims. We were even flying with this platform the same day in the morning for ~10 minutes without any issues [(OK Flight)](https://review.px4.io/plot_app?log=e0c02122-4335-4ce3-ab3d-598a38e98c7f).\r\n\r\nPlease find attached logs and description of the hardware in the following sections. My colleague will also upload a video which compares the PX4 estimated attitude with the correctly estimated attitude obtained from a custom attitude estimator run on the recorded IMU flight data.\r\n\r\nWhat is the cause of this behavior? Could there be a bug in the attitude estimator that only manifests in some highly specific conditions? Is there some problem apparent from the logs that we are missing?\r\n\r\nPlease ask for any relevant additional information that could help solving the issue. Until we resolve this issue we cannot fly indoor in this setup, because it is too unreliable and dangerous.\r\n\r\n**To Reproduce**\r\nWe tried to reproduce the behavior in lower height above floor with another drone with the same setup as in the first flight without success. \r\n\r\n**Log Files and Screenshots**\r\n[Flight 1](https://review.px4.io/plot_app?log=70d80c6c-46f4-4d45-a710-bcc0ed0cae1c)\r\n[Flight 2](https://review.px4.io/plot_app?log=5dc3d4bb-5c16-4ec6-b7ad-17f2456e4f3b)\r\n[OK Flight](https://review.px4.io/plot_app?log=e0c02122-4335-4ce3-ab3d-598a38e98c7f)\r\n\r\n**Drone (please complete the following information):**\r\n\r\n***Flight 1***\r\n- Frame: Quadrotor Tarot T650\r\n- Total mass: 3.5 kg\r\n- Motors: Tarot 4114-11 320KV\r\n- ESCs: BL-Heli 32 50A\r\n- FCU: Pixhawk 4 (PX4 FW v1.10.1)\r\n   - attached to the frame by screws\r\n- RC: Hi-Tec Flash 8\r\n- RC receiver: Optima SL\r\n\r\n***Flight 2***\r\n- Frame: Custom coaxial octarotor\r\n- Total mass: 5.5 kg\r\n- Motors: T-Motor MT2814-11 710KV\r\n- ESCs: FOXY Multi 30A Opto V2015\r\n- FCU: Pixhawk 2.1 Cube (PX4 FW v1.10.1)\r\n   - attached to the frame by foam dampeners\r\n- RC: Hi-Tec Aurora 9\r\n- RC receiver: Optima SL\r\n\r\n**Additional context**\r\n- Magnetometer fusion was turned off for both flights\r\n- All components were used previously in many flights\r\n- Calibration of accelerometers, gyroscopes and level horizon was done the day before the first incident",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Failed to transition from TAKEOFF to MISSION",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/15471",
    "body": "While testing PR #15083 the vehicle was commanded to execute a mission, took off but failed to transition from Takeoff to Mission.\r\n\r\nA workaround was to pause the mission and then continue the mission.\r\n\r\nVehicle used: Holybro S500 with Pixhawk 4 and Drotek GPS.\r\n\r\nMission with RTL\r\nIn 4/5 missions the vehicle tookoff and didn't went to the next waypoint, I think is related to the issue of the auto-takeoff, land flights. I needed to pause the mission or switch different flight mode and then click continue mission.\r\nhttps://review.px4.io/plot_app?log=d2dc82d7-0024-4562-b8dc-2edf5e4bbf22\r\nhttps://review.px4.io/plot_app?log=b1762b52-0ce7-4231-8f66-004e334ccdf2\r\nhttps://review.px4.io/plot_app?log=7d6db655-f099-4d24-9de9-878498a6cace <- log with no issue\r\nhttps://review.px4.io/plot_app?log=dbb8da1c-8f3f-4e56-91a3-ee9ed80b6585\r\nhttps://review.px4.io/plot_app?log=936188a2-8917-4c4e-9820-a519e949d8ba\r\n",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Drone Crash: Motors shutdown on fly",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/15347",
    "body": "During some flight test we had an hexarotor crash. All the motors stopped suddenly and the machine crashed on the ground.\r\nWe right now can't explain such a behavior.\r\nHere is the flight log: https://review.px4.io/plot_app?log=f177f3be-1ffc-4040-a86d-5831aefa752c\r\nCan you guys spot any SW related issue?\r\nThe firmware is based on bcce75e691657e7da06ff1bf88fc878eb026c92b. It's an April master commit.\r\nThe modification we made to the firmware are minors and do not related to navigation. I do not think they can explain such a think.",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Poor Fixed wing runway takeoff tracking ",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/14851",
    "body": "Fixed wing runway takeoff tracking is very poor on various firmwares and aircraft types that i've been testing and had others test.\r\n\r\nI've compiled some notes and logs on this and it was even brought up (in a different context) in https://github.com/PX4/Firmware/issues/11785 but the more we look at it, the more this is a true issue and from a practical standpoint is making using autonomous takeoff not feasible given the high risk.\r\n\r\nLet me also preface this by saying a many things have been tested and changed and a makeshift solution was come up with as well but that doesn't solve the problem. Wheel Rate settings have been altered to various extreme and subdued amounts (as seen in the logs). This has reduced some things present like sudden full wheel deflection upon mission start but it never fixes the trajectory of the takeoff and that it does not generally point or aim to the takeoff waypoint but goes off course many time more than it does not.\r\n\r\nMultiple different aircraft and aircraft types were used, even though the mixer is the same, that is only because we have varying sizes and weights of test aircraft and even foam ones where the setup, weight and geometry on the nose gear and linkages is completely different (which is good to rule out a single hardware type or build as the culprit).\r\n\r\nI often have seen the wheel channel output (main 5) swing up and down 500us over neutral, essentially max on both extremes and even when that isnt having the same type of behavior exists at +/200. The scaling factor probably helps in these cases by reducing movement (so long as you are still on course enough or at least not going to crash on takeoff) but the thing to remember is this entire process is only 3-8 seconds long before you're airborne so it's easy to not see or overlook.\r\n\r\nThe hacked solution? Limit min/max pwm value of the wheel servo either in PX4 or at the servo level to limit how much steering can physically occur. This is not a solution but gets things airborne by quasi limiting the ability to go off course. Not a true solution.\r\n\r\nLogs:\r\n\r\nhttps://review.px4.io/plot_app?log=efad594a-afe0-451a-a1dd-a6130e49a03b\r\nThis log has an sudden full right wheel right as the mission is initiated.\r\n\r\n<img width=\"815\" alt=\"Screen Shot 2020-05-06 at 4 09 07 PM\" src=\"https://user-images.githubusercontent.com/31726584/81230497-38072180-8fb7-11ea-9942-27b46c07db99.png\">\r\n\r\nhttps://review.px4.io/plot_app?log=25ce0df8-15d6-4591-8578-83042921cffe - This is similar but not as severe as the previous log (still has huge wheel swings though).\r\n\r\nhttps://review.px4.io/plot_app?log=53e17faa-3f52-4a3f-8e7e-b2d8c8ede219 - This log is interesting that the aircraft was purposely moved to the corner of the runway because the previous flights had it going to the right during the takeoff portion and it sill went much too hard right and then off the runway.\r\n\r\n<img width=\"825\" alt=\"Screen Shot 2020-05-06 at 4 35 30 PM\" src=\"https://user-images.githubusercontent.com/31726584/81230726-a1873000-8fb7-11ea-846f-1522b97372cc.png\">\r\n\r\n\r\nhttps://review.px4.io/plot_app?log=ee6bef2c-167c-4d43-ae96-8ac2144df2e1 - This takes off successfully because of the large area, thats the only reason. There is video of the takeoff if need be.\r\n\r\nhttps://review.px4.io/plot_app?log=bc807a89-07c1-44ac-836b-7d9e09ee7d0a - This log actually doenst look as bad except if you zoom out and look at the first waypoint, it's still off to the left.\r\n\r\n\r\nhttps://review.px4.io/plot_app?log=668ab1af-c9f8-4c30-b6fb-f26b998c85b4 - This log takes off successfully but zoom into the wheel output. It's successful because the area used was large and it has the time and room to recover and/or just get airborne.\r\n\r\nhttps://review.px4.io/plot_app?log=bac42025-4d70-45d3-ae4c-39c781328b01 This was a taxi test but still shows rapid oscillation (so throttle is only at 30%).\r\n \r\n<img width=\"811\" alt=\"Screen Shot 2020-05-06 at 4 48 22 PM\" src=\"https://user-images.githubusercontent.com/31726584/81231820-6c7bdd00-8fb9-11ea-84cd-6ed33cc17f38.png\">\r\n\r\nhttps://review.px4.io/plot_app?log=cbb044ac-211d-49f9-86b9-3d0702427cbe - Same place, post taxi test (same wheel rate settings) and less rapid oscillation but still really bad, had to abort since about to go off runway.\r\n\r\n<img width=\"813\" alt=\"Screen Shot 2020-05-06 at 5 01 44 PM\" src=\"https://user-images.githubusercontent.com/31726584/81233100-b5cd2c00-8fbb-11ea-9a40-f8fe560be6eb.png\">\r\n\r\nhttps://review.px4.io/plot_app?log=08ff0f58-b264-49b0-a694-58eab9b76ffd\r\n\r\n\r\nhttps://review.px4.io/plot_app?log=bd117170-1dca-42a8-a309-58b537296419\r\n\r\nBelow are a collection more, some are very extreme, some less. Multiple combinations of the wheel rate parameters were altered but this still represents multiple settings where oscillation occurred severely.\r\n\r\nhttps://review.px4.io/plot_app?log=7758631a-a5ae-4ead-97b4-f496cfa2a3c8\r\nhttps://review.px4.io/plot_app?log=10e31631-552f-4585-b1f4-bc73da6ac094\r\nhttps://review.px4.io/plot_app?log=75486b4a-385b-47a6-a851-c54ae909c077\r\nhttps://review.px4.io/plot_app?log=d6d43381-14ac-4ba7-9cf2-f9b68d0ed7b7\r\nhttps://review.px4.io/plot_app?log=b0be9c38-62e5-4cee-9f2e-9c40b603c143\r\nhttps://review.px4.io/plot_app?log=c1dcab38-8c6b-42a8-91a2-4e89ab1ec26a\r\nhttps://review.px4.io/plot_app?log=6130efca-f4dd-4a81-b648-f1ed5424f585\r\n https://review.px4.io/plot_app?log=e7e3027f-8cf0-4ef8-ace5-640383a2775b\r\nhttps://review.px4.io/plot_app?log=6130efca-f4dd-4a81-b648-f1ed5424f585\r\nhttps://review.px4.io/plot_app?log=7c70673a-5d26-4996-9de1-35e1b1633d3c\r\n\r\n@dagar - as discussed\r\n\r\n\r\n\r\n",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Misfire at catapult launch (custom FW version 1.7.2)",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/14838",
    "body": "**Describe the bug**\r\nFrom 55 test flights we had 2x misfire at catapult launch. It looks like PWM was not send on ESC and motor didn't start. I need suggestion what to check in ulg files.\r\n\r\n**To Reproduce**\r\nWe do not know how to reproduce.\r\n\r\n**Expected behavior**\r\nMotor should always start at catapult launch\r\n\r\n**Log Files and Screenshots**\r\nULG files\r\n[misfire2x.zip](https://github.com/PX4/Firmware/files/4583095/misfire2x.zip)\r\nor\r\nhttps://review.px4.io/plot_app?log=530849b9-21cb-4097-9acb-cf0d311b97bf\r\nhttps://review.px4.io/plot_app?log=b78cdaff-b13b-43a9-8d57-0168c43b90e7\r\n\r\n**Drone (please complete the following information):**\r\nhttps://www.unmannedtechshop.co.uk/product/unmanned-pixhawk-autopilot-kit/\r\npixhawk 2 fmuv2\r\nStack: PX4 Pro\r\nVehicle: Fixed wing\r\nFW Version: 1.7.2 custom build\r\n",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Unstable GPS data while using the 2nd telemetry on TELEM2 port - v1.11.0-beta1",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/14659",
    "body": "**Describe the bug**\r\nHi, I found very strange GPS behavior after uploaded \"v1.11.0-beta1\" to pixhawk 4. Firstly, I configured MAV_1_CONFIG = TELEM2 (My UAV has been flown using this config. before since firmware v1.8.2, v1.9.2 and v1.10.2 and I got no error). Then, I investigated using\"mavlink inspector\" in QGC and take a look at GPS_RAW_INT. \r\n\r\nGPS signal seems unstable, the fluctuation ranges from 0 to 5 Hz. It should be a constant value or nearly constant (compared with an older firmware, I have already tested before).\r\n\r\nFinally, the result is the flight mode could not be changed from ALTITUDE to POSITION, No Green GPS LED light visible. I managed the test as follows \r\n\r\n**To Reproduce / Test Case**\r\nCase 1: v1.11.0-beta1 --> OK\r\nMAV_1_CONFIG = Disabled\r\nhttps://review.px4.io/plot_app?log=9764baca-ec06-40aa-b1ba-79719d0b75fc\r\n\r\nCase 2: v1.11.0-beta1 --> Error / ubx msg warning\r\nMAV_1_CONFIG = TELEM2\r\nhttps://review.px4.io/plot_app?log=a670c429-592e-4e52-a200-b811bd45f14d\r\n\r\nCase 3: v1.11.0-beta1 --> OK\r\nMAV_1_CONFIG = TELEM/SERIAL4 \r\nhttps://review.px4.io/plot_app?log=98b8c1ec-d492-48b5-823a-870af29e5686\r\n\r\nCase 4:  v1.11.0-beta1 --> Error / ubx msg warning\r\nMAV_2_CONFIG =  TELEM2  \r\n\r\nCase 5: v1.11.0-beta1 --> OK\r\nMAV_2_CONFIG =  TELEM/SERIAL4 \r\n\r\nCase 6: v1.11.0-beta1 --> Error / ubx msg warning\r\nMAV_1_CONFIG = TELEM/SERIAL4 \r\nMAV_2_CONFIG =  TELEM2  \r\n\r\nCase 7: v1.10.1 --> OK (compare to Case 2 v1.11.0-beta1. It is not the same result even config. is the same)\r\nMAV_1_CONFIG = TELEM2\r\nhttps://review.px4.io/plot_app?log=29bea816-da9d-4cd4-b042-c0fdb14e489d\r\n\r\nThe error is the same whether telemetry is available on that port or not, indoor or outdoor if I configure MAV_X_CONFIG to TELEM2. According to the flight log of Case 2, you will see the strange GPS behavior at \"GPS Uncertainty and GPS Noise & Jamming\". In every test case, Telemetry works fine.\r\n\r\nHowever, GPS works fine if I upload the older firmware \"v1.10.1\" (v1.8.2 / v1.9.2 is the same) Is it firmware bug ? or Did I miss anything?\r\n\r\n**Drone (please complete the following information):**\r\n- Describe the type of drone: Tiltrotor using E-flite Convergence airframe\r\n- Hardware: Pixhawk4 + GPS pixhawk 4 + Holybro telemetry\r\n\r\n",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "bad altitude hold v1.11.0-beta1 vs v1.10.0",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/14640",
    "body": "User reported worse altitude hold after upgrading from PX4 stable v1.10.0 to the current v1.11 beta.\r\n\r\n### v1.10.1\r\n - https://review.px4.io/plot_app?log=664c4e7a-9bb1-423f-935f-5abbf69f6170\r\n - (**new 2020-04-22**) https://review.px4.io/plot_app?log=d26da1f6-24a8-43e3-aadc-0bf5a634d86f\r\n\r\n### master (slightly before v1.11.0-beta1 with old IMU drivers)\r\n - https://review.px4.io/plot_app?log=ba162746-c163-4b68-9259-251410e4d053\r\n\r\n### v1.11.0-beta1\r\n - (windy): https://review.px4.io/plot_app?log=c27b7984-de30-4f85-ac27-4b6083007d02\r\n - (windy): https://review.px4.io/plot_app?log=672dcf31-f717-4136-830e-e20fd5e80038\r\n - https://review.px4.io/plot_app?log=047d7d42-f16f-4dfd-a9a2-33613455eeeb\r\n - (**new 2020-04-22**): https://review.px4.io/plot_app?log=e625d55b-613c-43f8-bad7-ce666000b264\r\n - (**new 2020-04-22**): EKF2_HGT_MODE=GPS https://review.px4.io/plot_app?log=7f123d8b-0c5d-4188-88b8-df5752340d4d\r\n - (**new 2020-04-22**): EKF2_BARO_NOISE baro noise tuning: https://review.px4.io/plot_app?log=d178c0b5-b863-4038-bead-9026c0a0a598\r\n\r\n\r\n### Local Position Z (v1.10.0 vs v1.11.0-beta1)\r\n![Screenshot from 2020-04-10 11-16-18](https://user-images.githubusercontent.com/84712/79001600-bb4e6800-7b1c-11ea-90c8-4d77405c2f78.png)\r\n\r\n### Velocity Z (v1.10.0 vs v1.11.0-beta1)\r\n![Screenshot from 2020-04-10 11-18-58](https://user-images.githubusercontent.com/84712/79001772-1d0ed200-7b1d-11ea-92f9-e6196679637f.png)\r\n",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Battery emergency RTL initiate climb command, even if drone already landing",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/14479",
    "body": "**Describe the bug**\r\nI found on a flight that I have came to nearly empty battery that there is something that look to me like bug in the emergency and critical battery logic.\r\nI started to land in nearly empty battery, but then the emergency battery logic intiated, and instead of continue landing, it started to RTL (climbing), I took control to RC and landed.\r\nit seems that COM_LOW_BAT_ACT doesn't respect the current flight mode, and if the drone has already started to land, it can re-initiate action, that might be climbing.\r\n\r\n**To Reproduce**\r\n * in order to reproduce easily in simulator I have changed the next parameters:\r\nBAT_LOW_THR = 30%\r\nBAT_EMERGEN_THR  = 20%\r\nBAT_CRIT_THR = 10%\r\nCOM_LOW_BAT_ACT = 3 (Return mode at critically low level, Land mode at current position if reaching dangerously low levels)\r\nRTL_RETURN_ALT = 100m\r\nSIM_BAT_MIN_PCT = 0%\r\n\r\n * take-off\r\n * fly to another location\r\n * climb to 20m\r\n * wait that the battery will get to ~30% and start land\r\n * the RTL will be initiated, starting with climbing (and here the bug)\r\n\r\n**Expected behavior**\r\nin case of already started landing, don't initiate RTL. and don't re-initiate landing\r\n\r\n**Log Files and Screenshots**\r\nhttps://review.px4.io/plot_app?log=c50117f1-3f81-4141-af5f-5e905ea239e5\r\n![image](https://user-images.githubusercontent.com/29940676/77550563-ecdaf880-6eb9-11ea-8598-910b5f52d097.png)\r\n\r\n\r\n**Drone (please complete the following information):**\r\n- simulation (master 25/3/2020)\r\n",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Fixed-wing position controller not ouputting attitude setpoints if GPS switched off in altitude mode",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/14243",
    "body": "**Describe the bug**\r\nFixed-wing altitude mode doesn't work without GPS data because it seems to run only with a [valid global position](https://github.com/PX4/Firmware/blob/18754225c93ee18c76c227cc66f687835e4a0046/src/modules/fw_pos_control_l1/FixedwingPositionControl.cpp#L1481). \r\nIt is though currently possible to switch to altitude flight mode (at least for a VTOL) without a GPS connected.\r\n\r\n**To Reproduce**\r\nIn sitl, fly a VTOL in fixed-wing mode or a plane, and disable GPS fusing in air by setting the EKF2_AID_MASK to 0. Switch to stabilized and back to altitude mode.\r\n\r\n**Expected behavior**\r\nI expect that altitude flight mode works without issues after a GPS loss (at least with valid baro data).\r\nTill we have that we should disable the ability to switch to altitude flight mode if you don't have a valid global position (resp. for VTOL disable transition to FW mode in altitude mode).\r\n\r\n**Log Files and Screenshots**\r\nThis is a sitl flight where I disabled GPS fusing in air (by setting the EKF2_AID_MASK to 0). When then switching out and in again into altitude flight mode, the attidue sp and control signals are frozen. \r\nhttps://review.px4.io/plot_app?log=3cfedd2d-14e0-4f6f-8afd-781823577aa6\r\n\r\nAdd screenshots to help explain your problem.\r\n\r\n**Additional context**\r\nI became aware of this problem recently while flying a VTOL without GPS sensor.\r\n\r\nShould we maybe split TECS and L1 into separate modules @RomanBapst @dagar ? Just as an effort to disentangle this all a bit.\r\n",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Issue with landing PixRacer FMUV4_K66, FMUv5",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/13956",
    "body": "**Describe the bug**\r\nWhen flying the vehicle in Mission mode and trigger RTL, upon landing the vehicle does not descend vertically but drifts away with the wind. I had to take command of the vehicle in position mode and landed the vehicle manually. This is an issue that we have seen constantly, with the PixRacer and K66, FMUv5. **We are seeing this issue when the wind is 6 m/s and over.** \r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Drone switched on \r\n2. Uploaded mission to the vehicle\r\n3. Took off in Mission Mode \r\n4. All commands were sent form QGC (Armed and takeoff)\r\n5. Once all waypoint completed vehicle switched to RTL\r\n6. When the vehicle was landing, it did not descend vertically, drifted away with the wind and landed the vehicle manually\r\n\r\n**Expected behavior**\r\nThe vehicle should land and disarm.\r\n\r\n**Log Files and Screenshots**\r\nThis is the latest PR tested with the PixRacer and issue persisted, Reference [#13678](https://github.com/PX4/Firmware/pull/13678)\r\nLogs: https://review.px4.io/plot_app?log=67a2120c-a473-43a3-a556-6a542f62f7b1\r\n\r\nIssue noticed on Reference  [#13701](https://github.com/PX4/Firmware/pull/13701\r\n), wind 10.2 m/s, PixRacer.\r\n\r\nIssue noticed on Reference [#13745](https://github.com/PX4/Firmware/pull/13745#event-2883456760), wind 10.2 m/s, PixRacer V4.\r\nLog: https://review.px4.io/plot_app?log=719ab88b-d993-47c8-a9ca-eaf429d4577e\r\n\r\nIssue noticed on Reference [#13613](https://github.com/PX4/Firmware/pull/13613#event-2837043850), 10.2 m / s, PixRacer V4.\r\nLogs: https://review.px4.io/plot_app?log=b0f1f872-fc9e-41ee-89e3-4e146862efc7\r\nLog: https://review.px4.io/plot_app?log=a8a1391c-06c0-475e-943a-48bea5da2e24\r\n\r\nIssue noticed on Reference [#13065](https://github.com/PX4/Firmware/pull/13065), NXP_FMUK66_V3, \r\nLogs: https://review.px4.io/plot_app?log=792db7ac-8738-4bdd-8a03-aa6d88b371b3\r\n\r\n\r\n**Drone (please complete the following information):**\r\n**PixRacer**\r\nFrame: DJI F450\r\nFlight Controller: PixRacer \r\nGPS: Readytosky M8N GPS Module Built-in Compass\r\nMotors: T Motor 2212-920kv\r\nPropellers: DJI Phantom Built-in Nut Upgrade Propellers - MR PH 9.4x5 \r\nReceiver: FrSky D4R-II 2.4G 4CH ACCST Telemetry Receiver\r\nTelemetry:Holibro Telemetry, 100mW Telemetry Radio V3 915MHz\r\nESC: Hobbywing XRotor 20A APAC Brushless ESC\r\nBattery: 3S 5200mAh(Hobbyking)\r\n\r\n**NXP:**\r\nVehicle description:  RDDRONE-FMUK66\r\nFlight Controller: FMUK66 \r\nFrame: ReadytoSky LJI X4 500\r\nMotors: ReadytoSky RS2212 920 kV CW & CCW  \r\nPropellers: LJI 9450 self-locking propellers\r\nGPS: Holybro Pixhawk 4 GPS\r\nESC: ReadytoSky 2-6S 40 A OPTO ESCs\r\nBattery: 3S 5200mAh \r\n\r\n**Additional context**\r\nWe will test when windy on Master and Stable and see if the issue persists. ",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Pixhawk 3 Pro v4_ failed connection to the RC",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/13892",
    "body": "**Describe the bug**\r\nThe vehicle did not connect to RC, it would not let the user bind the RC nor calibrate, the same issue was noticed on Master it seems to be working on Stable firmware. This is a brand new flight controller shipped from Drotek, the previous flight controller had bad vibrations and the mag data looked bad. We suspect the issue was something electrical and the flight controller was replaced. Now we are having a failed connection to the RC.  \r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\nBinding Procedure:\r\n\r\nRC Steps:\r\n1- Turn on RC\r\n2- Activate Biding mode (RC will make beeping sounds)\r\n\r\nVehicle Steps:\r\n\"With the vehicle turned on\"\r\n1- Unplug the receptor\r\n2- Press Binding button and keep pressed\r\n3- Plug in receptor (without letting the binding button go) and make sure both red and green light of the receptor are turned on.\r\nRC Step\r\n1- Disable binding mode\r\nVehicle Step:\r\n1- Confirm binding by having the receptor with a solid green light on (algo confirm by moving flight modes switches.)\r\n\r\n**Log Files and Screenshots**\r\nPR13837: https://review.px4.io/plot_app?log=51c918b7-763c-41c8-b7c8-4a162be0fd3d\r\nMaster: https://review.px4.io/plot_app?log=e9b18b85-685e-4f30-8931-9bfdafbc159a\r\n![81888019_596289817600621_1788273439723749376_n](https://user-images.githubusercontent.com/39415493/72025384-ce575080-322c-11ea-88b9-ac3ce3e1d483.jpg)\r\n![81572634_469390607331633_522361898293788672_n](https://user-images.githubusercontent.com/39415493/72025419-ea5af200-322c-11ea-8ee1-09cbf3c265b8.png)\r\n![83031236_1268661076637838_3741699096512036864_n](https://user-images.githubusercontent.com/39415493/72025421-ec24b580-322c-11ea-8d17-60e68567841b.png)\r\n\r\n**Drone Information**\r\n- Pixhawk 3 Pro v4\r\n- DJI F450 Frame\r\n- CUAV GPS\r\n\r\n**Additional context**\r\n Below is the last working logs on Master for the Pixhawk Pro. The PixRacer seems to be working fine.\r\nFlight card 1\r\nLog: https://review.px4.io/plot_app?log=35d59e70-c3f1-4bfc-a76a-ec8de20261c3\r\nFlight card 2\r\nLog: https://review.px4.io/plot_app?log=0ebede1a-549f-4638-af23-7dcfe365e371\r\nFlight card 3\r\nLog: https://review.px4.io/plot_app?log=5bbb5e95-acd1-4fd1-a78d-5f2e028d8fb7\r\nFlight card 4\r\nLog: https://review.px4.io/plot_app?log=81e3f2bd-bcca-4263-9b00-20f9beea0d6a\r\n\r\n@dagar ",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Altitude Fluctuation in Constant-Altitude Missions",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/13793",
    "body": "**Describe the bug**\r\nWhen flying a basic mission with constant-altitude waypoints, the drone’s altitude erroneously fluctuates. Our use-case requires a much more reliable altitude for precision deployment of sensors. Let me know if you can/can't reproduce this issue.\r\n\r\n![altitudegrpah2](https://user-images.githubusercontent.com/33331023/71501357-f2736480-281e-11ea-87d5-d1f1c158680b.PNG)\r\n\r\nNotice how the estimated altitude doesn't follow the setpoint altitude in mission mode (purple region), but it follows exactly in position mode (green region). This shows that the instruments and sensors are capable of producing altitude-accurate flight.\r\n\r\nI also posted this issue here: [https://discuss.px4.io/t/altitude-fluctuation-in-missions/14416](url)\r\n\r\n**To Reproduce**\r\n1. Use Pixhawk1 or Pixhawk Cube with 1.8.2, 1.9.2, or 1.10 firmware\r\n2. Upload mission detailed below\r\n3. Take off and start mission\r\n4. See drone fluctuate 1-2 meters from setpoint.\r\n\r\nMission:\r\n\r\nMission Start - 0m\r\nTakeoff - 8m rel to home\r\nWaypoint - 8m rel to home, 5sec hold\r\nWaypoint - 8m rel to home, 5sec hold\r\nWaypoint - 8m rel to home\r\nWaypoint - 8m rel to home\r\nWaypoint - 8m rel to home\r\nWaypoint - 8m rel to home\r\n\r\n**Expected behavior**\r\nI expect the drone's altitude to follow the setpoint altitude in mission mode with the same accuracy as position mode.\r\n\r\n**Log Files Analysis**\r\n[https://review.px4.io/plot_app?log=624517a3-9159-415c-8974-4fc790206f6f](url)\r\nMore log files for different missions are available upon request. They have all resulted in the same issue--despite using different setpoint altitudes and types of waypoints.\r\n\r\n**Drone**\r\nThis problem was reproduced on two drones; a Flamewheel 450 and a custom drone that is much larger--about 1 meter span between opposite motors. We tried multiple configurations for each drone consisting of Pixhawk 1, Pixhawk Cube, v1.8.2 PX4 and v1.9.2 PX4. For each Pixhawk, we used the standard recommended GPS. Both drones were adequately powered.\r\n",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Durandal Mission transfer fail",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/13732",
    "body": "**Describe the bug**\r\nWe were able to flash master on the latest QGC 3.5.6 on the Durandal flight controller. The problem is that we are getting a Mission transfer fail error message when loading the Mission on QGC. We tried with USB and Mission failed, USB and battery connected and Mission failed, it seems to work via Telemetry. We formatted the SD card and we encountered the same issue. \r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Make sure you have the latest QGC 3.5.6\r\n2. Flash firmware Master branch\r\n3. Uploaded mission to the vehicle\r\n4. Error message \"Mission transfer failed\" see picture below.\r\n![78786969_1548876298601624_6122367445408677888_n (1)](https://user-images.githubusercontent.com/39415493/70669964-b63fe180-1c2c-11ea-98e9-66581acb430c.png)\r\n\r\n**Log Files**\r\n**Modes Tested**\r\nPosition Mode: Good.\r\nAltitude Mode: Good.\r\nStabilized Mode: Good.\r\nMission Plan Mode (Automated): Good.RTL (Return To Land): Good.\r\nhttps://review.px4.io/plot_app?log=0a193cd7-9b3b-483f-86de-aea71489b32b\r\nhttps://review.px4.io/plot_app?log=62b6b784-7e3a-41c2-a47b-b27791a90635\r\n\r\n**Drone Information**\r\nFirmware: v1.10.0 (beta) (d6ffdc09)\r\nFlight Controller: Durandal(Holybro)\r\nGPS: Holybro GPS\r\nFrame: F450\r\nTelemetry: Holybro 915Mhz\r\n\r\n**Additional Note:**\r\nWhen we removed the SD card and uploaded the logs 2 flight logs were not saved on the SD card. The logs are shown on the SD but no information was registered. The total flights completed were 4 and only 2 flight logs registered the data. ",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Bad system behavior when airspeed data disapears",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/13697",
    "body": "There is some bad system behavior we've observed in legacy firmware (between v1.8-v1.9) related to airspeed data disappearing, for example if the I2C bus flakes out or if power is lost to the airspeed sensor.\r\n\r\nI submit this for review against the new airspeed selector work @sfuhrer and others are contributing in hopes the new airspeed features will robustly handle these difference cases.\r\n\r\nIf airspeed data suddenly disappears there are several bad behaviors:\r\n\r\n1. The system seems to keep sending the last known airspeed reading down the MAVlink pipe to the ground station (might need to be verified).  It should instead stop sending airspeed data if no new data is available.\r\n\r\n2. There are no warnings to the user that airspeed data has gone missing. There should be some warning inidcation if airspeed data is expected but disappeared.  There should also be an indication if it returns.  (note: similar data disappeared, data returned indications should be extended to all sensor types).\r\n\r\n3. On a failed takeoff, if the autopilot stops receiving airspeed data, the LandDetector may think the vehicle is still flying because the last reported airspeed still seems to be piping into the system. The motor may still run at full throttle! Ideally airpseed would stop updating and \"zero\" or \"null\" would be reported and the system would understand that it should not be using airspeed as part of the LandDetector.\r\n\r\n4. If airspeed disappears during flight there is no indication that it disappeared. TECS will silently switch to non-airspeed mode and not tell the user and by-passes the airspeed failsafe functionality. There should be warning indications and the airspeed failsafe functionality should be followed.\r\n\r\nHere are some flight logs showing the last example of airspeed data disappearing during the middle of a flight:\r\nhttps://review.px4.io/plot_app?log=d378dac5-1061-444d-ba8d-ee911c6315cf\r\nhttps://review.px4.io/plot_app?log=35be23c2-6bdf-4caa-9075-f9805b6d2035\r\nhttps://review.px4.io/plot_app?log=5ffc7018-9793-4b88-89a3-8066988b1e54\r\n\r\nFYI @sfuhrer ",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Error message \"unable to read from microSD\" when flying a mission with \"jump to item\"",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/13592",
    "body": "**Describe the bug**\r\nWhen flying a mission on a VTOL with a \"jump to item\" in it, it does what it is supposed to do (go back to selected item and then continue the mission from there on again), but it gives the following error message every time it reaches the \"jump to item\" waypoint:\r\n![image](https://user-images.githubusercontent.com/26798987/69558813-2d2c7780-0fa9-11ea-8d0d-f8b3859a2831.png)\r\n\r\nhttps://review.px4.io/plot_app?log=e3b60ca9-d232-46d3-99f4-65220f2360b2\r\n\r\n\r\n",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "EKF gps hgt timeout - reset to baro",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/13508",
    "body": "**Describe the bug**\r\nEKF gps hgt timeout - reset to baro problem.\r\nIt basically says GPS data is lagged because _gps_hgt_intermittent flag is on.\r\n\r\n_gps_hgt_intermittent = !((_time_last_imu - gps_init.time_us) < 2 * GPS_MAX_INTERVAL);\r\n\r\nHowever, it seems very difficult to meet this condition unless otherwise GPS has unstable connection. But it's not. It seems some timing issue.\r\n\r\n**To Reproduce**\r\nNot exactly reproducible\r\n\r\n**Expected behavior**\r\n\r\n**Log Files and Screenshots**\r\nhttps://review.px4.io/plot_app?log=d8997f75-e796-4a42-9b90-ea5c06a3d54d\r\n\r\n**Drone (please complete the following information):**\r\n- FMUv5.\r\n",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Unexpected Freefall druing Loiter Mode",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/13479",
    "body": "I have flight three times with my vtol plane two days ago. In the last flight,  during loiter mode at 280meters, the plane start to descent its altitude. I commanded RTL at 25meters and it return back to home but It still losing altitude during rtl mode. RTL altitude set to 40m but the plane did not climbout to 40m during rtl mode. I switch to manual at about 10 meters and landed the plane. Loiter mode does not appear in flight log records. I think that fw control module stops to work in air. The plane did not try to reach cruise airspeed during this period. Actually, it did not try to correct anything. \r\n\r\nAfter landing, I was able to run lifter motors, servos and pusher motor. The plane was able to take off and landing normally after landing. There was no hardware problem. You can see easily, there is long dropout on flightlog at all plots. You can watch the flight from \"Open 3D View\", the plane was flying backwards bcause of dropouts on log file.\r\n\r\nFlight log: https://review.px4.io/plot_app?log=ecc40545-1384-4185-828e-c14322655122",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "v1.10.0-rc quadcopter doesn't take off in HITL/jMAVsim ",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/13471",
    "body": "**Describe the bug**\r\nSet up HITL simulation with jMAVsim on Ubuntu 18.04,  Pixhawk 4 with v1.10.0-rc, locally built px4_fmu-v5-multicopter. \r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Follow the recipe from [px4 website](https://dev.px4.io/v1.9.0/en/simulation/hitl.html#jmavsimgazebo-hitl-environment)\r\n2. Using Manual/Stabilized mode, arm vehicle and apply throttle\r\n3. Vehicle does not take off\r\n4. Mavlink shell (`listener` command) shows actuator_outputs_1 with *valid* values and actuator_outputs_0 with 0 values\r\n\r\n**Expected behavior**\r\nSERVO_OUTPUT_RAW or HIL_ACTUATOR_CONTROLS should follow actuator_outputs_1 and the vehicle should take off in simulation\r\n\r\n**Log Files and Screenshots**\r\n[Flight Review Link](https://review.px4.io/plot_app?log=8890b998-3b24-4a96-af5a-da4c10910bff)\r\n\r\nAdd screenshots to help explain your problem.\r\n\r\n**Drone:**\r\n- Pixhawk4 running in HITL Quad Mode\r\n- Photo of the IMU / autopilot setup if possible.\r\n![IMG_8020](https://user-images.githubusercontent.com/11541631/68861820-46d0e380-06ba-11ea-98e2-76585b3bb031.JPG)\r\n\r\n\r\n\r\n",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Violent jerk when switching from manual to position mode",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/13415",
    "body": "**Firmware**: 1.9.2 (with #13312 and #13325)\r\n\r\n**Describe the bug**\r\nI'm seeing huge pitch/roll setpoints when switching from manual to position mode . It seems like it's the velocity controller, but I don't really understand how the velocity controller ends up demanding such large effort of the attitude controller. I've detuned the P gain on the velocity controller and am still seeing a violent jerk when switching from manual to position. Here's a log with 3 mode switch, the first one being the most violent.\r\n\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Switch from `manual` to `position` mode. The more velocity you have before the switch, the more violent the jerk.\r\n\r\n**Log Files and Screenshots**\r\nhttps://review.px4.io/plot_app?log=4fa7056e-d1bc-437f-829d-0b45e3087276\r\n![Selection_038](https://user-images.githubusercontent.com/37091262/68419559-afb6d980-0157-11ea-96b3-72665d0f29f1.png)\r\n![Selection_041](https://user-images.githubusercontent.com/37091262/68419888-5307ee80-0158-11ea-93d5-1dddd621be10.png)\r\n\r\n\r\nThe velocity setpoints are not changing dramatically, so the attitude effort should not be there.\r\n![Selection_039](https://user-images.githubusercontent.com/37091262/68419561-b1809d00-0157-11ea-9cd0-991be8fbca65.png)\r\n\r\n@bresch @mhkabir @TSC21 \r\n\r\nRelated to #12389\r\n",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "FW: vehicle stays forever in takeoff mode if airspeed fails",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/13413",
    "body": "If the airspeed is invalid (eg NAN) during FW mission takeoff (runway takeoff), the take off state is never exited. \r\n\r\n![image](https://user-images.githubusercontent.com/26798987/68403081-ad1aab00-017c-11ea-8368-b965edd717d8.png)\r\n\r\nhttps://review.px4.io/plot_app?log=ce5a3aee-13a2-4ee6-bd07-8e1f9b7a497a\r\n\r\nThis will btw also not be fixed with https://github.com/PX4/Firmware/pull/12887 and the default values (fallback to ground-windspeed would need to be enabled), and is part of the reason that the SITL CI fails for this PR till now).\r\n\r\nFYI @dagar @RomanBapst \r\n\r\n",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Hard-fault produced when GPS is driver is started in-flight",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/13352",
    "body": "**Describe the bug**\r\nThis may not be a regular use-case, but while testing to reproduce #13350, I had a bad crash, which turns out was a hard-fault.\r\n\r\n**Steps taken**\r\nSteps to reproduce the behavior:\r\n1. Drone with optical flow (pmw3901), GPS actively used. Commanded via MAVLink\r\n2. Stopped the GPS driver\r\n3. Take-off\r\n4. `gps start -b 115200`\r\n5. BOOM\r\n\r\n**Elaboration**\r\nI mention that the vehicle was commanded via MAVLink because I did the exact same test again immediately afterwards, with the only difference that I was using an RC and it did not hard-fault. I was scared to attempt to reproduce... Joysticks don't let you map a kill switch!\r\n\r\n**Log Files and Screenshots**\r\n[Log](https://review.px4.io/plot_app?log=b3af87ef-bc79-4795-be5e-6c99e36557a9)\r\n[Hard-fault file](https://drive.google.com/file/d/1IxdO0bjZCKV5n7AkUgmThaM9rMiLva93/view?usp=sharing)\r\n[ELF file](https://drive.google.com/file/d/1P0VStSh6af39KoXZ0IefE6NJOosAE7jF/view?usp=sharing)",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Commander mode offboard triggers PX4 freeze",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/13309",
    "body": "**Describe the bug**\r\nUsing px4_sitl_default together with gazebo and sending set_actuator_control_target via pymavlink successfully establishes a mavlink connection and actuator commands are received on the px4 stack and uorb topic offboard_control_mode is published. When using the system console and sending `commander mode offboard` the stack freezes. No uorb topics are published and no mavlink messages are received (gazebo plugin correspondingly outputs `[Err] [gazebo_mavlink_interface.cpp:1155] poll timeout` in the mavlink poll function). The pxh system console remains responsive but commands to any module (e.g. commander, uorb) have no effect and hence indicating the system wide freeze. No error message from PX4 is shown and gdb debugger catches no signals.\r\n\r\n**To Reproduce**\r\n- run `px4_sitl_default gazebo`\r\n- send mavlink messages via pymavlink `c.mav.set_actuator_control_target_send(0, 0, 0, 0, controls)`\r\n- switch to offboard mode using `commander mode offboard`\r\n\r\n**Expected behavior**\r\nPx4 was expected to switch `vehicle_control_mode` into offboard mode.\r\n\r\n**Log Files and Screenshots**\r\n- https://review.px4.io/plot_app?log=86db944d-af82-456a-bb6c-79e8e5b223dd\r\n\r\n**Additional context**\r\n- PX4 firmware (v1.9.2)\r\n- mavlink (release/kinetic/mavlink/2019.10.10-1)\r\n- mavros (0.33.0)\r\n- Approaches so far:\r\n  - PX4_INFO() print outputs showed that commander reaches publishing in run() loop\r\n  - gdb info variables and inspecting last variables gave no further insights\r\n\r\nThe freeze presumably happens after the system console arguments are parsed and published in the commander run loop. It could also be that the crash happens earlier and all modules get stuck at the file descriptor polling. Maybe a problem from global variables causing a race condition with the main commander thread? Maybe I am missing something but it does not seem that variable access is coordinated when parsing the mode argument.\r\n\r\nAny advice on how to approach or debug this problem are very much appreciated!",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Land detector edge case in descend mode",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/13231",
    "body": "**Describe the bug**\r\nThe land detector seems to detect ground contact in Descend mode (RC land failsafe without GPS).\r\n\r\n1. `vertical_movement` to be `false`: https://github.com/PX4/Firmware/blob/95dc522b99688a08402ac6462ad28f5dfd338eda/src/modules/land_detector/MulticopterLandDetector.cpp#L154\r\n2. `hit_ground` to be `true`: https://github.com/PX4/Firmware/blob/95dc522b99688a08402ac6462ad28f5dfd338eda/src/modules/land_detector/MulticopterLandDetector.cpp#L165\r\n\r\nThis happens because the z controller only reacts slowly to the new setpoint so the z velocity down is much less than the z velocity setpoint here:\r\nhttps://github.com/PX4/Firmware/blob/95dc522b99688a08402ac6462ad28f5dfd338eda/src/modules/land_detector/MulticopterLandDetector.cpp#L151-L154\r\n\r\nOne observation of the descend case is that the velocity setpoint jumps to the land speed instead of gradually reaching it like in Land (with GPS) mode.\r\n\r\n![bokeh_plot(1)](https://user-images.githubusercontent.com/1419688/67103273-14b88880-f1c5-11e9-932a-827e357f7cc7.png)\r\n\r\n\r\n**To Reproduce**\r\nThis is hard to reproduce in SITL because the drone seems to follow the setpoint quicker.\r\n\r\n**Expected behavior**\r\nIt should not detect ground contact until actually landed.\r\n\r\n**Log Files and Screenshots**\r\n\r\nThis happened in a failsafe descend test:\r\nhttps://review.px4.io/plot_app?log=3104d449-dd29-473f-9055-354984ff8afa\r\n\r\nThis does **not** happen in normal landing:\r\nhttps://review.px4.io/plot_app?log=2ea6423f-b232-45c9-8c40-32e775118359\r\n\r\nMore info in https://github.com/PX4/Firmware/pull/13143#issuecomment-543682487.\r\n\r\nFYI @bresch @MaEtUgR \r\n",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Offboard position setpoints with loiter type mask makes Fixed wing vehicle fly away",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/13180",
    "body": "**Describe the bug**\r\nOffboard position setpoints with loiter type masks result in a fly away of a fixed wing vehicle. The roll and pitch setpoints are set to zero and continues to fly to the last direction where offboard mode was triggered. The offboard position setpoints fly as expected without the loiter type mask.\r\n\r\n![Screenshot from 2019-10-14 12-05-00](https://user-images.githubusercontent.com/5248102/66743792-fe37c780-ee7a-11e9-8d67-0b0f06dd44d1.png)\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Take off FW vehicle in SITL\r\n2. Send `SET_POSITION_LOCAL_NED` setpoint with `type_mask=0x3000` ([see](https://github.com/PX4/Firmware/blob/master/src/modules/mavlink/mavlink_receiver.cpp#L774)\r\n3. Swich mode to offboard mode\r\n\r\n\r\n**Expected behavior**\r\nThe FW vehicle circles around the loiter setpoint\r\n\r\n**Log Files and Screenshots**\r\nThe [log](https://review.px4.io/plot_app?log=8617fe45-3269-4098-9165-e94b176d74a4) shows the offboard setpoint resulting in a fly away. A local position setpoint of [0.0, 0.0, 20.0] was being streemed with`type_mask=0x3000`\r\n\r\n**Additional context**\r\nCurrently flying offboard position setpoints are passed as a reference position for the L1 controller, which results the vehicle turning around and traversing the setpoint as can be seen [here](https://review.px4.io/plot_app?log=209a8f30-a2aa-45f1-85b0-6755170b88a2). Supporting circling the waypoints may be useful for various robotic applications using fixed wing.\r\n",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "QGC _altitude issues_CUAV Nano",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/13148",
    "body": "**Describe the bug**\r\nWe have noticed the altitude issues on the CUAV Nano this issue was noted on QGC altitude reading. (and relative altitude) not being displayed correctly. \r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Drone switched on\r\n2. Uploaded mission\r\n3. Takeoff, Position Mode \r\n4. Switch from Position mode to Mission mode \r\n4. See altitude reading on QGC\r\n\r\n**Log Files and Screenshots**\r\nLog Nano V5:   \r\nhttps://review.px4.io/plot_app?log=e3d7bc0a-891d-4ecf-8ebd-01afb7630ab7\r\n![nano V5](https://user-images.githubusercontent.com/39415493/66510657-4d03ec80-ea8a-11e9-8544-4bf23e4d8059.jpg)\r\n![nano V5](https://user-images.githubusercontent.com/39415493/66510679-5725eb00-ea8a-11e9-84a6-876ba6643988.jpg)\r\n\r\n**Drone (please complete the following information):**\r\nFC- CUAV Nano \r\nFrame: F450 frame\r\nGPS- NEO V2\r\n![f450_cuav5_nano_complete](https://user-images.githubusercontent.com/39415493/66511077-1e3a4600-ea8b-11e9-90dd-80041808b8cc.jpg)\r\n\r\n\r\n**Additional context**\r\nThe vehicle flight performance is well but the altitude is off by approximately 10 to 13 meters.@dagar what could be the issue? ",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "CUAV V5+_Accel inconsistent",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/13083",
    "body": "**Describe the bug**\r\nWe are getting this constant error message of Accel inconsistent error with the CUAV V5+. We did all the calibrations, then try to arm again and again mark Accel inconsistent. We did a complete reset in the flight controller did the calibrations and the same issue. \r\n\r\n**Log Files and Screenshots**\r\n<img width=\"960\" alt=\"CUAV+ Accels inconsistent\" src=\"https://user-images.githubusercontent.com/39415493/66089260-64dfeb80-e533-11e9-93a4-3610550da5ba.png\">\r\n\r\nLog: \r\nhttps://review.px4.io/plot_app?log=37067a71-b746-4f44-8013-8c4fe57b3bfa\r\n\r\nLast working flight log: \r\nhttps://review.px4.io/plot_app?log=66332487-04b5-47f5-b1a3-a241e23a4dd7  \r\n\r\n**Drone (please complete the following information):**\r\n- FC- CUAV V5+\r\n- Frame- DJI f450\r\n- GPS- NEO V2\r\n![CUAV close pic](https://user-images.githubusercontent.com/39415493/66089507-7970b380-e534-11e9-8a08-7fc280ed0082.jpg)\r\n\r\n**Additional context**\r\nToday we tried the Master branch but I had already tried it in Stable & a PR and still the same error, I also changed the GPS from the working unit Nano CUAV but it remains the same.\r\n@dagar what could be the issue? ",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "VTOL transition no rate sp for 1 second",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/13030",
    "body": "**Describe the bug**\nNo rate sp are being published in the first second of a front transition.\n\n![image](https://user-images.githubusercontent.com/26798987/65669005-13bb8d80-e043-11e9-80c2-4e8607d602b4.png)\n\nlog file (todays master in sitl): \nhttps://review.px4.io/plot_app?log=7e8f18ac-0800-4c4b-a947-7773ed1ddc41\n\n\n**To Reproduce**\nDo a VTOL front transition in sitl, all control modes (stabilized, alt, pos) seem to be affected.\n\n\n**Additional context**\nNoticed it only because of accidentally triggered front transition, while also giving some roll input before. Then the rate_sp froze for 1s at a large value, almost resulting in a flip of the VTOL.\n![image](https://user-images.githubusercontent.com/26798987/65669305-9a706a80-e043-11e9-882a-93d21eba2ddf.png)\n\n@dagar @RomanBapst  FYI",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "CM8JL65 switches uORB instance mid-air",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/12987",
    "body": "**Describe the bug**\r\nI've seen a bug where the distance sensor CM8JL65 switches the uORB topic it is publishing on, mid-air. This doesn't seem to bother EKF2 much, but it still doesn't sound like a great idea.\r\n\r\nThis was seen when testing a rebased version of https://github.com/PX4/Firmware/pull/12950, but I don't think the issue is related to the PR.\r\n\r\nWould be interesting to know if anybody has seen similar behavior with other sensors, or if this is more likely a bug in the CM8JL65 driver.\r\n\r\n**Screenshots**\r\n![image](https://user-images.githubusercontent.com/14265408/65228612-1100eb80-dacb-11e9-93e1-cefa6e4880f9.png)\r\n\r\n**Logs**\r\n[Log file](https://review.px4.io/plot_app?log=c5c192d0-ae47-4bbc-a8de-2c887bddaf87)\r\n",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "VTOL: no control in FW after transition in ALT control",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/12910",
    "body": "reproducable in sitl: take off in alt, switch to FW. Not possible to change flight direction.\r\n\r\nsitl log:\r\nhttps://review.px4.io/plot_app?log=a60bffd8-f43f-4ca1-b59e-18d7dbe46bc9\r\n\r\nflight log:\r\nhttps://review.px4.io/plot_app?log=a14d1d71-bb8c-4438-a0bb-6ae8daed4190",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Pixhawk Cube_calibration issue on Master",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/12692",
    "body": "**Describe the bug**\r\nWhen setting up the vehicle for a flight, on arming the vehicle I get a \"Compass not found\" message, see image below:\r\n![image](https://user-images.githubusercontent.com/39415493/62976692-0a979980-bdd2-11e9-9e1e-65a1f90f1168.png)\r\nThis issue is on Master e25db016 & PR Pull[12650](https://github.com/PX4/Firmware/pull/12650#event-2540347567), tried on Stable version and was able to fly. v1.9.2 (10690587).\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Power on the Drone\r\n2. Uploaded mission \r\n3. Arm vehicle and Takeoff\r\n4. Error, \"Preflight Fail: COmpass #2 uncalibrated\"\r\n5. Calibrate vehicle \r\n6. Error message Gyro 1 no matching uORB devid\r\n7. Unable to calibrate the vehicle on Master\r\n![image](https://user-images.githubusercontent.com/39415493/62978246-ad054c00-bdd5-11e9-8470-26f7e1acde02.png)\r\n\r\n\r\n**Log Files**\r\nCompass not found and Calibration issue log on Master:\r\nhttps://review.px4.io/plot_app?log=13cc9db5-4a03-41ff-a9e2-b80013d3e104\r\n\r\nStable  v1.9.2 (10690587) log:\r\nhttps://logs.px4.io/plot_app?log=71a782cc-7979-4ff1-a6e8-f3d8f4757f55\r\n\r\nPR 12650 log issue:\r\nhttps://review.px4.io/plot_app?log=18094d44-f808-4b67-b7d6-8ef0df7f4f05\r\n \r\n**Drone **\r\nFrame- DJI F450\r\nFlight Controller: Pixhawk 2(The Cube)\r\n\r\n@dagar we tried calibrating the vehicle and get an Error message Gyro 1 no matching uORB devid. On Stable version, we were able to arm, calibrate and fly the vehicle with no issues.\r\n\r\n",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Logger stopped completely during flight?",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/12565",
    "body": "**Describe the bug**\nWe did 4 flight tests on Tuesday, the first two logged fine, the last two stopped logging during fight. The other parts of the system were working as usual so I didn't even notice anything until reading the logs and finding out most of it is missing.\nI am logging everything at the highest rates so I am not surprised by the frequent dropouts, but why did it just go off completely? \n\nNow I am trying to increase the buffer size by multiplying it in line 283. [https://github.com/PX4/Firmware/blob/36534d5bab3d6a73f146e671df1b8f40772174b7/src/modules/logger/logger.cpp#L283](http://url)\nMultiplying it by 4 makes the dropouts less frequent but sometimes the buffer still saturates. If I try to multiply it by 5 the logger won't start at all. Why there is a limit? \nThe stack size seems unaffected but I try to increase it to 5000 anyway, making no difference.\n\n**Expected behavior**\nI would expect the logging to resume after the buffer clears up, not just to stop completely.\nAlso maybe the way to increase the buffer correctly is not completely clear to me.\n\n**Log Files and Screenshots**\nHere the logging stopped even before takeoff. There is 10+ minutes of flight missing.\nhttps://review.px4.io/plot_app?log=0fd05bfa-c092-49f5-8cf6-c89c3d950f51\n\nThis is the last flight, there should be another 5+ minutes tracked.\nhttps://review.px4.io/plot_app?log=fdb9b50f-cc70-48d0-92d1-04215f50c64c\n\n**System**\nPixhawk 4\n\n",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Fixedwing position controller not able follow position setpoints in offboard mode",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/12517",
    "body": "**Describe the bug**\r\nWhen streaming position setpoints to the fixed wing vehicle, it can enter offboard mode as the setpoint is sreamed. However, rather than following the setpoints (usually defined in local coordinates) it simply flies straight. \r\n\r\nThis seems to be because the fixed wing position controller blindly reads from the setpoints in global coordinates from the position_setpoint_triplets.\r\n\r\nhttps://github.com/PX4/Firmware/blob/master/src/modules/fw_pos_control_l1/FixedwingPositionControl.cpp#L854-L855\r\n\r\n**To Reproduce**\r\n1. Run SITL and start mission while streaming position_setpoints through mavros with setpoint_raw messages to takeoff and loiter\r\n2. After takeoff, switch vehicle to offboard mode\r\n\r\n**Expected behavior**\r\nWhen given a position setpoint, the desired behavior is to use it as a reference for the L1 position controller.\r\n\r\n**Log Files and Screenshots**\r\nhttps://review.px4.io/plot_app?log=f6204199-f876-4253-8d12-cb454c1e816b\r\n\r\nAs can be seen in the picture below, once the vehicle is in offboard mode, the vehicle simply flies straight.\r\n![Screenshot from 2019-07-19 00-59-14](https://user-images.githubusercontent.com/5248102/61497647-84e62100-a9c0-11e9-845e-d8893c43ba88.png)\r\n\r\n**Additional context**\r\nAttitude setpoints for offboard mode in fixed wing is currently working. However, to use this a l1 like path tracking controller needs to be implemented on the companion side to make it usable. Being able to stream position setpoints to a fixed wing drone would greatly simplify the interface for robotic applications in fixed wing",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "thermal calibration issues",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/12412",
    "body": "I am trying to perform a [offboard thermal calibration on my pixhawk 3] with v1.9.0 firmware (https://docs.px4.io/en/advanced_config/sensor_thermal_calibration.html).  And I am getting step like response for my bias compensation (see attached figure).  Notice the z acceleration bias is very large.  Looking at the [flight review](https://review.px4.io/plot_app?log=9ef38f6d-629e-43c8-84f3-5af83118771b) it seems that the raw data is fine and has temperature drift, but the estimate rpy angle and rate go crazy.  \r\n\r\nWhy do I get step like responses for my bias curves? Is this a hardware or software problem?\r\n Has anybody got this issues before and if so how can I resolve it? This problem exist and my 3 new pixhawk 3 systems.\r\n\r\n[log001.ulg.pdf](https://github.com/PX4/Firmware/files/3357190/log001.ulg.pdf)\r\n\r\nthanks\r\n\r\n\r\n\r\n\r\n\r\n",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "MPC_THR_HOVER gets passed unconstrained to the thrust setpoint in manual mode.",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/12338",
    "body": "**Describe the bug**\r\nAn incorrect value of MPC_THR_HOVER will get passed unconstrained to the manual thrust setpoint.  In 1.8.2 the manual thrust setpoint was constrained between MPC_THR_MIN and MPC_THR_MAX.  If the user entered a MPC_THR_HOVER of 50 instead of 0.50 a centered stick would result in a thrust setpoint of 50 where the mixer expects values between 0 and 1.0.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\nSet MPC_THR_HOVER to a value of 59 (instead of the correct 0.59).  In QGC this is would have to be entered as 5900 but in a startup script as 59.\r\n\r\n**Expected behavior**\r\nThe hover thrust setpoint should not be greater than 1.0, or MPC_THR_MAX\r\n\r\n**Log Files and Screenshots**\r\nhttps://review.px4.io/plot_app?log=4a38b5fc-4684-4b16-9313-16dcda6294cd\r\n\r\n![image](https://user-images.githubusercontent.com/6790455/60197003-5aef7380-97f3-11e9-850c-6330f6c9bdd1.png)\r\n\r\n\r\nYeah, this was a dumb mistake on my part to fat finger the entry, but in 1.8.2 I would have to fat finger two separate parameters.  It's up to you guys if you want to protect against this kind of dumb.\r\n",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "RC loss behavior",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/12307",
    "body": "**Describe the bug**\nDrone lost communication and then descended to ground.\n\n**To Reproduce**\nSteps to reproduce the behavior:\nFly drone in Position mode and lose communication with it. I don't know how to reproduce this consistently.\n\n**Expected behavior**\nI would expect the drone to continue to do what it was doing before because NAV_RCL_ACT  was set to 0.\n\n**Log Files and Screenshots**\nhttps://review.px4.io/plot_app?log=d97a8a6f-94a6-42fa-abf0-0dff97ba8102\n\n**Drone:**\n- Teal One\n\n**Additional context**\nPX4 1.9.0",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "EKF2 not fusing the Rangefinder",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/12247",
    "body": "**Describe the bug**\r\nThe estimated altitude and the local_position.z seem to ignore the rangefinder data.\r\nUsing the Lidar Lite through PWM,\r\nPixhawk 4 fmu_v5,\r\nstable release 1.9.0,\r\nquadrotor_x in position control or altitude hold mode.\r\n\r\nThe distance sensor data show that the sensor outputs correct readings but the altitude estimates seem uninfluenced.\r\n\r\n**Log Files and Screenshots**\r\nhttps://review.px4.io/plot_app?log=d19babaf-06b4-4074-b14e-af8828fb51c2\r\n\r\nAdd screenshots to help explain your problem.\r\n![Screenshot 2019-06-11 at 20 51 47](https://user-images.githubusercontent.com/22155994/59302939-072a4980-8c8d-11e9-9eeb-36fe5cfd2355.png)\r\n",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Compass calibration fail PixRacer V4 on Master ",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/12193",
    "body": "**Describe the bug**\r\nUploaded PR [#12120](https://github.com/PX4/Firmware/pull/12120) tried to arm and had an error \"compass Inconsistent\". Performed the compass calibrations and got error message \"Error: failed to get current calibration 2\". Uploaded  Master branch ac44584. To replicate the issue performed calibrations and got the same message, \"Error: failed to get current calibration 2\". Tried on Stable ea48cd4, performed the calibrations and went through successfully. Vehicle armed and had no issues.  \r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Upload Master branch or PR\r\n2. Perform compass calibration\r\n3. Failed calibrations \r\n4. See error\r\n\r\n**Expected behavior**\r\nThe expected behavior is for the vehicle to pass the calibrations and able to arm the vehicle.\r\n**Log Files and Screenshots**\r\n<img width=\"960\" alt=\"error\" src=\"https://user-images.githubusercontent.com/39415493/58993834-89090700-87a3-11e9-9d66-fa505e8772a1.png\">\r\n@dagar There seems to be an error when uploading the log on Flight Review. \r\n<img width=\"960\" alt=\"error al cargar log\" src=\"https://user-images.githubusercontent.com/39415493/58994274-cc17aa00-87a4-11e9-961e-060511c72f9a.png\">\r\n\r\n**Additional** context\r\nThe last working log\r\nhttps://review.px4.io/plot_app?log=116ede6d-d632-4836-91a7-fced724c82be-- \r\n\r\n",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Poor initial climbout performance, fixed wing",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/11907",
    "body": "part of a related discussion with @LorenzMeier @RomanBapst @dagar here https://github.com/PX4/Firmware/pull/11883#discussion_r278098852\r\n\r\nWe sometimes see poor initial climb out performance on our hand-launched fixed wing. Looking at some logs it is not achieving the target pitch angle (15 deg), but the control system isn't trying very hard to get there.\r\n\r\nMight there be an integrator issue or is something else going on with airspeed and gain scaling?\r\n\r\n![image](https://user-images.githubusercontent.com/12117027/56701401-91f6bb00-66c4-11e9-835e-3dbd02233b24.png)\r\n\r\n\r\nExample logs here:\r\nhttps://review.px4.io/plot_app?log=a8b193bc-f3d7-4cab-ae3e-ba0302c1834b\r\nand\r\nhttps://review.px4.io/plot_app?log=09b99ed1-aef6-4eff-8d44-d166307f7132",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Pixhawk Cube v2 Return to land failure",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/11824",
    "body": "**Describe the bug**\r\n- Modes Tested\r\nPosition Mode: Good.\r\nMission Plan Mode (Automated)\r\nRTL (Return To Land\r\n\r\n- Procedure\r\nArm and Take off in position mode, after flying for approximately one minute, switched to mission plan mode  behavior,the vehicle took-off and reached the designated altitude (35m) as expected; issue started once it reached the altitude of 35m, UAV began to oscillate and descend at the same time but the descend was not continuous, it had short pauses.\r\n\r\nhttps://review.px4.io/plot_app?log=e9d7b116-487a-45c2-98f9-52d9cec4d88f\r\n\r\n**Drone (please complete the following information):**\r\n- Describe the type of drone.F450 Pixhawk Cube v2\r\n\r\nVideo:  https://www.youtube.com/watch?v=Sv2jUGdmNBo&feature=youtu.be",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "ECL breaks gazebo when there is a lidar",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/11812",
    "body": "After the ECL update of April 4th, if the vehicle model has a lidar the local position drift like crazy when the vehicle is unarmed on ground.  Green line is vehicle local position\n\n![crazy](https://user-images.githubusercontent.com/15078736/55722173-c81a1680-5a05-11e9-851b-23405bd22d2a.png)\n\n\nLog: https://review.px4.io/plot_app?log=f1ff8c5b-d47a-4065-8a6a-1beafacd1b6c\nReported by @mrivi",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "nxp_fmuk66-v3 rev C issues",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/11767",
    "body": "\r\n\r\n**Tested on NXP v3.x**\r\n\r\n**Modes Tested** \r\n_Position Mode:_ Armed and took-off as expected, once in the air the vehicle was oscillating. \r\n\r\n_Mission Plan Mode (Automated):_ Once switched from position to mission vehicle gain altitude but did not start the mission then switched back to position but UAV did not respond and crashed. \r\n\r\n_RTL (Return To Land):_ Untested. \r\n\r\n**Notes** \r\nVehicle took-off in position mode but was oscillating while in the air. \r\nThe vehicle did not respond to RC commands after switching from mission mode back to position mode.\r\n\r\nhttps://review.px4.io/plot_app?log=d9e76bc4-5c82-42c5-84bf-19c127e78016\r\n@igalloway @davids5 @dagar ",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Fixed wing mission and altitude transition fail",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/11759",
    "body": "Vehicle Information:\nAirframe: Phantom FPV Flying Wing\nHardware: | PX4_FMU_V3 (V2)\nSoftware Version: | v1.9.0 (beta) (25bf4ba7)\nSteps:\n\n1.  Vehicle arms \n1. Take off is smooth\n\nNotes: Flight as expected, but once the mission plan (automated) is triggered, fixed-wing accelerates towards the ground with the nose facing down.\n\nPR #10179 and Master same issues.\nhttps://review.px4.io/plot_app?log=d1c75dae-a1fe-4fc6-b6aa-20cb1f979aa8\nInitially, we thought it was the hardware. Last week we did several reboots and inspected the hardware. We tested again today and the same issue persisted.\n\nVideo of the issue below:\nhttps://www.youtube.com/watch?v=CdgrCeFI8A0&feature=youtu.be\n@dagar what could be the issue?\n\n",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Hard-fault in NuttX?",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/11703",
    "body": "**Describe the bug**\nWe flew in position control testing some of the collision prevention capabilities (together with the avoidance on the companion), when suddenly the drone fell out of the sky.\n\n**Log Files and Screenshots**\n[Firmware: 2ebb9d](https://github.com/PX4/Firmware/commit/2ebb9d2ab52bce56a74d34d3b36c7130422577c2)\n[Logfile](https://review.px4.io/plot_app?log=a2750cab-5785-4dd2-bc34-c54e8ca32668)\n[.elf file](https://drive.google.com/file/d/12XRtolO2OdMxlqsjAS1kktjLkBmqnFY_/view?usp=sharing)\n\n**Drone :**\nQuad X racer, with a pixracer\n\nMy hard-fault debugging skills are severely limited, best I could tell is that it seemed to come from `fs_poll.c`, but I wouldn't trust myself about that. Maybe @bkueng or @julianoes are more qualified to debug this?",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "High CPU load on Pixhawk 4 (fmu-v5)",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/11604",
    "body": "When flashing master I noticed very high CPU loads when arming the vehicle. Depending on my parameters, the CPU load can go between 85 and 100%. Also when disarmed the cpu load is way higher than usual.\n\nLog: https://review.px4.io/plot_app?log=6d8f3085-a624-4cbb-8974-5ae992ba51d7\n\nThis log is from my bench setup with no external SPI or I2C sensors.\n\n![ph4_cpu_issue](https://user-images.githubusercontent.com/35664507/54019920-c05c1d80-418c-11e9-81ab-d3f122544a9a.png)\n\nFYI @LorenzMeier @dagar @davids5 @bkueng",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Must reboot Pixhawk Between Missions",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/11588",
    "body": "After we land and finish a mission, if we disarm then arm back up or simply don't disarm but re-run the mission, mission mode engages but not take-off occurs (no throttle spin up). Flaps go down (take-off flaps are enabled) but there is no motor-spin up. The only way to fix it is to reboot the plane from QGC.\n\nThis is occurring on master but likely not new since it has done this repeatedly (nothing but this) on master from a week or two ago as well.\n\nFMU_v2 with v3 firmware on fixed-wing.\n\nLogs:\nSuccessful flight:\nhttps://review.px4.io/plot_app?log=ba1a4634-1c12-4461-9938-097c743a3e6c\nLog right after taxing back:\nhttps://review.px4.io/plot_app?log=3cca3276-7b5a-4a50-8073-9a4fd1947557\nQuick Disarm then arm and then taxing to try and takeoff (which didnt work:\nhttps://review.px4.io/plot_app?log=575072f3-09a1-4c50-bbe9-3edcd923b9b6\nAfter the last log, a reboot of the plane from QGC and the next mission (same exact mission) flew fine.",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Pixhawk 4 and Pikhawk 4mini v5 not disarming.",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/11569",
    "body": "**Description**\nUAV is not disarming manually nor automatically, same issue when using Kill Switch.\nChanged to Stable firmware and disarm functions where working as expected.\n\n**Log Files**\nPixhawk 4mini v5 _Commmit:_ 0df34af1\nhttps://review.px4.io/plot_app?log=b69fc363-d90d-49d1-8cf4-ecb6122f3202&fbclid=IwAR2DQunVucBs96HvJiQ9KvGzdutroVqC33kkPLZk8crRz0QyFi97vb1qy2Q\n\nPikhawk 4 v5 _Commmit:_ 0df34af1\nhttps://review.px4.io/plot_app?log=e715787a-7f9f-45d4-9947-e5b0e1576773&fbclid=IwAR3dsmfYIADvrCuK_24NColLyb5a2E1UnXGX25eYMjg21_FRJSy3evWkG_4\n\n**Drone**\n- Multicopter.\n- DJI Flame Wheel F450.\n@dagar",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Issue with Master_vehicle crash",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/11408",
    "body": "Today we tested Master v1.9.0 (beta) (7f3b1700) with the Pixracer, Pixhawk 4 mini, Pixhawk 4. Created mission. The vehicle armed good, took off. At 30 meters the vehicle started spinning and came down to the ground. Resulted in a crash. Same behavior for all 3 platforms. \n\nSteps to reproduce the behavior:\n\n1. Uploaded mission\n1. Drone switched on\n1. Vehicle armed\n1. Took off\n1. Elevated to 30 meters\n1. vehicle started spinning out of control\n1. The vehicle came down and crashed\n\nPixracer:\nhttps://review.px4.io/plot_app?log=4f0c2692-5f27-4d83-bfbd-765bf48a989e\n\nPixhawk 4 Mini:\nhttps://review.px4.io/plot_app?log=53fa724b-906d-4e93-87fe-5a4f4c2a50b8\n\nPixhawk 4:\nhttps://review.px4.io/plot_app?log=69f42b00-6259-4a97-96c1-bd8f06b4d29d\n\n@dagar\n\n",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "[ecl/EKF] EKF stopping navigation in every flight",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/11071",
    "body": "Hello,\n\nI am constantly getting this error in my flights: \"[ecl/EKF] EKF stopping navigation\". I am using a PX4FLOW and a Lidar Lite v3 for range data and I am flying without GPS. I am using fmu-v3 (master) with a small alteration to make the Lidar boot before the PX4FLOW (https://github.com/PX4/Firmware/issues/11009).\n\nFrom the logs I see that my local position estimates vary wildly at the beginning until I get the error and, after that, the estimating stops (obviously). However, the condition_local_position_valid flag drops to zero even before EKF stops navigation and it never goes back to one. Here is an example of a short test I did this morning:\n\nhttps://review.px4.io/plot_app?log=95d3f262-f3ef-4dea-9398-91dcce53d245\n\nI was flying outdoors and neither take-off nor landing were exactly smooth. I thought it might be an issue with the PX4FLOW, but I have tried both indoors and outdoors flights on floors with different textures and the quality data I get seems to be good enough. Also, even though the acceleration power spectral density data is not ideal, I get much better values indoors and yet I still get the same error, so I doubt vibration is an issue.\n\nAny ideas?\n\n",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "survey control lost at turn point",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/11041",
    "body": "Performing a survey, we saw a weird behaviour at the first turn point. Reaching the turning point, the copter started to tumble violently and loose height. Quickly toggling to altitude and then position to stop the mission didn't stop the behaviour. The machine crashed into the ground tumbling, stayed grounded for a few seconds, and took off again, now hovering stable in position mode.\n\nThe tumbling seems to start with a jump of the yaw setpoint. At mission start the machine had a successfully yaw into flight direction however.\n\nThe tuning and general reaction tested before the survey in position and altitude mode seemed very stable.\n\nAny hints on possible reasons are very appreciated!\n\nhttps://review.px4.io/plot_app?log=c7976cfc-d926-4596-ae1a-44c4e216800b",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Too many false positive \"Preflight Fail: HIGH IMU ACCEL BIAS\" warning messages",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/10833",
    "body": "**Problem:**\n\nWe are getting a lot of false positive \"Preflight Fail: HIGH IMU ACCEL BIAS\" warning messages preventing arming.  This seems to have started in master this past spring and continues in stable 1.8.0.  I believe a lot of other PX4 users are getting these false positive warnings as well.\n\n- (Note: in recent master the text of this warning as changed to \"Preflight Fail: High Accelerometer Bias\")\n\nThis happens to us frequently on known good aircraft that are great fliers and continue to fly great once the fault is cleared. \n\nWe recently noticed the error seems correlated to a vehicle sitting level on the ground for some period of time.  @priseborough made a helpful suggestion to try pitching and rolling the vehicle slowly so that the X and Y accels could spend some time facing down (gravity) and EKF2 could better estimate their bias.  This worked to clear the error!  Here is an example of the error which was then easily cleared by pitching and rolling the vehicle:\nhttps://review.px4.io/plot_app?log=278fa376-2a02-4027-b465-12507dbc9062\n\n**Possible solution:**\nIt has been suggested that using the bias state uncertainty as a factor in the bias level check could help eliminate false positives.  The bias level check in Commander could use the already existing additional information from EKF2 for this.\n\n\n**Further support:**\n\nAnecdotally I know of this exact ACCEL BIAS warning happening to handfuls of other PX4 users, many of whom do not post to Github or Discuss.\n\nThere are a large number of github issues and PX4Discuss posts about getting this error.  Probably there are many complicating factors involved with each report, but the fact that there are so many makes me believe there is a systemic issue with the check, or the checks and warnings need to be more specific.\nhttps://github.com/PX4/Firmware/issues/9241\nhttps://github.com/PX4/Firmware/issues/9474\nhttp://discuss.px4.io/t/preflight-fail/7023/10\nhttp://discuss.px4.io/t/ekf2-problem-z-velocity-estimate-weird-behaviour/8395\nhttp://discuss.px4.io/t/auto-land-ekf2-test-ratios-flight-controller-reset/8264",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "DANGEROUS: VEHICLE_CMD_DO_REPOSITION broken on master",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/10757",
    "body": "Had a Drone fly into a pole and smash into the ground when issuing a VEHICLE_CMD_DO_REPOSITION. I looked at the log and everything looked fine. This is broken on current `master` 294af5daada2fa08da8d9f1c4310779683fe9750\nhttps://review.px4.io/plot_app?log=cc6bccfc-44a5-4eca-bc2f-7a4be13a0a7a\n![selection_019](https://user-images.githubusercontent.com/37091262/47468014-45ceca80-d7b6-11e8-8a72-808d278e3b66.png)\n\nAs you can see we were just adjusting the altitude setpoint and nothing else.\n\nI then tested this in SITL using `make posix_sitl_default gazebo` and issued via QGroundControl a **`goto`** command and saw the vehicle fly to the new location, but then fly super far an a random direction for a while, then returns back to that location, wanders around a bit more, flys off in the opposite direction... then I got bored of watching.\n![selection_020](https://user-images.githubusercontent.com/37091262/47468301-c8a45500-d7b7-11e8-8acc-f1d56e639669.png)\n\nIsn't CI supposed to catch these types of bugs? This is extremely concerning to me.",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Restore LNDMC_THR_RANGE for faster disarm on land",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/10712",
    "body": "As of https://github.com/PX4/Firmware/commits/master/src/modules/land_detector the land detector cannot be configured to transition from `ground_contact` to `maybe_landed` via the now deprecated parameter LNDMC_THR_RANGE. \n\nIt now takes a considerable amount of time to disarm due to throttle down time.\nhttps://review.px4.io/plot_app?log=43987a80-5752-4f55-89a7-eec60e9298c3\n![selection_011](https://user-images.githubusercontent.com/37091262/47110927-65428200-d20f-11e8-8e41-0ab7008884d7.png)\n![selection_013](https://user-images.githubusercontent.com/37091262/47110989-8a36f500-d20f-11e8-86b4-ef158f78e931.png)\n\nIf there is a better way to do this lets discuss it, otherwise I think the parameter should be restored.\n\n**Note:** current implementation sets a hard coded limit\n```\n// 10% of throttle range between min and hover once we entered ground contact\nfloat sys_min_throttle = _params.minThrottle + (_params.hoverThrottle - _params.minThrottle) * 0.1f;\n```",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Position setpoint drift during takeoff",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/10679",
    "body": "A strange update in the local position setpoint seems to occur during takeoff on a fairly recent branch (few weeks old):\n\nhttps://review.px4.io/plot_app?log=1d33a68b-c88b-420c-8e8f-4a4382675963\n\nDuring a mission, The vehicle takes off 4 meters in the air then suddenly changes position. as seen on local position setpoint X/Y. it does resume its takeoff to final altitude.\n\nThe position it moved to seems like it is the location where the first home lock occurred. \n\n![image](https://user-images.githubusercontent.com/14801663/46794991-52c8d400-cd49-11e8-8a9f-fe8fda09f7b9.png)\n\n\n@dagar @RomanBapst @bresch",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "FlightTask: implement MPC_LAND_ALT1/2",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/10659",
    "body": "MPC_LAND_ALT1 and MPC_LAND_ALT2 should be used for a final approach speed during landing.\nAccording to the param spec the vehicle should descend at MPC_Z_VEL_MAX_DN speed and slow down between MPC_LAND_ALT1 and MPC_LAND_ALT2 to MPC_LAND_SPEED.\n\nThere is a massive energy consumption benefit in having this\n\nCurrently this is not implemented in the FlightTask: https://github.com/PX4/Firmware/blob/bee6a6b8b08d30b36475628e0750edcb6038d798/src/lib/FlightTasks/tasks/AutoMapper/FlightTaskAutoMapper.cpp#L117\n\nThe params are used for takeoff which does not seem to be documented behavior: https://github.com/PX4/Firmware/blob/bee6a6b8b08d30b36475628e0750edcb6038d798/src/lib/FlightTasks/tasks/AutoMapper/FlightTaskAutoMapper.cpp#L128\n\nPerhaps implementing it as indicated currently is not a good idea, the altitudes default to 10 and 5m above home and we might be flying over a different altitude.\n\nThere are a few options on how this can be implemented safely;\n1. Within a small radius around home / for RTL only\n2. Only when a range finder is installed\n3. If QGC has given the terrain altitude\n4. When enabled by a param\n5. When enabled in the waypoint (explicitly chosen in QGC)\n\nIf there are any other ideas on how to do this please share.\n\nLog demonstrating the behavior: https://review.px4.io/plot_app?log=642eae62-6203-4ab3-b372-ef0b58f01e4c\nMPC_LAND_SPEED was 0.7\nMPC_Z_VEL_MAX_DN was 2.5\n\n/cc @dagar @bresch @LorenzMeier",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Skywalker X8 VTOL unable to recover from gust",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/10639",
    "body": "After attempting to climb to 30 m in mission mode a moment is applied due to a gust. This causes the DeltaQuad to bank excessively sending it into a pitch down dive. We attempted to take over manual control but we didn't have enough altitude to recover. \n\nWe flashed our flight controller (Dropix V2.1) with the Master branch (Updated 24th September). We then tested our DeltaQuad in manual mode quickly to ensure everything was working correctly and we set up a simple mission (with a few way-points then a land only in QC mode). It began climbing normally until 24 m when a gust caused the drone to enter a roll. The drone wasn't able to recover from this and caused an adverse roll followed by a nose down attitude until contact with the ground.\n\nLink to the log file: https://review.px4.io/plot_app?log=992ecb6b-8410-4bd6-91e2-e82a7fa5e826\n\nOur drone is a Skywalker X8 with VTOL modules.",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "pixhawk 2.1 voltage issues.",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/10620",
    "body": "@dagar @Tony3dr \n I had problems with pixhawk 2.1 voltage reading,  I have calibrated the voltage several times  and even with the full battery, activate the fail safe immediately. \nI already tested with another voltage sensor and reset the parameters and it's still the same.\n\nhttps://review.px4.io/plot_app?log=8c1f6603-3183-4bf6-87fd-6d527988a276\nhttps://review.px4.io/plot_app?log=23ce4f5f-e26c-4a00-96e7-5e7cf5c8138c",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Navigator: Land/RTL quad flys towards home lat/lot/alt",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/10412",
    "body": "**Describe the bug**\nAuto modes `land` and `rtl` cause quad to fly directly towards home lat/lon/alt. This is the third time I've seen this in two weeks. I've seen it ~10 times since the introduction of FlightTasks. We are flying ~7 hours a week, so this is a very rare edge case bug. Logging either dies completely or drops out when this happens. I finally have a partial log (2 minute long dropout) of a flight where this happened. \n\n**To Reproduce**\n1. Takeoff using mode `takeoff`\n2. Fly around in position mode\n3. Issue `land` or `rtl`\n4. This behavior will persist through a land/disarm/arm/takeoff\n\n**Log Files and Screenshots**\nhttps://review.px4.io/plot_app?log=7955d3de-31c9-4434-b30d-cb31fadefb32\n\n**Additional context**\nI am pretty sure `takeoff` is causing the bug. I am fairly certain `navigator` gets stuck in a loop somewhere, this would explain the logger dropouts due to thread starvation (navigator priority is higher than logger). I am guessing all `auto` modes will cause this, we only use `land` and `rtl`, but both of those modes do the same thing, fly right towards home.",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Random yawing when RC loss",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/10296",
    "body": "**Describe the bug**\nThe vehicle loses RC connection and yaws to `home` heading. (We have loiter as our RC loss behavior: NAV_RCL_ACT = 1)\n![selection_001](https://user-images.githubusercontent.com/37091262/44433460-92eab200-a563-11e8-80e5-8b9efc0f3e8f.png)\n\n\n\n**To Reproduce**\nCurrent `master` just cause an RC loss. \n\n**Expected behavior**\nKeep the current heading.\n\n**Log Files and Screenshots**\nhttps://review.px4.io/plot_app?log=d9f20475-0558-45f8-9fc9-56d7389f173c\n\n**Additional context**\nWe are hitting a failsafe which we should not be hitting. `FlightTasks::update()` is failing at line `607` in `mc_pos_control_main.cpp`. This triggers `failsafe()`. Note the vehicle does not actually descend....\n\n![selection_002](https://user-images.githubusercontent.com/37091262/44433521-e6f59680-a563-11e8-8ea0-95868c0d5849.png)",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Yaw setpoint jumps sharply",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/10230",
    "body": "I am having an issue with a very heavy prototype VTOL that I'm building and I am seeing an issue that I am not sure where this behavior could be coming from. As I am hovering, sometimes the bird yaws hard and loses altitude. I think the fact I lose altitude indicates to me that we don't have enough thrust to push through the decent caused by spooling down half of the motors in the yaw.\n\nWhile I have been digging through the logs, I noticed a point where the yaw setpoint jump sharply at 7:36. I also noticed a baro EKF error and would that case an EKF reset on the mags which could cause a sharp heading change?\n\nI feel like this might just be a poor calibration and tune but I thought I would ping you to see if you have any great ideas.\n\nhttps://review.px4.io/plot_app?log=ca81fd27-ac49-4d8f-aac2-da9e1532396d",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Yaw during takeoff during first flight after reboot",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/10033",
    "body": "Every time I take off for the first time after a reboot I get some strange yaw behaviour. As soon as the vehicle takes off I get a very fast yaw (more than 90 degrees). If I land and do a second flight it doesn't happen anymore (probably some initialization issue).\n\nFrame: S500\nAutopilot: Pixhawk 4 Mini (fmu-v5)\nPX4 version: Today's Master (100f9553cef2203c818ab98e13d39406c6fc3c8c)\n\nPosition Mode:\nLog: https://review.px4.io/plot_app?log=fe704b1d-0e77-4bc4-9c9f-35aa2da2732c\nVideo: https://youtu.be/A_9ktAQalvs \n\n*Log and video are from the same flight\n*Log is 'from boot to disarm'",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "pixhack v5 RC is not detected on master ",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/9989",
    "body": "On the pr and master, the copter does not detect the radio, only on stable works well\nfirst, send to manual mode and later to hold mode\n\n\nhttps://review.px4.io/plot_app?log=bf71d883-0596-4723-95cc-ed70f2412ce6\n\n**Drone \nf450, pixhack, 20ams hobbywing esc and iris motors \n\non the firmware master 3293fe still work good @dagar",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "NXPhlite issues.",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/9973",
    "body": "@davids5  Has issues maintaining altitude  in position, altitude and Auto. The accuracy of the GPS is very poor. in POS it maintain the position  but in mission it doesn't.\n\ncommit 5b0ad4e1.\nhttps://review.px4.io/plot_app?log=ff6f685c-eb1a-412a-93e3-80354cbf602c\nhttps://review.px4.io/plot_app?log=a5824a2a-e8ff-4f00-b7c4-b1018c694652\nhttps://review.px4.io/plot_app?log=1c2da437-5699-4ddc-bf01-1d5ab0814187\nhttps://review.px4.io/plot_app?log=aa719c97-71c4-4d05-aea6-ef6f8a36ce01\nhttps://review.px4.io/plot_app?log=ff6f685c-eb1a-412a-93e3-80354cbf602c\nhttps://review.px4.io/plot_app?log=b0db2ecc-a6c9-42a1-8a49-f8afea1ffa2e\n\ncommit 9e4e19d4.\nhttps://review.px4.io/plot_app?log=910de492-f7b7-4fe4-8983-837c3f130218\nhttps://review.px4.io/plot_app?log=42c37087-c863-4423-9f11-c8bb517da99f",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "EKF2 wind estimate very wrong",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/9726",
    "body": "Flown on 6/18 on Master (so almost 1.8 stable)\n\nActual wind at site was between 12-15 m/s\n\nEKF2 Wind estimate shows ~2-4 m/s.\n\nhttps://review.px4.io/plot_app?log=e6d82fe3-9b3b-4f4b-b8c6-5af1e930e1a9\n\nAlso, if you take look at ground speed vs airspeed we're cruising at about 20 m/s but traveling closer to 35 m/s but wind estimates are nowhere near what we were actually in (we measure wind with an anemometer before testing) and looking at surrounding area wind readings all were consistent with ours. It was blowing your shirt against your body kind of wind, not gentle breeze which is more the 2-5 m/s reported.\n\nMaster on 6/18\nfmuv3 firmware on Original Pixhawk (2mb flash)\nQGC Daily also from 6/18\n\n@dagar",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Poor land detection",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/9696",
    "body": "@MaEtUgR @bkueng Could you have a look? This is blocking v1.8\n\nA new flight report just got uploaded:\nhttps://review.px4.io/plot_app?log=22cb36a7-2ac1-4cd8-b42c-cea152c7a141\n\nDescription: beta18_mc03_pxr(05)\nFeedback: take-off in position mode; steady hold; nice tracking; good nav; poor land detection\nRating: Unsatisfactory\nWind Speed: Breeze\nUploader: santiago@3dr.com\n\nVehicle type: Quadrotor\nAirframe: DJI Flame Wheel F450, Quadrotor x\nHardware: PX4FMU_V4\nVehicle UUID: 003200333435510837363434\nSoftware git hash: aa625d9af880e3be7bd2ddd7ed49d10c74c6ada4",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "FW Mission Start - Wheel increases to max deflection (max pwm value)",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/9540",
    "body": "When starting a mission the nose wheel servo instantly increases to ~2000 pwm and there is no time to recover (turns much too much) - need to actually decrease max angles at which the servo can turn but this is a new issue. Here are three logs with this occurring several times during each log. I was able to fly the missions due to some manual offsetting of the wheel but if left centered it would not work every time.\n\nUsing an fmu_v2 during these tests. Logging is on from boot so there is a lot of nothing prior.\n\nhttps://review.px4.io/plot_app?log=02711563-1bd4-40ee-8107-16fa14017b9e\n\nhttps://review.px4.io/plot_app?log=0285460d-d71f-422b-9d55-b42bccc66cbb\n\nhttps://review.px4.io/plot_app?log=732a5f97-563d-4141-ae9b-c4c8691277af",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "EKF errors with Fixed Wing",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/9474",
    "body": "This was tested on a slightly modified version of PX4 Master\n\nAfter letting the vehicle sit for an extended period of time we are experiencing two errors \"PREFLIGHT FAIL: EKF INTERNAL CHECKS\" and \"PREFLIGHT FAIL: HIGH IMU ACCEL BIAS\". We recalibrated the accelerometers but still experienced these issues. If the plane is armed moderately quickly after booting up and there are no errors thrown, and the aircraft flies normally.\n\nHere are some log examples of the preflight fails on ground:\n\nhttps://review.px4.io/plot_app?log=a0fb96a2-de2f-4e2d-a4f6-0f930ea53248\n\nhttps://review.px4.io/plot_app?log=42eda972-2802-4d1e-b236-bed93244427c\n\nWe also had a case where the aircraft threw a \"PREFLIGHT FAIL: HIGH IMU ACCEL BIAS\" error but then still allowed us to arm. On takeoff the aircraft flew erratically and had to be taken over with manual control. Log is posted below.\n\nhttps://review.px4.io/plot_app?log=e29821e7-9539-46ec-b563-79be1b655cf4",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "2 hard faults (on ground + in air) with PX4FW v1.7.4",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/9348",
    "body": "## Bug Report\nWe (ASL/ETHZ) have recently had two hard faults that caused Pixhawk to reboot. One of them unfortunately happened in air with a 3.2m wingspan fixed-wing, one happened during on-ground testing.\n\n## Setup\n - Hardware: mRo Pixhawk (px4fmu-v3 / 2MB flash)\n - Firmware: Basically PX4FW v1.7.4, i.e. master-branch from 5 days ago (https://github.com/PX4/Firmware/commit/71170dce0a87ce06e00d721a713dfc3dc92dfc11) but with some slight modifications mainly to adapt the mixers to our platform and one custom sensor driver. The estimator is EKF2, the flight controller is the stock controller.\n\n## Hard fault 1: In-air\nWe had done 3 short MANUAL flights before that, and in this flight first flew manual for about three minutes and then switched to stabilized. The hard fault ocured 1 minute after switching to stabilized mode. The pilot continued to fly in PX4IO's (important!) manual override mode, and, as he barely noticed the issues, actually went back into stabilized mode for some time before then landing the plane following our instructions. The ulogger-log of part 1 (see below) stops in air. We could not find any fancy stuff in the logs before the log stops. Pixhawk rebooted in-air, and continued logging as usual (part2, see below).\n\n- Log files (with attached hard fault log) from take-off to in-air hardfault and pixhawk reboot: https://review.px4.io/plot_app?log=3b702655-6052-46e6-85e2-fd012d27c25f\n- Log file after the crash (i.e. after the pixhawk reboot until landing): https://review.px4.io/plot_app?log=409fcb62-50ca-42d1-82c7-f1bcaccfe9fd\n- Telemetry logs:[2018-04-20 15-13-09.log](https://github.com/PX4/Firmware/files/1934640/2018-04-20.15-13-09.log) (rename to .tlog!). The reboot happens after ca 1/3 of the log file length, you can see that it happened because the relative altitude is suddently zero or even negative.\n\n## Hard fault 2: On-ground\nThis happened during in-lab testing. We performed extensive pre-flight checks, including rebooting FMU (by pressing the reset button) and checking that IO's manual override still works. It did, but (and i assume this is normal because there is already a mixer present) loading the mixer after that provoked reboot fails. We let the plane then just sit there for a couple of minutes, and suddenly Pixhawk rebooted. This was a hard fault, too. We unfortunately assumed this was BECAUSE we had provoked the in-air restart via pushing the FMU reset button (and after testing for another 8 hours in-lab without any hard fault assumed everything was OK). I don't have the ulog-files yet, but i have:\n\n- The hardfault log from the SD card (it looks very similar to the one we saw in flight): \n[fault_2000_01_01_18_53_35.log](https://github.com/PX4/Firmware/files/1934634/fault_2000_01_01_18_53_35.log)\n- The console output. Note again that this log starts after we provoked an FMU reset via pushing its reset button, that's why it is an in-air restart. \n[consoleLog.txt](https://github.com/PX4/Firmware/files/1934645/consoleLog.txt)\n\nI might be able to provide the firmware .elf file to allow debugging the hard fault as described in https://dev.px4.io/en/debug/gdb_debugging.html#debugging-hard-faults-in-nuttx if required.\n\nI guess it makes sense to add this to https://github.com/PX4/Firmware/issues/9271 @RomanBapst @LorenzMeier ?",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "No EKF2 init without Vision Position, arming allowing without attitude estimate",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/9020",
    "body": "I am running v1.7.3, estimator is EKF2, EK2_AID_MASK is 9 (GPS and vision position).\n\nI've attempted to fly the copter indoors in stabilized mode (there is no GPS fix) without providing VISION_POSITION_ESTIMATE messages. Flight mode changed successfully, the copter was armed and when I've applied throttle, it took off, but was completely uncontrollable with regards to roll and pitch.\n\nStrangely, if you set EKF2_AID_MASK to 1 (GPS only) and have no GPS fix, you can still take off in modes, that don't need GPS fix (altitude control, stabilized) and everything works as intended.\n\nI've expected the copter either to arm and fly normally or at least refuse to arm.\n\nHere is the flight log: https://review.px4.io/plot_app?log=0d1bf158-5559-4bb6-ab31-c23580292b4a",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "VTOL Flight Issue",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/8864",
    "body": "@RomanBapst Could you please have a look at this log file?\r\nhttps://review.px4.io/plot_app?log=6fa2399a-ccb4-4a2d-8303-091dec28dda0\r\n\r\n@PX4/testflights You can tag Roman for future issues directly.",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "VTOL Crash 02/01/18",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/8807",
    "body": "We flew a VTOL (Delta - Quad) with Pixhawk 1 (no silicon errata), executed auto (mission) the VTOL climbed, made the transition and reached the first waypoint, then it started to fly in a straight line, tried to recovered and activated kill switch but it continued flying and eventually crashed.\n\nFirmware loaded was master (102c0ea)\n\nHere is the log:\nhttps://review.px4.io/plot_app?log=7b00d0db-adf7-4a22-a9ba-8f8d55bb0419\n\nThank you!",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "EKF2 Ekf::initialiseFilter() problem (disable mag, enable HGT_MODE Vision) ",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/8761",
    "body": "Hello.\r\n\r\nEkf::initialiseFilter() has some limitations:\r\n\r\n// check to see if we have enough measurements and return false if not\r\nbool hgt_count_fail = _hgt_counter <= 2 * _obs_buffer_length;\r\nHere it doesn't take into account that user may choose HGT_MODE VISION but aircraft is sitting on the ground with camera giving vision only in air. So if there is no vision while we are on the ground then filter init fails.\r\n\r\nbool mag_count_fail = _mag_counter <= 2 * _obs_buffer_length;\r\nHere it doesn't take into account that mag may be disabled by user (CAL_MAG0_EN or CAL_MAG1_EN ). So if user disable mag manually then filter init fails.\r\n\r\nbool ev_count_fail = ((_params.fusion_mode & MASK_USE_EVPOS) || (_params.fusion_mode & MASK_USE_EVYAW)) && (_ev_counter <= 2 * _obs_buffer_length);\r\nHere it doesn't take into account that aircraft is sitting on the ground with camera giving vision only in air. So if there is no vision while we are on the ground then filter init fails.\r\n\r\nOverall, if user choose AID_MASK 24 (vision position and vision yaw only) and do no provide vision data from the start to correctly initialise filter then it fails. But providing vision data when aircraft is sitting on the ground may not be possible in many cases.\r\n\r\nif (hgt_count_fail || mag_count_fail || ev_count_fail) {\r\n    return false;\r\n}\r\n \r\nFlight Log: https://review.px4.io/plot_app?log=7dacafb7-cd48-4296-a4c7-03c62a174c41\r\n\r\nExpected behaviour:\r\n1. If user disables mag manually then mag_count_fail must account it correctly depending on CAL_MAG0_EN or CAL_MAG1_EN params.\r\n2. If user choose vision only mode or choose HGT_MODE vision and do not provide vision data while ekf2 is inited then filter must able to init itself without this data.\r\n\r\nFor the short-term hack it is possible just to setup all three variables to false (mag_count_fail, hgt_count_fail, ev_count_fail), but this solution is quite ugly.\r\n\r\n",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Intel Aero: uncontrollable attitude",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/8718",
    "body": "Running current master 850678b and had a flip upon take-off\nlooking at the log, pitch and roll do not look to be registering:\nhttps://logs.px4.io/plot_app?log=71f9eb76-8ccc-4444-9f6f-5d4b7ab676d1\n\nreverted to yesterday's master 0e65753 and stabilize is fully responsive:\nhttps://logs.px4.io/plot_app?log=072aada3-d5a4-4f28-bb5d-9cea084674b1\nSomething might have been damaged in the flight controller because once altitude mode was engaged, the copter shot up in altitude and hit the roof.\n\nlast successful flight was on 0e65753\nhttps://review.px4.io/plot_app?log=a3026aee-25ab-431a-b076-941084c0cc28",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Not getting MAV_LANDED_STATE_ON_GROUND",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/8464",
    "body": "See [flight log](https://review.px4.io/plot_app?log=4d7df5bf-d8b5-43a5-bd9a-842f8702a131).  I expect to get extended sys state showing MAV_LANDED_STATE_ON_GROUND after doing simple take off and landing.\n\n**Repro**\n1) Run [AirSim](https://github.com/Microsoft/AirSim), with PX4 connected, either SITL or HITL mode.\n2) Run this python script \n\n```python\nfrom AirSimClient import *\nimport sys\nimport time\nimport argparse\n\nclient = MultirotorClient()\nclient.confirmConnection()\nclient.enableApiControl(True)\n\nclient.armDisarm(True)\n\nlanded = client.getLandedState()\nif landed == LandedState.Landed:\n    print(\"taking off...\")\n    client.takeoff()\n        \ntime.sleep(2)\n\nprint(\"landing...\")\nclient.land()\n\nprint(\"disarming.\")\nclient.armDisarm(False)\n```\n\nNotice client.land() times out because the extended sys state is stuck in MAV_LANDED_STATE_LANDING, and never reaches MAV_LANDED_STATE_ON_GROUND.  This seems to be a regression in v1.7.0, older versions of the firmware worked fine.",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "F450 with Pixhawk 1 - f63c821 crash",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/8398",
    "body": "The pilot reported it was flying in Auto and was seing the vehicle following the mission in QGC, then the RC signal was lost and the vehicle crashed on the ceiling of a building.\r\n\r\nThis a screen capture of the messages in QGC\r\n![qgc_messages](https://user-images.githubusercontent.com/5013954/33461994-da3699f2-d5e9-11e7-9eef-3e34d4edd1ce.jpg)\r\n\r\n[Log](https://review.px4.io/plot_app?log=c087212c-24ec-4076-b83c-0c690b5c26ba)\r\n\r\nPrevious successful fligths the same day\r\nhttps://review.px4.io/plot_app?log=a768ef29-6be8-4245-b191-183ffa20ddb6\r\nhttps://review.px4.io/plot_app?log=56d2c68b-cff0-4198-bb33-4197e44a4815\r\nhttps://review.px4.io/plot_app?log=95e5f4c8-b294-4182-b630-256600424117\r\nhttps://review.px4.io/plot_app?log=a75645fa-3af5-494a-b3cf-748f5d9a6d89\r\nhttps://review.px4.io/plot_app?log=c7a0d5c4-f79a-47d2-83f6-0a8d94fd216c\r\nhttps://review.px4.io/plot_app?log=83b00da7-f696-4af4-b3b7-f768fead3c7f\r\n\r\n@dagar ",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "F450 with Pixhawk 3 Pro v1.7.0-rc3 crash",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/8392",
    "body": "Flight of DJI F450 with Pixhawk 3 Pro autopilot using v1.7.0-rc3 (66d4a1b3)\r\n\r\nThe pilot reported the vehicle took off, switched to Auto, reached the first waypoint and it started to climb above 300 meters, the pilot commanded RTL through QGC, the vehicle started to move towards home position but kept gaining altitude. The pilot sent land command through QGC but the vehicle didn't respond, it only responded to RC roll so the pilot engaged the kill switch.\r\n\r\n[Log](https://review.px4.io/plot_app?log=0cdfec08-8848-4892-bcff-d4a720e99803)\r\n\r\n@dagar",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "RTL issues with multiCopter",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/8389",
    "body": "If engaging RTL multiple times in the same flight, the second+ instance of RTL goes towards a previously set path by the first RTL engagement.\r\nCouple examples:\r\nhttps://review.px4.io/plot_app?log=ed176590-4352-4516-b5ed-3892436d6477\r\nhttps://review.px4.io/plot_app?log=d9c63fd1-1224-4be7-8985-932a2f670c78\r\n\r\n@dagar ",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "FW crash v1.7.0-rc2",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/8380",
    "body": "Phantom flying wing with Pixhawk mini autopilot running v1.7.0-rc2 (V3).\r\n\r\nAfter 6 successful flights, during the 7th flight, the pilot took off in manual mode, switched to Auto and the plane accelerated to maximum thrust uncontrollably; once switched back into manual the pilot reported only partial control, attempted to land manually but crashed due to the vast acceleration and only partial control over the craft.\r\n\r\n[Log](https://review.px4.io/plot_app?log=6fb19372-e027-4b23-b0e8-5425d409f5f3)\r\n\r\n[Video](https://youtu.be/3qIzzh4hfUs)\r\n\r\n@dagar ",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "MC: Crash due to Motor Stop (Kill Switch) but I doubt this",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/8263",
    "body": "**Bug Report**\r\n\r\nI file this as a bug report since I'm concerned that my crash today may have other reasons than accidentally flipping the Kill Switch. \r\n\r\nI was performing some tests to eliminate a strong Oszillation when braking in PosCTL. This was improving, when I wanted to do another Test, shortly after Taking of the Rotors stopped in Mid-Air and the Vehicle crashed on the road where Motors where spinning again. While hitting the Ground the Battery got disconnected (as can be seen in the Telemetry log). \r\n\r\nSadly the ULG stops shortly after start so about 2meters of flight are missing from the Vehicles Log (this is kind of strange). Also the OSD did not record anything since it claimed that there was no Communication (this may also be a bug of the OSD FW but it said that there was no data for more than 400 secs, which usually does not happen). \r\n\r\nSo I'm stuck with the Telemetry Log. This is the last I got over Telemetry (from the Log):\r\n\r\n![killswitch](https://user-images.githubusercontent.com/6877067/32623752-760951f8-c587-11e7-8ec7-9ea27c5a3fcf.jpg)\r\n\r\nHere comes the 2nd strange Part. The Kill-Switch was engaged and disengaged under **0.5 sec and this twice in sequence**. I checked with my Remote and it is almost impossible to really push the switch to the position in-between where it may flip back in this quick manner. I'm not aware that I flipped the Switch and the Telemetry RC Input (Channel 6) does not reflect any change in Signal. I performed many flights, and never flipped the switch unintentionally.\r\n\r\nTelemetry Log (Check last 15 secs) : [2017-11-09 18-05-27.tlog.zip](https://github.com/PX4/Firmware/files/1458838/2017-11-09.18-05-27.tlog.zip)\r\n\r\nULog Upload : https://review.px4.io/plot_app?log=1452c840-3003-4913-b528-1fff3f17d447",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "VTOL crash on V4Pro",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/8186",
    "body": "vtol crash 24/October\r\n\r\ncrash log:\r\nhttps://review.px4.io/plot_app?log=da864870-aa30-4133-be64-c766e2e0e9e7\r\n\r\nprevious successful flights on same platform:\r\nhttps://review.px4.io/plot_app?log=1fa2997a-b9d8-4039-af2e-dad379be803c\r\nhttps://review.px4.io/plot_app?log=deacbcaa-61ed-41c2-80d2-9b636b66a983\r\n\r\n\r\nFlight conditions:\r\naprox 27°C degrees\r\nmoderate winds, 4~5 m/s\r\n\r\nSequence of events:\r\nauto take-off in MC\r\nfailed auto-transition to FW\r\nretook manual control in stabilized and successfully engaged manual transition to FW\r\nengaged mission; vtol headed in correct direction to first waypoint\r\n\r\nafter a few waypoints, vtol started to veer off coarse and switched back to MC\r\nswitched MC to stabilized at which point it was hard to control and started to dip in pitch and roll violently while losing altitude\r\n\r\n@dagar ",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Mission randomly rejected",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/8066",
    "body": "Log: https://review.px4.io/plot_app?log=6f9fa451-d3a6-42dd-b1c7-87261310b139\r\nSituation:\r\nVehicle sat outside with good gps and telemetry lock\r\nArmed via RC\r\nSwitched from Manual to Mission (jumping over ALTCTL)\r\nWarning issued: REJECT AUTO MISSION\r\n\r\nThen disarm and arm again and it works.\r\nThis happens very often but not consistently.",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Mission takeoff almost no thrust and does not take off",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/7737",
    "body": "On today's master (a merge of https://github.com/PX4/Firmware/pull/7666 and https://github.com/PX4/Firmware/pull/7690)\r\n\r\na VTOL takeoff and a regular takeoff from mission mode was attempted. Both failed.\r\nRC control from posctl did function from a landed state.\r\nSwitching to mission while airborne did complete the takeoff and vtol takeoff command.\r\n\r\nLog: https://review.px4.io/plot_app?log=a5ab7c8f-101f-443f-a612-6e46fadc9d7f\r\n\r\nFYI @dagar @LorenzMeier ",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Change Altitude causes yaw setpoint change",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/7638",
    "body": "when loitering after reposition, changing the altitude will cause 180 deg change in yaw sp (facing the previous position)\n (FW v1.6.5 QG 3.2.0)\n\n1. Take-off\n2. re-position 100m north\n3. when loitering after reaching the point- change altitude to 50m\n4. bug- the drone changes the yaw setpoint (facing south)\n\nhttp://review.px4.io/plot_app?log=a6cbe484-4ef9-46b4-91f2-f98e3708d407",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "PX4 1.6.3: Strange problem with Airspeed-less transition.",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/7545",
    "body": "We were flying 1.6.3 for some time. But recently decided to reset all the parameters with the new defaults. For this we use change of air-frame procedure. So we carefully introduced our PIDs on top of the new defaults. We removed the circuit breaker for the airspeed and thus it did not ask us to calibrate the airspeed so the diff press cal params were empty 0.00. \r\n\r\nIn this setup we were not able to complete the transition. It never stopped the quad despite the speed got exceeding 20 m/s and the transition continued forever up to the crash.\r\n\r\nhttp://review.px4.io/plot_app?log=b6653ab1-ada7-4711-abaf-00a6a51249dc\r\n\r\nBecause we flew the 1.6.3 airspeed-less without a problem we just started thinking. We enabled the airspeed. Calibrated the airpseed. Then again we disconnected it from the breaker.\r\n\r\nOn the Bench test perfect transitions.\r\n\r\nhttp://review.px4.io/plot_app?log=619b0b6b-ae84-4220-aa52-73ddce2b7fcc\r\n\r\nhttp://review.px4.io/plot_app?log=3647be91-b6f2-4be1-a5a3-f66ca93c8b94\r\n\r\nAlso we flew without airspeed without any problem. So the only thing we had to do was to calibrate the airspeed in order to make the transition in aispeed-less config.\r\n\r\nDuring this tests we discovered another thing. In airspeed-less mode the only way we could manage the transition is timing. \r\n\r\nThere is a parameter VT_F_TR_OL_TM which is supposed to guarantee fixed transition time without airspeed. But in reality in airspeed-less mode the transition is done now by the VT_TRANS_MIN_TM which is the minimum front transition time. The VT_F_TR_OL_TM did not have any effect over the transition timing.",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "[PixHawk3] Accel1 startup bias huge changes",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/7541",
    "body": "On my Drotek PixHawk Pro v1.3 I'm facing a strange behavior.\r\nFirst I saw sometimes the warning \"Accels inconsistent, check cal\". After further investigations, I saw that usually, the Z-axis value is usually around 9.8m/s2, but sometimes, the value of the Acc1 is completely wrong (e.g.; 2 or 15). The value of the accelerometer 0 is always correct.\r\n\r\n```TOPIC: sensor_accel instance 0 #1\r\n\r\ntimestamp: 11548976\r\n\r\nintegral_dt: 4000\r\n\r\nerror_count: 0\r\n\r\nx: -0.0971\r\n\r\ny:  0.0563\r\n\r\nz:  9.8932\r\n\r\nx_integral: -0.0003\r\n\r\ny_integral:  0.0002\r\n\r\nz_integral:  0.0391\r\n\r\ntemperature: 42.7938\r\n\r\nrange_m_s2: 78.4532\r\n\r\nscaling:  0.0024\r\n\r\nx_raw: 7\r\n\r\ny_raw: 40\r\n\r\nz_raw: 4074\r\n\r\ntemperature_raw: 5815\r\n\r\ndevice_id: 3608074\r\n\r\n```\r\n\r\n```TOPIC: sensor_accel instance 1 #1\r\n\r\ntimestamp: 163650940\r\n\r\nintegral_dt: 4006\r\n\r\nerror_count: 0\r\n\r\nx:  0.0778\r\n\r\ny:  0.4095\r\n\r\nz:  2.6501\r\n\r\nx_integral:  0.0003\r\n\r\ny_integral:  0.0014\r\n\r\nz_integral:  0.0081\r\n\r\ntemperature: 59.1025\r\n\r\nrange_m_s2: 156.9064\r\n\r\nscaling:  0.0048\r\n\r\nx_raw: 53\r\n\r\ny_raw: 29\r\n\r\nz_raw: 480\r\n\r\ntemperature_raw: 8701\r\n\r\ndevice_id: 1442826\r\n\r\n```\r\nAfter a few consecutive reboots on the pixhawk, I obtained the following sequence:\r\nThe behavior was the following: `first calibration` -> `-9.8` -> `reboot` -> `-15` -> `2nd calibration` -> `-9.8` -> `reboot` -> `-3` -> `3rd calibration` -> `-9.8` -> `reboot` -> `-15` -> `reboot` -> `*-9.8*` -> `reboot` -> `-15` -> `reboot` -> `-15` - `reboot 3x` -> `-9.8` -> `reboot` -> `-15` .........\r\n\r\nI tried with two other new PixHawks Pro v3.1 and I can reproduce the error. However, strange thing, I tried on a v1.2 and I wasn't able to obtain the same result after more than 10 consecutive reboots.\r\n\r\nHere is a log where the value is correct:\r\nhttp://review.px4.io/plot_app?log=170ce58a-794e-414d-8607-168ce8c734ef\r\nAnd here, one with the incorrect bias:\r\nhttp://review.px4.io/plot_app?log=e0bba09b-1129-4438-8ded-baede72f24cc\r\n\r\nThe logs come from a device uncalibrated, but I had the same issue with an autopilot fully calibrated (thermal + scale&offset).",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Flyaway after loss of datalink (v1.6.2)",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/7535",
    "body": "Hello,\r\nFew days ago I flown my multicopter for about 1.5 km. and almost got flyaway, only using RC saved it for safe landing. \r\nI got 'ALL DAT LINK LOSS' and it seems that RTL has been engaged (I still had downlink). but, instead of flying toward home position for landing the multicopter started to fly very fast backward.\r\nfrom the log I see that just after losing the datalink (at 10:28) it did got new heading, X and Y setpoints of home. but just after that (when the link was regained?) the position setpoint sets back to its current position, no change of heading setpoint. and the multicopter gets higher and higher pitch, that leads it to fly very fast backward, not closing the X and Y position setpoints. I have tried to send new commands reposition, pause the multicopter seems to be affected by them but still contiues to fly at very high speed.\r\nAt this point (2km away) we toke RC control, and fly it to home for landing.\r\n\r\nlog: \r\nhttp://review.px4.io/plot_app?log=2da94d7c-a374-4bb3-b7f9-efd8fecaf445\r\n",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Pixhawk Pro (V4Pro) Quad near flyaway",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/7495",
    "body": "Took off in position mode\r\nAlmost immediately after taking off, copter started to fly away and would not respond to user input\r\neventually regained control in altitude mode after several minutes and several hundred meters away\r\nhttp://review.px4.io/plot_app?log=2b1d4ff4-e15e-48ac-870d-2ebbe8748afc\r\n![bokeh_plot](https://user-images.githubusercontent.com/13203106/27606012-50a5876a-5b33-11e7-9c58-b839a71e1910.png)\r\n\r\nTwo succesful flights using same setup, same code, same flightplan loaded:\r\nhttp://review.px4.io/plot_app?log=776e6bbf-2971-4195-8e22-6b9d0ffe167e\r\nhttp://review.px4.io/plot_app?log=2b3f59bb-42d5-43b6-aaea-2e335318e275\r\n\r\nHad another near flyaway on this same copter a few days ago:\r\nhttp://review.px4.io/plot_app?log=00b0b048-39bd-45cd-910b-c3d54b0f39ad\r\n\r\nCopter consists of\r\nPixhawk Pro\r\n3DR ublox M8N with HMC5983 magnetometer\r\nDJI F450 quad frame\r\nDJI E300 propulsion system\r\n3S 5200mAh battery\r\nFrSky D4R-ii receiver\r\n\r\n@priseborough @bkueng @dagar ",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "PX4 1.6.1: Land detector did not disarm after land in mission VTOL",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/7402",
    "body": "Hello,\r\n\r\nWe made a mission without RC control only with the QGC. We used version 3.1.3. Everithing went ok except the land detector did not disarm after the mission was complete and the VTOL was landed. The only way we could disarm with 3.1.3 was emergency stop.\r\n\r\nVTOL left on the ground with spinning motors for some time.\r\n\r\nHere is the log:\r\nhttp://review.px4.io/plot_app?log=971f681b-2e49-4e67-816f-5b3b9c52a817\r\n\r\nAlso in Position or Altitude modes we have the same problem. The land detector probably is working, because when we touch down in one of Alt and Pos Modes the QGC says we have to be either in manual mode or landed in order to disarm.\r\n\r\nI saw it is very easy in QGC 3.2 to disarm. But it is still very nice if in the case of mission and Guided modes after touch down the land detector could at least disarm in 10-20 seconds.",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Takeoff not detected after 2nd time in altitude mode",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/6651",
    "body": "Hello\r\nWith release v1.6.0rc1 or the current master the takeoff seems not to be detected after the second time arming in altitude mode:\r\nhttp://review.px4.io/plot_app?log=b29f4633-e7c9-49a9-ab92-18106d9f01f9\r\n\r\n```\r\n2017_02_23_09_31_15: [logger] file: /fs/microsd/log/2017-02-23/09_31_1\r\n2017_02_23_09_34_09: ARMED by RC\r\n2017_02_23_09_34_11: Takeoff detected\r\n2017_02_23_09_34_29: Landing detected\r\n2017_02_23_09_34_31: DISARMED by auto disarm on land\r\n2017_02_23_09_34_36: ARMED by RC\r\n2017_02_23_09_34_46: DISARMED by auto disarm on land\r\n```\r\nThe first time arming in altitude, the takeoff and landing is detected fine.\r\nAfter the 2nd time arming, the motors are only spinning with idle thrust for some seconds and the attitude/position controller is not responding to any rc commands or nick/roll movement.\r\nIn case I switch to e.g. stabilized mode and then back to altitude mode again (when the motors are spinning with idle thrust) the takeoff is detected, the motors are spinning up and the attitude/position controller seems to be working again.\r\n\r\n\r\n\r\n\r\n\r\n",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Intel Aero CPU load & timings",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/6037",
    "body": "@lucasdemarchi @lfelipe The normal timing for PX4 is looking like this:\r\n\r\n<img width=\"844\" alt=\"screen shot 2016-12-12 at 17 49 11\" src=\"https://cloud.githubusercontent.com/assets/1208119/21107912/a0c49442-c093-11e6-8f9a-eecb1bbe3ea5.png\">\r\n\r\n\r\nFrom this log:\r\nhttp://review.px4.io/plot_app?log=1253eec0-17f1-4051-b858-dce51b268928\r\n\r\nAero looks quite different:\r\nhttp://logs.px4.io/plot_app?log=a24d89aa-d930-4894-9c6e-65ae449476ba\r\n\r\n<img width=\"844\" alt=\"screen shot 2016-12-12 at 17 54 00\" src=\"https://cloud.githubusercontent.com/assets/1208119/21108056/045efbb4-c094-11e6-8095-217c18f02cc3.png\">\r\n\r\nWe need to work out what is inducing the load and churn on Aero. Its not the logging subsystem but must be something else.",
    "state": "closed",
    "pull_request": null
  },
  {
    "title": "Offboard acuator setpoints interfere with lockstep in SITL",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/20052",
    "body": "## Describe the bug\r\nWhen enabling actuator setpoints for offboard mode, the simulation progresses in a much slower speed than normal simulations. This seems to be caused by actuator controls published in offboard module interfering with lockstep.\r\n\r\nThis bug was discovered by @MarvinHarms \r\n\r\n## To Reproduce\r\n- Publish `offboard_control_mode` message with actuator controls enabled (internally from PX4)\r\n- Publish `actuator_controls_o` message when in offboard mode\r\n- switch vehicle to offboard mode\r\n\r\n## Expected behavior\r\nLockstep should continue whether or not the vehicle is in offboard mode\r\n\r\n## Log Files and Screenshots\r\n![ezgif com-gif-maker (7)](https://user-images.githubusercontent.com/5248102/184627710-599d08b6-7dd7-4575-87b4-3a20d15122c4.gif)\r\n\r\n- Video: https://youtu.be/Mpve5DSk0qk\r\n- Flight log: https://review.px4.io/plot_app?log=e2dcc255-3b39-40df-ae5b-3576c6185698\r\n\r\n## Additional context\r\n- We are currently implementing an iNDI controller using the offboard interface internally\r\n- Offboard actuator setpoints were added in https://github.com/PX4/PX4-Autopilot/pull/18581 , where lockstep has been disabled for testing until now",
    "state": "open",
    "pull_request": null
  },
  {
    "title": "Catapult launch: Motor delay not working ",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/18416",
    "body": "Hi I need to open this ticket again. Initial ticket was: 18354 (it was closed. I can^t change it back via the Web GUI)\r\n\r\nPX4 (SW 1.12.3 / HW holibro pixhawk 4) The Motor starts immedialtely after launch is detected. This causes damage to the propeller, because it hits the catapult. Actual behaviour: If Accelerometer threshold > LAUN_CAT_A then Motor starts immediately Expected behaviour: If Accelerometer threshold > LAUN_CAT_A then Motorstart is delayed by value of LAUN_CATMDEL waits then motors starts.\r\nParameters: LAUN_CAT_MDEL and LAUN_CAT_T have no effect. Motor startup is not delayed as expected.\r\n\r\nThe log is made with Master\r\nhttps://review.px4.io/plot_app?log=06b779a9-95b5-4413-a82f-d4f5734ed81d\r\n It was working in 1.9.1\r\n",
    "state": "open",
    "pull_request": null
  },
  {
    "title": "Takeoff close to Geofence causes drone to fly away uncontrollably",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/18297",
    "body": "**Describe the bug**\r\nDrone flies perpendicular to geofence on takeoff close to geofence. The drone places a setpoint ~7 m away from launch point and tries to reach it aggressively.  This is very dangerous behavior which can and has caused crashes in the past.\r\n\r\nToday we went out with another drone (different flight controller and hardware) to try to trigger the same behavior and managed to do so immediately. We did two flights to ensure repeatability.\r\n\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Place drone close to but not outside of geofence border.\r\n2. Enter takeoff mode. \r\n\r\n\r\n**Expected behavior**\r\nTakeoff to set altitude.\r\n\r\n**Log Files and Screenshots**\r\n[First flight](https://review.px4.io/plot_app?log=3d188929-9d67-4ff6-8a6f-eff40df8d200)\r\n[Second flight](https://review.px4.io/plot_app?log=5f430551-e48f-4486-ae38-35db4489b12d)\r\n\r\n\r\n**Drone (please complete the following information):**\r\n- FW Version 1.12.0\r\n- Holybro S500\r\n- Pixhawk 4 FC\r\n- CUAV H16 radio module\r\n\r\n",
    "state": "open",
    "pull_request": null
  },
  {
    "title": "Navigation Errors during FW Flight",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/17635",
    "body": "Pixhawk 4\r\n1.11.3 - Fixed Wing\r\n\r\nAfter some debate on this I decided to open an issue.\r\n\r\nNavigation between waypoints is not consistent and does not follow the expected direction (more detail below). The direction is circuitous.\r\n\r\n\r\n\r\nIn the first log, it was clear there was some mag interference (this was seen on the ground prior to takeoff - approximately 10 degrees could not be corrected even after multiple calibrations) but the issue was that the trajectory from one waypoint to the next does not make sense (in parts of the flight). Instead of going from one point to the next, there are large turns between them.\r\n\r\nI questioned if this was due to an insufficient SD card speed for reading the mission. Testing the SD card speed in QGC gave an average speed of 63kb/s (much too slow but this was only changed after these flights) and there are logging dropouts at some of the points in the log. Right around 22 min where the location looks to be sideways, it was not. In the telemetry replay it does a coordinated turn. This turn at least makes sense, that is the direction is was supposed to go. That changes though later in the same flight.\r\n\r\nAt 22:46 it looks like the aircraft starts to circle down. Maybe to hit the altitude set-point but that does not make too much sense seems it looks like it doesnt actually miss it. After it does circle down though it then just decides to go left (no errors still) and then circle around again. Mag issue? There is no reason for a turn to be in that direction though. The question becomes is if this is mag related and or SD card read access speed and mission related.\r\n\r\nLog 1 - \r\nhttps://review.px4.io/plot_app?log=72ac3453-0872-447d-8716-3fcca37c1e9e\r\n\r\n\r\n\r\n\r\n\r\n\r\nThe below log had a new mag installed and there weren't any offsets observed or mag ratios, etc but at 13:17 instead of turning left, the aircraft made a roll to the right before banking to the left to turn. Additionally, it went directly through the waypoint before turning instead of starting at the L1 distance and making the typical rounded turn. From 13:18-13:25 the log looks like the aircraft is going to the wrong direction but there is also a log dropout there, in the telemetry log the orientation and direction looks correct in terms of how the aircraft flew but not why it still turned so late and went right then left. \r\n\r\n\r\nLog 2-\r\nhttps://review.px4.io/plot_app?log=1e2b37e4-b557-45d3-9f73-6fb099bf0fa4",
    "state": "open",
    "pull_request": null
  },
  {
    "title": "pitch setpoint drops just after the back-transition ",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/16483",
    "body": "**Describe the bug**\r\n\r\nthere's a sudden drop in the pitch setpoint just after the back transition of the standard vtol in the master. i think the initial setpoint after the back transition is set to zero  just after the back-transition, i just looked at the value of _v_att_sp.pitch_body in the vtol_att_control_main.cpp file in case mode:ROTARY_WING\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\nyou can load this plan and reproduce the same with standard_vtol\r\n[plan.zip](https://github.com/PX4/PX4-Autopilot/files/5765173/plan.zip)\r\n\r\n**Expected behavior**\r\npitch setpoint should not drop immediately just after the transition, it should come down gradually.\r\n\r\n**Log Files and Screenshots**\r\nhttps://review.px4.io/plot_app?log=19538338-d46f-4c67-a3ca-11e7d1566eb9\r\n\r\nAdd screenshots to help explain your problem.\r\n![image](https://user-images.githubusercontent.com/25317204/103545932-4734cb00-4ec8-11eb-930a-e547bc36c476.png)\r\n\r\n**Additional context**\r\nI think when changing from the flight_mode it zeros the pitch setpoint on full rotary_wing mode.\r\n",
    "state": "open",
    "pull_request": null
  },
  {
    "title": "undesirable back-transition behavior.",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/16474",
    "body": "when using just the vtol-transition mission item in qgc, or flipping the switch from fw to mc mode stabilized mode, the curved path gets executed with a rolling behavior in the back transition\r\n\r\nthis is solved in the pr-vtol-rtl-fixes when using vtol transition and land mode, but however it still persists on the above mentioned conditions as the l1 controller is present in those two conditions in the back-transition.\r\n\r\n**Alternate Solution**\r\nhttps://github.com/PX4/PX4-Autopilot/blob/d502292d0731a38c513dc1224c135b6f1965586e/src/modules/vtol_att_control/standard.cpp#L283\r\nin the current master, _fw_virtual_att_sp->roll_body diverges from zero after some time in the back-transition, can we make it a hard zero as we don't want the aircraft to roll in the back-transition anyway?\r\n\r\n**To Reproduce**\r\nto reproduce, in a mission set a vtol-transition mission item at the end of the mission. the behavior can be observed.\r\n\r\n\r\n**Expected behavior**\r\nThe vtol should transition to mc_mode in a straight line without going in a curved path with a roll.\r\n\r\n**Log Files and Screenshots**\r\nhttps://review.px4.io/plot_app?log=1e1bb5d2-5260-40da-bd7e-46fadf55fc6c\r\n\r\n**Additional context**\r\ni think this addresses the same issue\r\nhttps://github.com/PX4/PX4-Autopilot/issues/14933\r\n\r\nhttps://github.com/PX4/PX4-Autopilot/pull/14405/files\r\nthis introduced l1 controller to be present in the back transition which is good, but i think it needs to be further analyzed, cause this causes the aircraft roll in the back transition, which is not desirable. \r\n ",
    "state": "open",
    "pull_request": null
  },
  {
    "title": "VTOL standard flight to review",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/16427",
    "body": "\r\n![Screenshot from 2020-12-18 13-34-46](https://user-images.githubusercontent.com/84712/102648630-d5255d80-4135-11eb-91be-57a1276bbcb2.png)\r\n\r\n\r\n\r\nhttps://review.px4.io/plot_app?log=4240e1a9-5f40-4e5b-be73-812f59a072e3\r\n\r\nhttps://px4.slack.com/archives/C39C4E709/p1608315970050900",
    "state": "open",
    "pull_request": null
  },
  {
    "title": "[VTOL] Broken Weathervane & broken MPC_YAW_MODE",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/15673",
    "body": "**Describe the bug**\r\nThe weather vane does not work anymore in Mission (MC mode). Neither does MPC_YAW_MODE have an effect on the heading. So the drone ends up flying in all directions with the same heading, which is ugly to watch and can be dangerous in high winds. \r\n\r\n**To Reproduce**\r\n\r\nTested in SITL on v1.11.0:\r\n1. Launch Gazebo with `make px4_sitl gazebo_standard_vtol__windy` (by default 4m/s wind from South to North)\r\n2. Execute some mission which contains navigation in MC mode (e.g. [Dummy_MC_loop.zip](https://github.com/PX4/Firmware/files/5162328/Dummy_MC_loop.zip))\r\n3. Observe the heading.\r\n\r\n\r\n\r\n**Expected behavior**\r\nAs stated in the docs (https://docs.px4.io/master/en/config_vtol/vtol_weathervane.html#mission-mode-behaviour). The drone should head into the wind. Also, MPC_YAW_MODE should behave as for a normal MC. I'm open to discussion whether the weather vane should have precedence over the heading calculations of MPC_YAW_MODE or not or if both should be active at the same time and you end up with a compromise. But certainly not changing the heading at all is not good.\r\n\r\n**Log Files and Screenshots**\r\n https://logs.px4.io/plot_app?log=41546a93-eaeb-45c8-af75-fcfd2af6b967 : always heading east, neither weathervaning nor heading towards waypoint.\r\n\r\nhttps://review.px4.io/plot_app?log=5cd8b35e-390b-476c-85fb-30ac2fd3ff42 : high winds on a custom branch with minor modifications from v1.11-beta. The drone gets carried away because it can't fight the wind in its bad orientation. --> dangerous situation.\r\n\r\n\r\n**Drone (please complete the following information):**\r\ngazebo_standard_vtol\r\n",
    "state": "open",
    "pull_request": null
  },
  {
    "title": "Pixhawk 4 + Drotek Sirius RTK GNSS compasses inconsistent",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/15312",
    "body": "**Drone**\r\nS500 with Pixhawk 4 and Drotek Sirius RTK GNSS (with RM3100 magnetometer).\r\nPixhawk 4 with rotation_roll 180\r\nGPS no rotation\r\n\r\nInstalled master firmware to Pixhawk 4, the vehicle couldn't arm due to compasses inconsistent pre-arm check error, this error is not cleared even after compass calibration. Pixhawk 4 and GPS (with external compass) are facing forward, but the error says they are inconsistent. Installed previous commits until I found the issue was introduced by commit e819f99, before this commit I'm not getting this error.\r\n\r\nCompass calibration can be performed without issue, but this will not clear the pre-arm error.\r\n\r\nCompass calibration was performed outdoors and indoors with the same result.\r\n\r\nChecked with the GPS (with compass) included with Pixhawk 4 and is working, so this is issue is with the Drotek Sirius RTK GNSS device. \r\n\r\n**To Reproduce**\r\n1. Use Pixhawk 4 + Drotek Sirius RTK GNNS\r\n2. Install commit  e819f99 or a newer commit.\r\n3. Try to arm\r\n4. See compasses inconsistent error\r\n5. Calibrate compass\r\n6. Try to arm\r\n7. See error\r\n\r\n**Expected behavior**\r\nVehicle should be able to arm since compasses are facing same orientation.\r\n\r\n**Log Files and Screenshots**\r\nhttps://review.px4.io/plot_app?log=8e97f377-2aff-4c9a-8306-a9f13b43df1c\r\n\r\n![aec1b92_ng](https://user-images.githubusercontent.com/37613459/87255296-646b6e00-c43e-11ea-90b7-b8b367243d07.PNG)\r\n",
    "state": "open",
    "pull_request": null
  },
  {
    "title": "V1.11.0 (Beta&Master) MC control doesn´t switch off in FW (tiltrotor-vtol)",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/15155",
    "body": "all mc mot control remains active (VT_FW_MOT_OFFID doesn´t apply) even the nacelles are full swivelled to FW (differental thrust is only added in FW)\r\n\r\nIt can be testet on the ground with Convergence Vtol: \r\narm -> apply a bit throttle -> switch to FW -> nacelles swivel in 2 steps fully forward to FW -> Mot 3 continues running -> all 3 Mot are still under MC control if you apply roll/pitch commands\r\n\r\nfully to FW ->In this case Mot 3 should turn off and Mot 1,2 now should only be controlled by differential thrust \r\n\r\nhttps://review.px4.io/plot_app?log=dcd387e6-8402-4b7b-b53c-14096527066f\r\n\r\nConvergence with Pixracer R14 \r\nMade a real flight and thought, I could remove the problem with my external mixers ... but unfortunately this ended in a crash. \r\nhttps://review.px4.io/plot_app?log=379ea7f6-38e4-40ed-829b-6e333d91b053",
    "state": "open",
    "pull_request": null
  },
  {
    "title": "Altitude Losses and Gains: Possible Barometer Issues",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/15096",
    "body": "**Description:**\r\nPX4 struggles to hold altitude using the barometer in both the AltHold and PosHold flight modes. Cross-breezes result in altitude gains/losses. Maneuvers result in altitude loss. Typically, the more rapid the maneuver the larger the altitude loss.\r\n\r\n**To Reproduce:**\r\n\r\n_Method 1_\r\n1. Drone switched into position hold and armed after a 3D-lock is obtained.\r\n2. Take off to an altitude far beyond the ground-effect zone.\r\n3. Pick an axis to evaluate (eg. positive x-axis)\r\n4. Perform a full-stick maneuver along that axis until max horizontal speed is achieved.\r\n5. Release the sticks\r\n6. Altitude is lost near the end of the position change and during the braking maneuver. For these maneuvers the altitude returns to the set-point after 2-5sec (far too long).\r\n[Maneuver Altitude Loss]( https://review.px4.io/plot_app?log=4972dc44-0636-4abc-a065-dbc4c23d32f5)\r\n\r\n_Method 2_\r\n1. Drone switched into position hold and armed after a 3D-lock is obtained.\r\n2. Take off to an altitude far beyond the ground-effect zone.\r\n3. Release sticks (no RC input). \r\n4. Wait for a cross-breeze\r\n5. Altitude raises or lowers (multiple meters). During these tests the drone very slowly (10-25sec), if ever, returns to the setpoint. \r\n[Wind Altitude Gain/Loss](https://review.px4.io/plot_app?log=511f8756-384c-4a3d-b214-4f9a8f401b58)\r\n\r\n**Expected Behavior:**\r\nIn AltHold and in PosHold, if the z-setpoint is not changed, the craft will not change altitude.   \r\n\r\n**Screenshots:**\r\n_Method 1_\r\n![Forward Dip](https://user-images.githubusercontent.com/66424788/84535991-eb4fee00-acba-11ea-9d09-45d2a5344f4c.png)\r\nCaption: Note the bulge in the barometer altitude coupled with the decrease in thrust both of which result in a dip during and after maneuvers.\r\n\r\n_Method 2_\r\n![Wind Altitude Gain](https://user-images.githubusercontent.com/66424788/84535994-ebe88480-acba-11ea-8888-dcaf1bbf9951.png)\r\nCaption: Note the three bulges in velocity and the area between the actual and desired curves. NO RC commands or values were given between 2:40 and the 3:25 time-stamps. After 3:25, the drone started to gain many meters of altitude at which point a downward RC command is given. Even though almost full-stick down is commanded, the copter continued to rise until the breeze (2-5mph) settled. \r\n\r\n**Craft Specifications:**\r\nThe craft itself runs 18x5.5in props on a 900mm frame and uses a Holybro Pixhawk 4 running PX4. The craft is rather heavy but well within the motors and batteries specifications for thrust and power available/required respectively.\r\nFirmware version v1.10.1 was used for all initial testing. Firmware version v1.11.0-beta2was used to connect external barometers through the I2C port (ex. for BMP388) because this is not provisioned for in v1.10.1.\r\nThese same performance issues are also present and reproducible on a much lighter craft (15x5.5 props, 750mm frame, Pixhawk 4, v1.10.1).\r\n\r\n**Attempted Solutions:**\r\n1)\tThe first tests were performed using the stock on-board MS5611 barometer with no shielding. The flight performance was fine but produced noticeable dips upon maneuvering in any direction. \r\n2)\tThe issue  https://github.com/PX4/Firmware/issues/10058 suggested shielding the barometer, and adjusting the EKF2_BARO_NSE, EKF2_PCOEF_%%%, EKF2_BCOEF_%%%, and EKF2_DRAG NOISE parameters. Shielding the barometer in an indirectly ported enclosure did not produce noticeable differences. (in either data or performance). Adding open-cell foam around the PX4 inside the enclosure also did not produce noticeable differences. Moving the barometer very far away from the propellers did not produce noticeable differences.\r\n3)\tAfter shielding and isolation were tested and had no effect on the problem, the suggested parameters began to be changed but shielding with enclosure and foam was kept for the remaining test. Setting the XN, XP, YN, and YP EKF2_PCOEFs to their minimum value of -.5 very slightly reduced the dip (10-30cm out of 1-3m). \r\n4)\tAfter PCOEFs were ineffectual, the BCOEFs were next to be altered. A theoretical ballistic coefficient was calculated for this aircraft using the drag coefficient of a flat-plate, the mass of the aircraft, and the area of the central plate. The calculated value was 23.96kg/m^2 (1kg/m^2 lower than default). The ballistic coefficient parameter was altered from minimum to maximum values. The EFK2_drag.innovations[0:1] were examined after each flight but did not change in RMS value. EKF2 Replay was attempted using JMavSim on a Windows 10 machine but errors were thrown upon completion of the documentation steps and replay never worked. Changing BCOEFs had little to no effect on the EKF2 innovations for both drag and wind estimation.\r\n5)\tThe last of the suggested parameters was EKF2_BARO_NSE. Raising EKF2_BARO_NSE to a value of 5m improved flight performance and reduced dips while maneuvering. This is NOT a solution to the problem as all it does is transition estimation authority from to the barometer to the GPS. The entire intent of this testing is to have consistent altitude performance even without GPS assistance (to fly in buildings and structures) therefore this is not the most desirable solution.\r\n6)\tAfter the above parameters failed to solve the problem, the EKF2_HGT_MODE was changed from barometer to GPS. This stopped the dip from occurring but once again is not a solution. After GPS was used, a downward-facing LIDAR was used with range-aid enabled without it being the primary height sensor and with range-aid and as the primary height sensor. Both of these removed the dip while maneuvering and followed terrain well. These too are undesired solutions due to limited LIDAR range and the possibility of ground-based objects messing up the LIDAR altitude estimation.\r\n7)\tThe next series of testing began with an external barometer/GPS from Zubax enabled via UAVCAN. This also featured the MS5611 chip and yielded the same results as the on-board MS5611 for all of the above tests. This GPS was also enclosed in the Zubax designed enclosure with open cell foam in the barometer enclosure (inside the overall enclosure). With UAVCAN enabled, both the external barometer and the external GPS were used as the primary GPS and barometer but did not produce noticeable differences in flight performance.\r\n8)\tNo other types of barometers were supported in v1.10.1 so v1.11.0-beta2 was used for the rest of the testing. The v1.11.0-beta2 code was altered to enable the driver for the BMP388 acquired from Adafruit. The MS5611 driver was also disabled to ensure that the BMP388 would be used for pressure-height data and not the on-board sensor. The PIDs for the rate, attitude, and XY- position controllers were able to be tuned to achieve the desired performance. The Z-position/velocity controller gains were left at default. Hover flight could be achieved as expected however, when a breeze blew the craft would gain altitude and not settle back to the set-point. The second log of the 3-4min flight is the best example of this. No control input would be given and the craft would gain altitude at the maximum allowed vertical speed (2m/s, default = 3m/s). The P and I values of the controller were reduced to close-to or just above the minimum allowed values (to create a sluggish and under-tuned controller) and still the craft would ascend at maximum vertical speed in a slight cross-breeze (2-5mph). For the end of the flight, the rise in altitude was partially counteracted by a downward RC command but almost full-stick down was commanded before the aircraft consistently began to descend.\r\n\r\n**Notes:**  \r\nI hypothesize that both flight abnormalities are caused by the pressure changes across the barometer. That being said, all tested barometers were a fully enclosed as they could have been without rendering them inoperable. My second hypothesis is that the altitude fusion in the EKF2 does not handle these barometer fluctuations well. The same craft flown with a DJI A3 controller does not have these problems when flown under the same conditions (wind, maneuvers, poor GPS environment, etc.). These logs and descriptions hopefully show problems with dynamic pressure handling (either craft moving in static air or air moving over static craft) that Pixhawk 4 has. This problem effects AltHold, PosHold, and Loiter flight modes and mission performance in many different scenarios and its significant diminishment or removal would make PX4 based systems more useful and versatile. \r\n",
    "state": "open",
    "pull_request": null
  },
  {
    "title": "Drone flies towards old mission waypoint on arm, when no current=1 is set on new mission",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/14981",
    "body": "**Describe the bug**\r\nWhen a mission is stopped midway, and the drone then lands, receives a new mission with all items having ``current=0`` parameters and is armed again, the drone immediately flies towards the waypoint from the old mission, instead of executing the first item on the new mission. This crashed our drone as it tilts and tries to fly forward before properly \"takeoff\" to a safe altitude, thus catching the ground with the landing struts.  \r\n\r\nThe resetting of ``mission_current`` seems to happen upon arming, but there seems to be some sort of race-condition, as the drone reports ``mission_current`` to reset to 0 upon arming, but the log shows the drone still gets a setpoint for the old waypoint and tries to fly that, before the ``mission_current`` index reset is realised.\r\n\r\nThomas Stauber spotted that our velocity controller asked for a 3m/s horizontal velocity immediately upon arming, which indicated that the drone was flying towards an old mission item.\r\n![image](https://user-images.githubusercontent.com/7889925/82942796-d4aa5700-9f98-11ea-85f8-13f5744f75a6.png) \r\n\r\n**To Reproduce**\r\nSteps we did to reproduce the behaviour:\r\n1. Fly normal mission\r\n2. Before normal mission finishes, switch mode to \"land now\" or \"RTL\" and land the drone\r\n3. Start new flight with identical mission. (It uploads the same mission again, but doesn't clear the old one first)\r\n4. Arm and send \"start_mission\" command\r\n5. Drone attempts to fly to the waypoint it was at in the last mission and thus flip in the direction of that waypoint.\r\n\r\n**Expected behavior**\r\nUpon uploading a new mission with no ``current=1`` parameters set, we would expect the drone to reset the current-index of mission items to 0. Intuitively I would expect the index to get reset when the PX4 accepts the new mission and sends ``MAV_MISSION_ACCEPTED`` and not first on arming the drone. \r\n\r\n**Log Files and Screenshots**\r\nflight log: https://review.px4.io/plot_app?log=116b78e1-7732-4e6e-acf8-88e640d8cdfc \r\nvideo of the takeoff and flip: https://nextcloud.sdu.dk/index.php/s/46H7m9TXgXkQqQF\r\n\r\nlog from our GCS rosbag, showing the ``mission_current`` is not reset until arming, but keeps the old missions current index. The new mission had been uploaded and accepted by the PX4 before this snippet from the log:\r\n```\r\n---\r\ndata: 0\r\n---\r\ndata: 0\r\n---            <----------- a second before it changes to 15, the flightmode of the FC is set to \"Auto - Mission\". It appears the current_waypoint change is due to the flightmode being changed\r\ndata: 15\r\n---\r\ndata: 15\r\n---\r\ndata: 15\r\n---\r\ndata: 15\r\n---\r\ndata: 15\r\n---            <----------- Right at the same time it goes from 15 to 0, is when the drone report it is \"armed\". So it seems like the index isn't reset until the drone is armed\r\ndata: 0\r\n---\r\ndata: 0\r\n---\r\ndata: 0\r\n---\r\n```\r\n\r\n\r\n**Drone (please complete the following information):**\r\n- Hexacopter using Pixhawk 2.1 Cube\r\n- (The long legs shown on the video are due to testing, we know they are long, ugly and doesn't help make it stable)\r\n- SD-card for PX4: Scandisk Edge 16GB - Class 4\r\n\r\n**Additional context**\r\n\r\nAs soon as we added ``current=1`` on the first item of the new mission we can no longer reproduce this error and we are using that fix for the time being. ",
    "state": "open",
    "pull_request": null
  },
  {
    "title": "Takeoff denied in HITL Simulation with Gazebo",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/14721",
    "body": "**Describe the bug**\r\nWhen running a HITL setup with Gazebo, I can arm (the rotors in Gazebo start spinning) but I cannot takeoff. QGC's error message is only \"Takeoff command temporarily rejected\". In the log it says \"Critical: Takeoff denied! Please disarm and retry\". Doing so leads to the same result.\r\nA SITL setup with Gazebo works fine. Using JMavSim in a HITL setup works perfectly, too.\r\nOne difference I have noticed when comparing my error scenario to the two that work: QGC says the value of Alt (Rel) is NaN (or --.-- on the HUD).\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Install the development toolchain according to the [Toolchain Installation](https://dev.px4.io/v1.9.0/en/setup/dev_env.html).\r\n2. Follow the [instructions for setting up a HITL simulation](https://dev.px4.io/v1.9.0/en/simulation/hitl.html) with Gazebo.\r\n    a) In step 4 of the Simulation Setup for Gazebo I use `/dev/tty.usbmodem01` on my MacBook Pro. On an iMac I've had to use `/dev/tty.usbmodem1`.\r\n    b) In a recent commit the iris world was removed, so instead of running Gazebo as in step 5 of the Gazebo Setup section, I've had to run `make px4_sitl gazebo` again to achieve the same result. I have already had the described problem before this change was made.\r\n3. After starting QGC in step 6 of the instructions for the Gazebo Setup, arm the drone and select Takeoff in QGC.\r\n\r\n**Expected behavior**\r\nThe drone should takeoff without errors and I should be able to see that it does so in the Gazebo client.\r\n\r\n**Log Files and Screenshots**\r\nFlight log file: [Log file link](https://review.px4.io/plot_app?log=629eabe0-cfbb-4cd8-ad61-29d150175b0f)\r\n\r\n**Drone:**\r\nI am using an FMUK66 board by NXP.\r\n\r\n**Additional context**\r\nI am running macOS 10.15.4.\r\n",
    "state": "open",
    "pull_request": null
  },
  {
    "title": "Altitude hold not working with GPS as primary height source and GPS blending enabled",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/14267",
    "body": "Autopilot= Pixhawk 4\r\nFirmware= Branch based on v1.10\r\n\r\n**Describe the bug**\r\nAltitude hold not working when GPS is the primary height source and we are blending two different GPS modules (one is ublox and one ashtech).\r\n\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1) Set the primary height mode to GPS (EKF2_HGT_MODE=1)\r\n2) Enabled GPS blending (EKF2_GPS_MASK=3)\r\n3) Takeoff to about 1 meter. --> the drone started going down. I started counteracting with the sticks but it was still going down. \r\n\r\n\r\n**Log Files and Screenshots**\r\nBlending enabled but baro as primary height source (this works fine): https://review.px4.io/plot_app?log=1da0b48b-deed-4963-8efa-e3a646b20018\r\n\r\nBlending enabled and gps as primary height source (issue) - log1: https://review.px4.io/plot_app?log=2c5ab2b2-38a4-4d37-ad4c-e2bb3e564966\r\n\r\nBlending enabled and gps as primary height source (issue) -log2: https://review.px4.io/plot_app?log=c65eae25-6f75-4583-849f-11567e01d231\r\n",
    "state": "open",
    "pull_request": null
  },
  {
    "title": "Runway takeoff not tracking",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/14262",
    "body": "Runway takeoff (on fixed wing with the nose gear on its own channel) is not tracking. It immediately veers off to the right substantially taking it off the runway. \r\n\r\n3 logs of this with one log having large gains and unlimited travel for good measure on the wheel controller.\r\n\r\nTo further test this we took another aircraft in a different location and recreated. That log is not attached but it obeyed in the identical way.\r\n\r\nThere is more than enough wheel authority, no errors, mag issues, etc so understanding the lack of tracking and any mission start yields to veering off to the right would be important to understand.\r\n\r\nhttps://review.px4.io/plot_app?log=d7858c28-bb1f-49df-9df5-c8fd04755a80\r\n(vibration only because it was taken at high speed off the runway)\r\n\r\nhttps://review.px4.io/plot_app?log=0d6e9b1f-1d37-43fb-a673-c19de0298fac\r\n(Immediate right upon initiating the mission - only look at the mission portion of the log)\r\n\r\nhttps://review.px4.io/plot_app?log=65c49e9f-61a4-4a75-8813-4ce66160a4c4\r\n(Immediate right upon initiating the mission - only look at the mission portion of the log but with larger wheel rate gains for good measure.)\r\n\r\n\r\nIt would seem like something is wrong for it to always want to go hard right first. Is this a bug or something that simply now needs to be re-tuned so there is a much more subdued effect on the WR controller's abilities? I just find it strange since this did occur occasionally over the years but not every time which is happening now. \r\n\r\n\r\nFirmware: 1.9.2\r\nPixhawk with 2mb of flash",
    "state": "open",
    "pull_request": null
  },
  {
    "title": "Failsafe for position loss in Offboard mode",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/14076",
    "body": "**Describe the bug**\r\nWhen a position loss event occurs while in Offboard mode (which requires a valid position estimate), the vehicle performs a blind land failsafe, despite the fact that COM_POSCTL_NAVL is configured to \"Assume R/C, switch to altitude mode...\" and there is a remote control.\r\n\r\n**To Reproduce**\r\nStream VISION_POSITION_ESTIMATE mavlink messages to simulated Iris copter (in Gazebo), switch to offboard and fly to a waypoint (via SET_POSITION_TARGET_LOCAL_NED message). While the drone is flying to the waypoint, stop sending VISION_POSITION_ESTIMATE messages.\r\n\r\n**Expected behavior**\r\nI would have expected that the failsafe obeys the COM_POSCTL_NAVL parameter and switches to Altitude mode (hight estimation was valid due to barometer). I also tried the same thing in Position mode and there it actually does switch to Altitude mode as expected.\r\n\r\n**Log Files and Screenshots**\r\nhttps://review.px4.io/plot_app?log=62c8308a-bd4d-4185-8db9-1e45d6e9efa0\r\nINFO  [ecl/EKF] 36996000: EKF commencing external vision position fusion\r\nINFO  [ecl/EKF] 36996000: EKF commencing external vision yaw fusion\r\nWARN  [ecl/EKF] 75820000: EKF ev hgt timeout - reset to baro\r\nWARN  [mc_pos_control] Position-Control Setpoint-Update failed\r\nWARN  [mc_pos_control] Failsafe: blind land\r\nINFO  [ecl/EKF] 77532000: EKF External Vision Data Stopped\r\nWARN  [ecl/EKF] 77540000: EKF stopping navigation\r\n\r\nFor comparison, this is the output when flying in Position-mode:\r\nINFO  [ecl/EKF] 533328000: EKF commencing external vision position fusion\r\nINFO  [ecl/EKF] 533328000: EKF commencing external vision yaw fusion\r\nWARN  [commander] Failsafe enabled: no local position\r\nWARN  [ecl/EKF] 560472000: EKF ev hgt timeout - reset to baro\r\nINFO  [ecl/EKF] 562184000: EKF External Vision Data Stopped\r\nWARN  [ecl/EKF] 562192000: EKF stopping navigation\r\n\r\n**Drone (please complete the following information):**\r\nIris in Sitl Gazebo, with PX4 1.10.0\r\n",
    "state": "open",
    "pull_request": null
  },
  {
    "title": "Large negative Pitch Setpoint at takeoff, hand launched Fixed Wing",
    "html_url": "https://github.com/PX4/PX4-Autopilot/issues/10076",
    "body": "Most of our fixed wing flight logs show a large negative step input to the pitch command right at Takeoff.  I think the \"minimum pitch\" param in the Takeoff Waypoint overrides this, but behind the scenes something is wrong.\n\nI've seen users attempt to auto-takeoff to a non-Takeoff Waypoint and the vehicle immediately noses into the ground.\n\nI suspect some bad interactions between LandDetector and typical ground handling of hand launched fixed wings, but I'm not sure what exactly...  (fyi @dagar we discussed previously).\n\n![image](https://user-images.githubusercontent.com/12117027/43370412-3c14b920-9344-11e8-8599-5b2aa06673f4.png)\n\nHere are a number of logs that show this issue right at Takeoff:\nhttps://review.px4.io/plot_app?log=80301c1d-fac9-4a8a-a5e1-870927233e64\nhttps://review.px4.io/plot_app?log=6f7119a2-c6c3-4d0c-88e5-8debcf59e88f\nhttps://review.px4.io/plot_app?log=a8b193bc-f3d7-4cab-ae3e-ba0302c1834b\nhttps://review.px4.io/plot_app?log=13dcbb27-7d97-49d4-94d3-0f092d283c7c\n\nRelated PR that attempts to improve Fixed Wing takeoff, might need to look into the root cause of this issue here:\nhttps://github.com/PX4/Firmware/pull/9243",
    "state": "open",
    "pull_request": null
  }
]