{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20586","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20586/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20586/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20586/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20586","id":1443988212,"node_id":"PR_kwDOAFDaZs5CoBXv","number":20586,"title":"commander: fix hold after mission logic","user":{"login":"tstastny","id":8026163,"node_id":"MDQ6VXNlcjgwMjYxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8026163?v=4","gravatar_id":"","url":"https://api.github.com/users/tstastny","html_url":"https://github.com/tstastny","followers_url":"https://api.github.com/users/tstastny/followers","following_url":"https://api.github.com/users/tstastny/following{/other_user}","gists_url":"https://api.github.com/users/tstastny/gists{/gist_id}","starred_url":"https://api.github.com/users/tstastny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tstastny/subscriptions","organizations_url":"https://api.github.com/users/tstastny/orgs","repos_url":"https://api.github.com/users/tstastny/repos","events_url":"https://api.github.com/users/tstastny/events{/privacy}","received_events_url":"https://api.github.com/users/tstastny/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-11-10T14:18:51Z","updated_at":"2022-11-10T15:17:20Z","closed_at":"2022-11-10T15:17:19Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20586","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20586","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20586.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20586.patch","merged_at":"2022-11-10T15:17:19Z"},"body":"In https://github.com/PX4/PX4-Autopilot/pull/20564, the change in logic to hold after mission clear also broke RTL, as non-mission takeoff still published a mission result which allowed entering the mission finished condition and always changing state to loiter (ignoring rtl). New logic only switches navigation states if mission is finish and the nav state is explicitly in takeoff state, or in mission state.\r\n\r\nI checked the following cases work as intended in SITL:\r\n- takeoff command, RTL command .. RTL actually is able to finish\r\n- takeoff command, `COM_TAKEOFF_ACT=0`, vehicle holds once done taking off\r\n- takeoff command, `COM_TAKEOFF_ACT=1`, vehicle enters the mission once done taking off\r\n- start mission, clear mission while it's running, vehicle holds","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20586/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":1,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20586/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20568","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20568/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20568/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20568/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20568","id":1440012706,"node_id":"PR_kwDOAFDaZs5Caf3c","number":20568,"title":"[1.13] VTOL takeoff problem hotfix","user":{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":1663505148,"node_id":"MDU6TGFiZWwxNjYzNTA1MTQ4","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/release%20backport%20%F0%9F%94%99","name":"release backport 🔙","color":"16a2c9","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false},"assignees":[{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false}],"milestone":null,"comments":2,"created_at":"2022-11-08T11:26:55Z","updated_at":"2022-11-11T01:48:47Z","closed_at":"2022-11-11T01:48:46Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20568","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20568","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20568.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20568.patch","merged_at":"2022-11-11T01:48:46Z"},"body":"## Describe problem solved by this pull request\r\n@OfficerJannis reported that the problem I fixed in https://github.com/PX4/PX4-Autopilot/pull/20171 also happened to him on  the release 1.13. Also I got basically the same report a second time on Discord from SZ#6337 sadly in private (will not accept that in the future anymore).\r\n\r\nSo I'm following @julianoes 's valid request here https://github.com/PX4/PX4-Autopilot/pull/20171#issuecomment-1301359524 and backport the fix to 1.13.\r\n\r\nFYI @OfficerJannis\r\n\r\n## Describe your solution\r\nSee https://github.com/PX4/PX4-Autopilot/pull/20171\r\n\r\n## Test data / coverage\r\nThis was tested by many people by now on `main` and reportedly also backported to older versions to fix the original issue.","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20568/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20568/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20543","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20543/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20543/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20543/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20543","id":1434820706,"node_id":"PR_kwDOAFDaZs5CJTKQ","number":20543,"title":"vehicle_magnetometer: fix standalone mag bias est factored into in flight mag cal","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2022-11-03T15:06:59Z","updated_at":"2022-11-07T14:32:15Z","closed_at":"2022-11-07T14:31:18Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20543","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20543","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20543.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20543.patch","merged_at":"2022-11-07T14:31:18Z"},"body":"The preflight mag bias estimate is in the vehicle body frame and removed from the raw mag data after it's rotated, calibrated, etc.\r\n\r\nThe in flight mag bias (from ekf2) is in the vehicle body frame, but stored as a sensor frame offset immediately.","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20543/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20543/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20539","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20539/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20539/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20539/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20539","id":1433769925,"node_id":"PR_kwDOAFDaZs5CFxwl","number":20539,"title":"ekf2: push mag cal reset to delayed time horizon","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":666022583,"node_id":"MDU6TGFiZWw2NjYwMjI1ODM=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/EKF2","name":"EKF2","color":"1d76db","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-11-02T20:47:32Z","updated_at":"2022-12-13T15:24:04Z","closed_at":"2022-12-13T15:24:03Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20539","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20539","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20539.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20539.patch","merged_at":"2022-12-13T15:24:03Z"},"body":" - not a verified bug, but depending on configuration and timing this potentially could have resulted in a mag calibration change causing EKF2 to reset mag states, but immediately performing the reset on previous mag data (without the new calibration)","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20539/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20539/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20525","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20525/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20525/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20525/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20525","id":1430134410,"node_id":"PR_kwDOAFDaZs5B5jJN","number":20525,"title":"ekf2: ensure minimum output buffer sizing","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":666022583,"node_id":"MDU6TGFiZWw2NjYwMjI1ODM=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/EKF2","name":"EKF2","color":"1d76db","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-10-31T16:31:26Z","updated_at":"2022-11-09T14:49:37Z","closed_at":"2022-11-09T14:49:35Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20525","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20525","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20525.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20525.patch","merged_at":"2022-11-09T14:49:35Z"},"body":" - buffer at least 2 samples for the IMU (and output predictor buffers) and observation buffers\r\n - dropping below 2 becomes problematic for the minimum observation interval calculation and the vertical output buffer trapezoidal integration\r\n\r\nArguably the real (potential) issue here is that the EKF delayed time horizon configuration isn't factoring in the difference between the timestamp and timestamp_sample in many of the incoming data sources. So for now we'll at least have this minimal protection.\r\n\r\nThe longer term solution will be monitoring incoming data sources and determining an appropriate delay for each that factors in the timestamp_sample delay initially. \r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20525/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20525/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20518","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20518/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20518/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20518/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20518","id":1429629266,"node_id":"PR_kwDOAFDaZs5B32dw","number":20518,"title":"ControlAllocation: implement custom saturation logic for tilt-for-yaw actuation","user":{"login":"sfuhrer","id":26798987,"node_id":"MDQ6VXNlcjI2Nzk4OTg3","avatar_url":"https://avatars.githubusercontent.com/u/26798987?v=4","gravatar_id":"","url":"https://api.github.com/users/sfuhrer","html_url":"https://github.com/sfuhrer","followers_url":"https://api.github.com/users/sfuhrer/followers","following_url":"https://api.github.com/users/sfuhrer/following{/other_user}","gists_url":"https://api.github.com/users/sfuhrer/gists{/gist_id}","starred_url":"https://api.github.com/users/sfuhrer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfuhrer/subscriptions","organizations_url":"https://api.github.com/users/sfuhrer/orgs","repos_url":"https://api.github.com/users/sfuhrer/repos","events_url":"https://api.github.com/users/sfuhrer/events{/privacy}","received_events_url":"https://api.github.com/users/sfuhrer/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":249514594,"node_id":"MDU6TGFiZWwyNDk1MTQ1OTQ=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Hybrid%20VTOL%20%F0%9F%9B%A9%EF%B8%8F%F0%9F%9A%81","name":"Hybrid VTOL 🛩️🚁","color":"bfe5bf","default":false,"description":"Multirotor + Fixedwing!"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2022-10-31T10:39:50Z","updated_at":"2022-11-02T13:56:15Z","closed_at":"2022-11-02T13:56:14Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20518","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20518","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20518.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20518.patch","merged_at":"2022-11-02T13:56:14Z"},"body":"Addresses https://github.com/PX4/PX4-Autopilot/issues/20395\r\n\r\n## Describe problem solved by this pull request\r\nThere is very often some left over (unallocated) yaw torque, even though the tilts are not saturating. Reason is that when the tilts are used for yaw control, they are meant to move symmetrically to the front and back, but back is limited and thus there is some leftover torque not allocated. \r\n\r\n## Describe your solution\r\n- in `ControlAllocator::publish_control_allocator_status()` always fill allocated/unallocated torque from matrix, then allow them to be overwritten by custom `getAllocatedAndUnallocatedControl() `implementation (specific for effectiveness type)\r\n- add `actuatorEffectivenessTiltrotorVTOL::getAllocatedAndUnallocatedControl()` that only affects the yaw unallocated torque of matrix 0 (titls). Set `unallocated_torque[2] `corresponding to if the current yaw torque setpoint is within or outside of range (-1, 1).\r\n- `control_allocator_status.torque_setpoint_achieved` is always set to `if(norm(unallocated_torque) < 1e-6)`, not in custom saturation implementation. \r\n- remove logging of `allocated_torque` and `allocated_thrust`, as redundant information that can also be get through `setpoint`-`unallocated` \r\n\r\n## Describe possible alternatives\r\nCustom tilt allocation (instead of only custom saturation logic). \r\n\r\n## Test data / coverage\r\nSITL tiltrotor tested. \r\n\r\n## Additional context\r\nIn https://github.com/PX4/PX4-Autopilot/commit/cf8262465d7a23c125f6d60ef8dd7d0c545a41ab I simply renamed a couple of variables to make it easier to distinguish collective_tilt and separate tilt.\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20518/reactions","total_count":2,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":2,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20518/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20513","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20513/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20513/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20513/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20513","id":1429066232,"node_id":"PR_kwDOAFDaZs5B1-SB","number":20513,"title":"ekf2: accumulate multiple vel/pos/orientation reset deltas per update","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":666022583,"node_id":"MDU6TGFiZWw2NjYwMjI1ODM=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/EKF2","name":"EKF2","color":"1d76db","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-10-31T00:03:55Z","updated_at":"2022-11-15T18:20:56Z","closed_at":"2022-11-15T18:20:55Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20513","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20513","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20513.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20513.patch","merged_at":"2022-11-15T18:20:55Z"},"body":" - if in a single EKF update there are multiple resets we need to track the accumulated delta so the reset consumed by the controllers is correct","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20513/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20513/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20508","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20508/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20508/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20508/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20508","id":1428417016,"node_id":"PR_kwDOAFDaZs5Bz1GT","number":20508,"title":"Handle waypoint altitude acceptance radius correctly for boats","user":{"login":"Jaeyoung-Lim","id":5248102,"node_id":"MDQ6VXNlcjUyNDgxMDI=","avatar_url":"https://avatars.githubusercontent.com/u/5248102?v=4","gravatar_id":"","url":"https://api.github.com/users/Jaeyoung-Lim","html_url":"https://github.com/Jaeyoung-Lim","followers_url":"https://api.github.com/users/Jaeyoung-Lim/followers","following_url":"https://api.github.com/users/Jaeyoung-Lim/following{/other_user}","gists_url":"https://api.github.com/users/Jaeyoung-Lim/gists{/gist_id}","starred_url":"https://api.github.com/users/Jaeyoung-Lim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Jaeyoung-Lim/subscriptions","organizations_url":"https://api.github.com/users/Jaeyoung-Lim/orgs","repos_url":"https://api.github.com/users/Jaeyoung-Lim/repos","events_url":"https://api.github.com/users/Jaeyoung-Lim/events{/privacy}","received_events_url":"https://api.github.com/users/Jaeyoung-Lim/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":4448141081,"node_id":"LA_kwDOAFDaZs8AAAABCSE_GQ","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Boat%20%F0%9F%9A%A4","name":"Boat 🚤","color":"267EE2","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2022-10-29T19:20:52Z","updated_at":"2022-11-10T06:13:21Z","closed_at":"2022-10-31T08:13:14Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20508","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20508","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20508.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20508.patch","merged_at":"2022-10-31T08:13:14Z"},"body":"## Describe problem solved by this pull request\r\nWaypoints were not getting accepted since the altitude of the vehicle was being considered for accepting a waypoint.\r\n\r\nHowever, boats are ground vehicles where an altitude of a waypoint is not used.\r\n\r\n## Describe your solution\r\nThis corrects the waypoint handling logic to consider boat type vehicles as ground vehicles.\r\n\r\n## Test data / coverage\r\nTested in SITL with https://github.com/PX4/PX4-Autopilot/pull/20082\r\n\r\n## Additional context\r\n- This PR is a follow up of https://github.com/PX4/PX4-Autopilot/pull/20363\r\n- Fixes https://github.com/PX4/PX4-Autopilot/issues/19045","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20508/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20508/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20505","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20505/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20505/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20505/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20505","id":1427305795,"node_id":"PR_kwDOAFDaZs5BwKdA","number":20505,"title":"ekf2: handle GPS vel/pos timeout in addition to overall reset check","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":10884840,"node_id":"MDU6TGFiZWwxMDg4NDg0MA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/enhancement%20(improvement)%20%F0%9F%92%A1","name":"enhancement (improvement) 💡","color":"84b6eb","default":false,"description":""},{"id":594240307,"node_id":"MDU6TGFiZWw1OTQyNDAzMDc=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/VIO","name":"VIO","color":"fbca04","default":false,"description":null},{"id":666022583,"node_id":"MDU6TGFiZWw2NjYwMjI1ODM=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/EKF2","name":"EKF2","color":"1d76db","default":false,"description":""}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2022-10-28T13:58:00Z","updated_at":"2023-11-17T13:02:51Z","closed_at":null,"author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20505","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20505","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20505.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20505.patch","merged_at":null},"body":" - in a system with good EV + GPS it's possible that horizontal vel/pos fusion continues successfully, but GPS fusion is failing due to mediocre yaw alignment\r\n - GPS always check for yaw failure and act on it if there's corresponding GPS vel or GPS pos fusion timeout\r\n - add additional protections to prevent multiple yaw resets/alignments per update (the controllers won't get the proper heading delta if this happens)\r\n\r\n\r\nThis came up during https://github.com/PX4/PX4-Autopilot/pull/19128 testing and has been broken out of that large PR.\r\n![Screenshot_from_2022-10-25_09-35-38](https://user-images.githubusercontent.com/84712/198627899-7a4b6511-8025-40fb-ad2f-0d5a216ac0c2.png)\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20505/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":1,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20505/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20500","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20500/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20500/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20500/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20500","id":1426322160,"node_id":"PR_kwDOAFDaZs5Bs9F1","number":20500,"title":"fw rate control: initialize rate control resets to false in stabilized mode","user":{"login":"tstastny","id":8026163,"node_id":"MDQ6VXNlcjgwMjYxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8026163?v=4","gravatar_id":"","url":"https://api.github.com/users/tstastny","html_url":"https://github.com/tstastny","followers_url":"https://api.github.com/users/tstastny/followers","following_url":"https://api.github.com/users/tstastny/following{/other_user}","gists_url":"https://api.github.com/users/tstastny/gists{/gist_id}","starred_url":"https://api.github.com/users/tstastny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tstastny/subscriptions","organizations_url":"https://api.github.com/users/tstastny/orgs","repos_url":"https://api.github.com/users/tstastny/repos","events_url":"https://api.github.com/users/tstastny/events{/privacy}","received_events_url":"https://api.github.com/users/tstastny/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":78699916,"node_id":"MDU6TGFiZWw3ODY5OTkxNg==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Fixed%20Wing%20%F0%9F%9B%A9%EF%B8%8F","name":"Fixed Wing 🛩️","color":"009800","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"tstastny","id":8026163,"node_id":"MDQ6VXNlcjgwMjYxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8026163?v=4","gravatar_id":"","url":"https://api.github.com/users/tstastny","html_url":"https://github.com/tstastny","followers_url":"https://api.github.com/users/tstastny/followers","following_url":"https://api.github.com/users/tstastny/following{/other_user}","gists_url":"https://api.github.com/users/tstastny/gists{/gist_id}","starred_url":"https://api.github.com/users/tstastny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tstastny/subscriptions","organizations_url":"https://api.github.com/users/tstastny/orgs","repos_url":"https://api.github.com/users/tstastny/repos","events_url":"https://api.github.com/users/tstastny/events{/privacy}","received_events_url":"https://api.github.com/users/tstastny/received_events","type":"User","site_admin":false},"assignees":[{"login":"tstastny","id":8026163,"node_id":"MDQ6VXNlcjgwMjYxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8026163?v=4","gravatar_id":"","url":"https://api.github.com/users/tstastny","html_url":"https://github.com/tstastny","followers_url":"https://api.github.com/users/tstastny/followers","following_url":"https://api.github.com/users/tstastny/following{/other_user}","gists_url":"https://api.github.com/users/tstastny/gists{/gist_id}","starred_url":"https://api.github.com/users/tstastny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tstastny/subscriptions","organizations_url":"https://api.github.com/users/tstastny/orgs","repos_url":"https://api.github.com/users/tstastny/repos","events_url":"https://api.github.com/users/tstastny/events{/privacy}","received_events_url":"https://api.github.com/users/tstastny/received_events","type":"User","site_admin":false}],"milestone":null,"comments":0,"created_at":"2022-10-27T22:10:42Z","updated_at":"2022-10-28T07:26:52Z","closed_at":"2022-10-28T07:26:51Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20500","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20500","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20500.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20500.patch","merged_at":"2022-10-28T07:26:51Z"},"body":"There is a corner case where, if in an auto mode that sets a reset command on the attitude setpoint message (e.g. auto takeoff), if the mode was then switched stabilized, this reset bool would never be changed back to false and the integrators would reset every cycle.\r\n\r\nthis commit initializes them to false on the manual setpoint poll where they otherwise weren't explicitly set\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20500/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20500/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20488","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20488/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20488/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20488/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20488","id":1423960774,"node_id":"PR_kwDOAFDaZs5Bk_gH","number":20488,"title":"Navigator: remove update of reposition setpoint at Transition command","user":{"login":"sfuhrer","id":26798987,"node_id":"MDQ6VXNlcjI2Nzk4OTg3","avatar_url":"https://avatars.githubusercontent.com/u/26798987?v=4","gravatar_id":"","url":"https://api.github.com/users/sfuhrer","html_url":"https://github.com/sfuhrer","followers_url":"https://api.github.com/users/sfuhrer/followers","following_url":"https://api.github.com/users/sfuhrer/following{/other_user}","gists_url":"https://api.github.com/users/sfuhrer/gists{/gist_id}","starred_url":"https://api.github.com/users/sfuhrer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfuhrer/subscriptions","organizations_url":"https://api.github.com/users/sfuhrer/orgs","repos_url":"https://api.github.com/users/sfuhrer/repos","events_url":"https://api.github.com/users/sfuhrer/events{/privacy}","received_events_url":"https://api.github.com/users/sfuhrer/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2022-10-26T12:44:28Z","updated_at":"2022-12-14T10:45:20Z","closed_at":"2022-10-27T09:04:22Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20488","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20488","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20488.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20488.patch","merged_at":"2022-10-27T09:04:22Z"},"body":"Fixes https://github.com/PX4/PX4-Autopilot/issues/20477\r\n\r\n## Describe problem solved by this pull request\r\nSee https://github.com/PX4/PX4-Autopilot/issues/20477\r\n\r\n## Describe your solution\r\nRemove reposition hacks from logic handling of DO_TRANSITION. This was previously required to reset the flight speed after a VTOL transition, but is now no longer required as the DO_CHANGE_SPEED commands are handles directly in the controllers.\r\n\r\n## Test data / coverage\r\nSITL testing (standard vtol)\r\n\r\n## Additional context\r\nOriginally introduced here: https://github.com/PX4/PX4-Autopilot/pull/18834#issuecomment-996595040, then the DO_CHANGE_SPEED handling was changed with https://github.com/PX4/PX4-Autopilot/pull/19407 but it looks to me like this specific part was overseen and is not required anymore.\r\n\r\nBTW I think DO_SPEED_CHANGE is currently broken for MC in AUTO modes (at least for Goto). For FW it works. FYI @MaEtUgR \r\n\r\nFYI @ThomasRigi ","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20488/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20488/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20477","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20477/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20477/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20477/events","html_url":"https://github.com/PX4/PX4-Autopilot/issues/20477","id":1422141444,"node_id":"I_kwDOAFDaZs5UxCgE","number":20477,"title":"Broken Loiter: loitering at wrong position, erratic loiter direction","user":{"login":"ThomasRigi","id":48206725,"node_id":"MDQ6VXNlcjQ4MjA2NzI1","avatar_url":"https://avatars.githubusercontent.com/u/48206725?v=4","gravatar_id":"","url":"https://api.github.com/users/ThomasRigi","html_url":"https://github.com/ThomasRigi","followers_url":"https://api.github.com/users/ThomasRigi/followers","following_url":"https://api.github.com/users/ThomasRigi/following{/other_user}","gists_url":"https://api.github.com/users/ThomasRigi/gists{/gist_id}","starred_url":"https://api.github.com/users/ThomasRigi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ThomasRigi/subscriptions","organizations_url":"https://api.github.com/users/ThomasRigi/orgs","repos_url":"https://api.github.com/users/ThomasRigi/repos","events_url":"https://api.github.com/users/ThomasRigi/events{/privacy}","received_events_url":"https://api.github.com/users/ThomasRigi/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":78699916,"node_id":"MDU6TGFiZWw3ODY5OTkxNg==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Fixed%20Wing%20%F0%9F%9B%A9%EF%B8%8F","name":"Fixed Wing 🛩️","color":"009800","default":false,"description":""},{"id":174161208,"node_id":"MDU6TGFiZWwxNzQxNjEyMDg=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/priority-critical","name":"priority-critical","color":"e11d21","default":false,"description":null},{"id":249514594,"node_id":"MDU6TGFiZWwyNDk1MTQ1OTQ=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Hybrid%20VTOL%20%F0%9F%9B%A9%EF%B8%8F%F0%9F%9A%81","name":"Hybrid VTOL 🛩️🚁","color":"bfe5bf","default":false,"description":"Multirotor + Fixedwing!"},{"id":4147343828,"node_id":"LA_kwDOAFDaZs73M3HU","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug-report","name":"bug-report","color":"376B2E","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2022-10-25T09:19:32Z","updated_at":"2022-10-27T09:04:23Z","closed_at":"2022-10-27T09:04:23Z","author_association":"MEMBER","active_lock_reason":null,"body":"## Describe the bug\r\nThe drone sometimes loiters around a wrong position and doesn't respect NAV_LOITER_RAD nor the desired turning direction.\r\n\r\nI've observed it regularly on SITL VTOLs, and I could also break it once on a SITL plane. On VTOLs it's always the first HOLD command after a transition in mission mode which fucks up. The drone either holds around Home or at next Waypoint, but not at current position as it's supposed to. Resuming mission and then triggering Hold again works fine. Even the Hold in MC mode is affected by this, if triggered after a back transition.\r\n\r\nOn a pure FW drone I don't know what it takes to break, but it's possible as well. I've had one occurrence where the drone flew to the next WP instead of Loitering at current position.\r\n\r\nAlso, if this happens, then the NAV_LOITER_RAD is ignored and the drone is just flying with max bank angle. \r\n\r\nThe bug is present in both v1.13 and current main.\r\n\r\n## To Reproduce\r\nSteps to reproduce the behavior:\r\n1. `make px4_sitl gazebo_standard_vtol`\r\n2. Upload a mission containing a transition, e.g. the one here: \r\n[Zurich FT loiter bug.zip](https://github.com/PX4/PX4-Autopilot/files/9858850/Zurich.FT.loiter.bug.zip)\r\n3. Launch the mission. Trigger Hold at some point after the front transition.\r\n4. See error\r\n5. Feel free to resume mission, trigger Hold again, and observe that it works correctly again. Then resume mission, launch a back transition via QGC interface, and Hold again -> broken again.\r\n\r\n## Expected behavior\r\nThe drone should loiter around the point where the HOLD command was sent.\r\n\r\n## Log Files and Screenshots\r\nLog on v1.13 (roughly, our fork contains some minor changes but nothing which affects this) where the drone more or less returns home for Loiter : https://logs.px4.io/plot_app?log=f24d5c4e-b495-4d9b-93dc-b6e321beda15\r\n\r\nLog on upstream where I consistently managed to break the logic after transitioning, even after back transitions : https://logs.px4.io/plot_app?log=4e307d13-c94a-4543-a625-3e54d88ae0b9\r\n\r\nLog on upstream with tailsitter. Same behaviour as with standard VTOL: https://logs.px4.io/plot_app?log=f1441279-1e2f-42e1-8599-b17ff4881f19\r\n\r\nLog on upstream on a FW plane where I managed once (on the second trigger) to break the logic, but not the first time nor any time after: https://logs.px4.io/plot_app?log=683f7ffa-58c3-4860-ae32-debca6c1433e\r\n\r\nLog on upstream on a MC drone where I couldn't break it (not sure if nothing is broken for MC or if I just haven't found how to break it): https://logs.px4.io/plot_app?log=d2fafa11-a5fa-4bed-a6ed-108749353267\r\n\r\nAdd screenshots to help explain your problem.\r\n![position_controller_status type](https://user-images.githubusercontent.com/48206725/197734350-158a8591-dcf8-42ae-8ea3-f3d4035fe66e.png)\r\nI've found so far that during the Loiter which goes badly the position_controller_status/type stays at 0 instead of being the usual 2.\r\n\r\n## Drone (please complete the following information):\r\nI haven't dared to check on a real drone yet. The following SITL models have so far found to be affected:\r\n- gazebo_standard_vtol\r\n- gazebo_tailsitter\r\n- gazebo_plane\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20477/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20477/timeline","performed_via_github_app":null,"state_reason":"completed"},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20464","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20464/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20464/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20464/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20464","id":1418482677,"node_id":"PR_kwDOAFDaZs5BS03q","number":20464,"title":"Navigator: fix init of _mission_item, plus add guards for using mision_item.loiter_radius","user":{"login":"sfuhrer","id":26798987,"node_id":"MDQ6VXNlcjI2Nzk4OTg3","avatar_url":"https://avatars.githubusercontent.com/u/26798987?v=4","gravatar_id":"","url":"https://api.github.com/users/sfuhrer","html_url":"https://github.com/sfuhrer","followers_url":"https://api.github.com/users/sfuhrer/followers","following_url":"https://api.github.com/users/sfuhrer/following{/other_user}","gists_url":"https://api.github.com/users/sfuhrer/gists{/gist_id}","starred_url":"https://api.github.com/users/sfuhrer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfuhrer/subscriptions","organizations_url":"https://api.github.com/users/sfuhrer/orgs","repos_url":"https://api.github.com/users/sfuhrer/repos","events_url":"https://api.github.com/users/sfuhrer/events{/privacy}","received_events_url":"https://api.github.com/users/sfuhrer/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2022-10-21T15:06:58Z","updated_at":"2022-10-27T08:28:06Z","closed_at":"2022-10-27T08:28:05Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20464","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20464","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20464.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20464.patch","merged_at":"2022-10-27T08:28:05Z"},"body":"\r\n## Describe problem solved by this pull request\r\nThis is to address what was reported here: https://github.com/PX4/PX4-Autopilot/pull/19928#issuecomment-1277934841\r\n\r\nWhat I think was going on:\r\n- RTL triggered a couple of times, and each time it was above the return altitude, so didn’t have to climb. In the v1.13 RTL logic, as pointed out [here](https://github.com/PX4/PX4-Autopilot/pull/19928#issuecomment-1284454859), the mission_item.loiter_radius field wasn't filled, and it just kept using it as initialized. \r\n- The initialization happens in the constructor, and it initializes it to `_navigator->get_loiter_radius()`, which itself just gets the value of `_param_nav_loiter_rad`. At this moment, the params are though not yet fetched (happens [here](https://github.com/PX4/PX4-Autopilot/blob/c267cf71c3aa57fbbe544d02f3b25650f029384d/src/modules/navigator/navigator_main.cpp#L151))\r\n- in the [flight](https://review.px4.io/plot_app?log=4a466655-3c02-4f78-ab9e-1d90bca4b8e3) linked in the above mentioned issue , the initialisation value of it seems to have been 3.9e32, which was then passed through to the `position_setpoint_current.loiter_radius` (there is only a check for if(>0)), and the vehicle started on it's voyage around the solar system\r\n\r\n\r\n![image](https://user-images.githubusercontent.com/26798987/197223431-d4a5a3c5-33ee-4655-8974-32d73cfc8abb.png)\r\n\r\n\r\n## Describe your solution\r\nOn current main we by accident fixed this particular issue already,[ as we explicitly set the loiter_radius](https://github.com/PX4/PX4-Autopilot/blob/ed558e199faab703ea3fb352db16512981fdb7ec/src/modules/navigator/rtl.cpp#L407) in every state of the RTL state machine. This wasn't the case in v1.13, but I guess we should back port it.\r\nAdditionally we should change the initialization of mission_item. I propose here to initialize to 0, which is considered as \"invalid\" before and not used in then (checks for ISFINITE and >FLT_EPS). \r\nI did the same for mission_item.acceptance_radius. \r\n\r\n## Describe possible alternatives\r\n- do we have a way to update the params before the constructor is called?\r\n- should we initialize `mission_item` fields consistently to NAN instead of some to NAN (currently yaw, lat, lon), and some to 0, and some not at all (e.g. altitude). And is this initialization in the constructor even needed?\r\n\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20464/reactions","total_count":3,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":3,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20464/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20444","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20444/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20444/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20444/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20444","id":1413816395,"node_id":"PR_kwDOAFDaZs5BDCl1","number":20444,"title":"Current message template file does not correctly handle float constant expresssions.","user":{"login":"bl0wfi-sh","id":102852095,"node_id":"U_kgDOBiFl_w","avatar_url":"https://avatars.githubusercontent.com/u/102852095?v=4","gravatar_id":"","url":"https://api.github.com/users/bl0wfi-sh","html_url":"https://github.com/bl0wfi-sh","followers_url":"https://api.github.com/users/bl0wfi-sh/followers","following_url":"https://api.github.com/users/bl0wfi-sh/following{/other_user}","gists_url":"https://api.github.com/users/bl0wfi-sh/gists{/gist_id}","starred_url":"https://api.github.com/users/bl0wfi-sh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bl0wfi-sh/subscriptions","organizations_url":"https://api.github.com/users/bl0wfi-sh/orgs","repos_url":"https://api.github.com/users/bl0wfi-sh/repos","events_url":"https://api.github.com/users/bl0wfi-sh/events{/privacy}","received_events_url":"https://api.github.com/users/bl0wfi-sh/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2022-10-18T20:38:56Z","updated_at":"2022-10-24T09:42:12Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20444","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20444","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20444.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20444.patch","merged_at":null},"body":"Changing msg.h.em template to properly handle const references of type float. Without this float values will be interpreted as int's and loose decimal resolution.\r\n\r\n## Describe problem solved by this pull request\r\nThe current message template interprets all constant reference variables as int's regardless of what type is actually defined in the .msg file.\r\n\r\nExample .msg file showing how a float might be used.\r\n\r\nEx: custom_actuator_test.msg\r\n`float32 CUSTOM_ACTUATOR_MIN = 3.141592653589793238`\r\n\r\nWith the original template file 'msg.h.em' the value of CUSTOM_ACTUATOR_MIN would become 3 instead of the intended value of 3.141592653589793238\r\n\r\n## Describe your solution\r\nTo properly handle floats the 'msg.h.em' file was augmented.\r\n\r\nTo handle the creation of accurate `#define` values the following changes were made at line 85.\r\n`@{\r\nfor constant in spec.constants:\r\n    if \"float\" in constant.type:\r\n        print('#define %s_%s %s'%(spec.short_name.upper(), constant.name, float(constant.val)))\r\n    else:\r\n        print('#define %s_%s %s'%(spec.short_name.upper(), constant.name, int(constant.val)))\r\n}@`\r\n\r\nFinally to handle the accurate creation of `static constexp` variables the following changes were made at line 125.\r\n`    if \"float\" in type_name:\r\n        print('\\tstatic constexpr %s %s = %s;'%(type_px4, constant.name, float(constant.val)))\r\n    else:\r\n        print('\\tstatic constexpr %s %s = %s;'%(type_px4, constant.name, int(constant.val)))`\r\n\r\n## Describe possible alternatives\r\nI do not see any other alternative if someone wants to have a 'const expression' of type float32/64 inside there uORB message, and they don't want to loose decimal accuracy.\r\n\r\n## Test data / coverage\r\nTested on the bench with a custom message and a custom module that prints the const expression value of the message endlessly.\r\n\r\n## Additional context\r\nNA\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20444/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20444/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20443","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20443/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20443/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20443/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20443","id":1413686939,"node_id":"PR_kwDOAFDaZs5BCmwE","number":20443,"title":"Tecs cleanup","user":{"login":"KonradRudin","id":98741601,"node_id":"U_kgDOBeKtYQ","avatar_url":"https://avatars.githubusercontent.com/u/98741601?v=4","gravatar_id":"","url":"https://api.github.com/users/KonradRudin","html_url":"https://github.com/KonradRudin","followers_url":"https://api.github.com/users/KonradRudin/followers","following_url":"https://api.github.com/users/KonradRudin/following{/other_user}","gists_url":"https://api.github.com/users/KonradRudin/gists{/gist_id}","starred_url":"https://api.github.com/users/KonradRudin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/KonradRudin/subscriptions","organizations_url":"https://api.github.com/users/KonradRudin/orgs","repos_url":"https://api.github.com/users/KonradRudin/repos","events_url":"https://api.github.com/users/KonradRudin/events{/privacy}","received_events_url":"https://api.github.com/users/KonradRudin/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":78699916,"node_id":"MDU6TGFiZWw3ODY5OTkxNg==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Fixed%20Wing%20%F0%9F%9B%A9%EF%B8%8F","name":"Fixed Wing 🛩️","color":"009800","default":false,"description":""},{"id":803319897,"node_id":"MDU6TGFiZWw4MDMzMTk4OTc=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/cleanup%20(housekeeping)%20%F0%9F%A7%B9","name":"cleanup (housekeeping) 🧹","color":"aefcbd","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2022-10-18T18:46:40Z","updated_at":"2022-12-21T08:04:21Z","closed_at":"2022-12-21T08:04:20Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20443","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20443","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20443.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20443.patch","merged_at":"2022-12-21T08:04:20Z"},"body":"Please use [PX4 Discuss](http://discuss.px4.io/) or [Slack](http://slack.px4.io/) to align on pull requests if necessary. You can then open draft pull requests to get early feedback.\r\n\r\n## Describe problem solved by this pull request\r\nThis PR is to rearrange the internals of the TECS library for readability and maintenance and corrections of bugs.\r\n\r\n## Describe your solution\r\nThe TECS library is decomposed into three subclasses. A filter class, filtering the airspeed and airspeed derivative, a reference model class for smoothening the altitude setpoint a generate a corresponding altitude rate and the controller responsible for tracking the altitude and altitude rate setpoint.\r\n\r\n## Describe possible alternatives\r\nNone, only refactoring work done.\r\n\r\n## Test data / coverage\r\nFurther testing needed. Testing was done by comparing the output of the rearranged TECS library with the old library as seen in commit [c049d9ae7ad86d9617e0cbe9b902f34b4ad2ee11](https://github.com/PX4/PX4-Autopilot/commit/c049d9ae7ad86d9617e0cbe9b902f34b4ad2ee11). Up to this point, both libraries have a similar behavior but not identical, due to small changes in the initialization (also altitude rate is used to initialize the reference model) and changes in the timing of the modules. Further bug fixes are applied in the commit afterwards.\r\n\r\n## Additional context\r\n![TECS drawio](https://user-images.githubusercontent.com/98741601/196684377-b46f9154-3ac6-40ad-80b4-cb640d558c4c.svg)\r\n\r\nPlease keep in mind that a retuning of the tecs constant is necessary, as the bugfixes in commit https://github.com/PX4/PX4-Autopilot/commit/1018602f83330936445c592dd6f5e3f07399fcc5 has a big influence.\r\n\r\nOctave m-File to check the airspeed filter equation:\r\n[AirspeedSteadyStateKalman.zip](https://github.com/PX4/PX4-Autopilot/files/10068541/AirspeedSteadyStateKalman.zip)\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20443/reactions","total_count":5,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":5,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20443/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20439","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20439/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20439/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20439/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20439","id":1413330500,"node_id":"PR_kwDOAFDaZs5BBbBt","number":20439,"title":"Fix feedforward acceleration setpoints for fixedwing offboard position","user":{"login":"Jaeyoung-Lim","id":5248102,"node_id":"MDQ6VXNlcjUyNDgxMDI=","avatar_url":"https://avatars.githubusercontent.com/u/5248102?v=4","gravatar_id":"","url":"https://api.github.com/users/Jaeyoung-Lim","html_url":"https://github.com/Jaeyoung-Lim","followers_url":"https://api.github.com/users/Jaeyoung-Lim/followers","following_url":"https://api.github.com/users/Jaeyoung-Lim/following{/other_user}","gists_url":"https://api.github.com/users/Jaeyoung-Lim/gists{/gist_id}","starred_url":"https://api.github.com/users/Jaeyoung-Lim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Jaeyoung-Lim/subscriptions","organizations_url":"https://api.github.com/users/Jaeyoung-Lim/orgs","repos_url":"https://api.github.com/users/Jaeyoung-Lim/repos","events_url":"https://api.github.com/users/Jaeyoung-Lim/events{/privacy}","received_events_url":"https://api.github.com/users/Jaeyoung-Lim/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":78699916,"node_id":"MDU6TGFiZWw3ODY5OTkxNg==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Fixed%20Wing%20%F0%9F%9B%A9%EF%B8%8F","name":"Fixed Wing 🛩️","color":"009800","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-10-18T14:28:33Z","updated_at":"2022-10-19T07:15:14Z","closed_at":"2022-10-19T07:15:13Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20439","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20439","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20439.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20439.patch","merged_at":"2022-10-19T07:15:13Z"},"body":"## Describe problem solved by this pull request\r\nOffboard position setpoints (`local_ned_position_target`) allows you to send feedforward acceleration messages. For fixedwing vehicles, this gets translated into curvature (or loiter radius of position_setpoint_triplet)\r\n\r\nPreviously when acceleration feedforward inputs were sent, negative curvature accelerations were always being considered as positive curvature (loiter radius > 0.0). Therefore the tracking performance was bad when the curvature was negative.\r\n\r\n## Describe your solution\r\nThis Fixes the loiter radius computation to also include negative radius\r\n\r\n## Test data / coverage\r\nTested in SITL Gazebo\r\n![196414036-a5f286d1-d93f-4d22-b675-bd4bffe5fa6a](https://user-images.githubusercontent.com/5248102/196459352-285e73f1-203a-4e7c-b111-29bf14aec124.gif)\r\n\r\n\r\n## Additional context\r\n\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20439/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20439/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20438","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20438/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20438/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20438/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20438","id":1413210855,"node_id":"PR_kwDOAFDaZs5BBBcK","number":20438,"title":"ekf2: fix sideslip timeout (typo)","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":666022583,"node_id":"MDU6TGFiZWw2NjYwMjI1ODM=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/EKF2","name":"EKF2","color":"1d76db","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2022-10-18T13:15:25Z","updated_at":"2022-10-18T22:38:27Z","closed_at":"2022-10-18T22:38:26Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20438","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20438","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20438.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20438.patch","merged_at":"2022-10-18T22:38:26Z"},"body":" - regression from https://github.com/PX4/PX4-Autopilot/pull/20364","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20438/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20438/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20374","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20374/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20374/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20374/events","html_url":"https://github.com/PX4/PX4-Autopilot/issues/20374","id":1400567515,"node_id":"I_kwDOAFDaZs5Tevbb","number":20374,"title":"PX4 SITL failing to connect to gazebo for boat model/world","user":{"login":"altmattr","id":1639137,"node_id":"MDQ6VXNlcjE2MzkxMzc=","avatar_url":"https://avatars.githubusercontent.com/u/1639137?v=4","gravatar_id":"","url":"https://api.github.com/users/altmattr","html_url":"https://github.com/altmattr","followers_url":"https://api.github.com/users/altmattr/followers","following_url":"https://api.github.com/users/altmattr/following{/other_user}","gists_url":"https://api.github.com/users/altmattr/gists{/gist_id}","starred_url":"https://api.github.com/users/altmattr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/altmattr/subscriptions","organizations_url":"https://api.github.com/users/altmattr/orgs","repos_url":"https://api.github.com/users/altmattr/repos","events_url":"https://api.github.com/users/altmattr/events{/privacy}","received_events_url":"https://api.github.com/users/altmattr/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":663879765,"node_id":"MDU6TGFiZWw2NjM4Nzk3NjU=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/gazebo%20classic","name":"gazebo classic","color":"EE7F04","default":false,"description":"Gazebo classic simulator"},{"id":4147343828,"node_id":"LA_kwDOAFDaZs73M3HU","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug-report","name":"bug-report","color":"376B2E","default":false,"description":""},{"id":4448141081,"node_id":"LA_kwDOAFDaZs8AAAABCSE_GQ","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Boat%20%F0%9F%9A%A4","name":"Boat 🚤","color":"267EE2","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2022-10-07T03:23:16Z","updated_at":"2022-10-29T20:14:02Z","closed_at":"2022-10-17T04:56:11Z","author_association":"NONE","active_lock_reason":null,"body":"## Describe the bug\r\n`make px4_sitl gazebo` is working for most possible worlds and models that I try.  However, for `make px4_sitl gazebo_boat` it hangs at\r\n\r\n~~~\r\nINFO  [dataman] data manager file './dataman' size is 7866640 bytes\r\nPX4 SIM HOST: localhost\r\nINFO  [simulator_mavlink] Waiting for simulator to accept connection on TCP port 4560\r\n~~~\r\n\r\nI'm running in WSL on windows 10\r\n## To Reproduce\r\nSteps to reproduce the behavior - in WSL command prompt:\r\n1. `> git clone https://github.com/PX4/PX4-Autopilot.git --recursive`\r\n2. `> ./PX4-Autopilot/Tools/setup/ubuntu.sh`\r\n3. `> HEADLESS=1 make px4_sitl gazebo_boat`\r\n4. See error\r\n\r\n## Expected behavior\r\nExpected PX4 SITL start up to continue.\r\n\r\n## Additional context\r\nI've tried verbose logging of gzserver but no clues.  I've tried all other gazebo worlds and models and they all work, including uuv_hippocampus.\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20374/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20374/timeline","performed_via_github_app":null,"state_reason":"completed"},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20372","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20372/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20372/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20372/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20372","id":1400131342,"node_id":"PR_kwDOAFDaZs5AVwrb","number":20372,"title":"sensors: fix accel/gyro/mag calibration offset units","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":306636108,"node_id":"MDU6TGFiZWwzMDY2MzYxMDg=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Documentation%20%F0%9F%93%91","name":"Documentation 📑","color":"fbca04","default":false,"description":"Anything improving the documentation of the code / ecosystem"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-10-06T18:33:24Z","updated_at":"2022-10-09T17:02:39Z","closed_at":"2022-10-09T17:02:38Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20372","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20372","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20372.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20372.patch","merged_at":"2022-10-09T17:02:38Z"},"body":null,"reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20372/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20372/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20363","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20363/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20363/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20363/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20363","id":1397348528,"node_id":"PR_kwDOAFDaZs5AMQyL","number":20363,"title":"Commander: allow disarmin not-landed boat like rover","user":{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false},"assignees":[{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false}],"milestone":null,"comments":0,"created_at":"2022-10-05T07:17:50Z","updated_at":"2022-10-26T11:48:32Z","closed_at":"2022-10-05T13:07:19Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20363","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20363","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20363.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20363.patch","merged_at":"2022-10-05T13:07:19Z"},"body":"## Describe problem solved by this pull request\r\n\r\nReported via Discord by @PierceNichols:\r\n> So, an issue I have been having with my project is that the commander module never shows a boat as landed. Therefore, it refuses to disarm in response to the arming switch mapped from the RC controller and can only be disarmed through QGC. \r\n\r\n> For my own project, I made a one-line change to the is_ground_rover() function in src/modules/commander/commander_helper.cpp so that it returns true for both ground rovers and boats instead of just ground rovers. Would this be an acceptable patch to submit?\r\n\r\nhttps://discordapp.com/channels/1022170275984457759/1026905600241696819/1026966402378248224\r\n\r\n## Describe your solution\r\nI extend this hack to boats: https://github.com/PX4/PX4-Autopilot/commit/98dfa30838f78dfe74f903e26be9e0050578ee4a\r\nWe need to fix land detection and its dependencies for ground vehicles!\r\n\r\n## Describe possible alternatives\r\nThis is a hotfix and a boat should never even detect a takeoff in normal operation.\r\n\r\n## Test data / coverage\r\nUntested. @PierceNichols please test in your use case.","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20363/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20363/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20362","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20362/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20362/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20362/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20362","id":1397274484,"node_id":"PR_kwDOAFDaZs5AMBLC","number":20362,"title":"fix ROMFS: run camera trigger, capture and PPS before pwm_out","user":{"login":"bkueng","id":281593,"node_id":"MDQ6VXNlcjI4MTU5Mw==","avatar_url":"https://avatars.githubusercontent.com/u/281593?v=4","gravatar_id":"","url":"https://api.github.com/users/bkueng","html_url":"https://github.com/bkueng","followers_url":"https://api.github.com/users/bkueng/followers","following_url":"https://api.github.com/users/bkueng/following{/other_user}","gists_url":"https://api.github.com/users/bkueng/gists{/gist_id}","starred_url":"https://api.github.com/users/bkueng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bkueng/subscriptions","organizations_url":"https://api.github.com/users/bkueng/orgs","repos_url":"https://api.github.com/users/bkueng/repos","events_url":"https://api.github.com/users/bkueng/events{/privacy}","received_events_url":"https://api.github.com/users/bkueng/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2022-10-05T05:56:26Z","updated_at":"2022-10-05T16:31:43Z","closed_at":"2022-10-05T13:13:35Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20362","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20362","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20362.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20362.patch","merged_at":"2022-10-05T13:13:35Z"},"body":"As they might need to reserve the pwm pins.","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20362/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20362/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20350","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20350/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20350/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20350/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20350","id":1395571971,"node_id":"PR_kwDOAFDaZs5AGXOK","number":20350,"title":"ms5611: ignore reading 0","user":{"login":"julianoes","id":1419688,"node_id":"MDQ6VXNlcjE0MTk2ODg=","avatar_url":"https://avatars.githubusercontent.com/u/1419688?v=4","gravatar_id":"","url":"https://api.github.com/users/julianoes","html_url":"https://github.com/julianoes","followers_url":"https://api.github.com/users/julianoes/followers","following_url":"https://api.github.com/users/julianoes/following{/other_user}","gists_url":"https://api.github.com/users/julianoes/gists{/gist_id}","starred_url":"https://api.github.com/users/julianoes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/julianoes/subscriptions","organizations_url":"https://api.github.com/users/julianoes/orgs","repos_url":"https://api.github.com/users/julianoes/repos","events_url":"https://api.github.com/users/julianoes/events{/privacy}","received_events_url":"https://api.github.com/users/julianoes/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2022-10-04T02:22:32Z","updated_at":"2022-10-21T14:03:18Z","closed_at":"2022-10-04T13:37:53Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20350","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20350","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20350.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20350.patch","merged_at":"2022-10-04T13:37:53Z"},"body":"This prevents publishing a negative pressure which leads to a NAN altitude estimate further down the line.\r\n\r\nThis was discovered on the Holybro Pixhawk 6C where the ms5611 is connected via I2C, and using the release/1.13 branch.\r\n\r\nI suspect the measuring and collecting is a bit out of whack initially which leads to this from what I can see in the console right after startup:\r\n\r\n```\r\nms5611 #0 on I2C bus 4 (external) address 0x77\r\n486836: measure(), phase: 0\r\nist8310 #0 on I2C bus 4 (external) address 0xC\r\nWARN  [SPI_I2C] ist8310: no instance started (no device on bus?)\r\n507538: collect(), phase: 0\r\nnsh: icm20948_i2c_passthrough: command not found\r\n522745: measure(), phase: 1\r\n546096: collect(), phase: 1\r\nfailed\r\n551336: collect(), phase: 1\r\nfailed\r\n557794: collect(), phase: 1\r\nfailed\r\n565867: collect(), phase: 1\r\nret: 0, P: -94778, raw: 0, _SENS: 1553559751, _OFF: 3105658750\r\n568031: measure(), phase: 2\r\nNAN!=====================================\r\n589313: collect(), phase: 2\r\nret: 0, P: 101241, raw: 8670584, _SENS: 1553559751, _OFF: 3105658750\r\n596646: measure(), phase: 3\r\nINFO  [init] Mixer: /etc/mixers/quad_x.main.mix on /dev/pwm_output0\r\n619024: collect(), phase: 3\r\nret: 0, P: 101243, raw: 8670712, _SENS: 1553559751, _OFF: 3105658750\r\n632461: measure(), phase: 0\r\nINFO  [init] Mixer: /etc/mixers/pass.aux.mix on /dev/pwm_output1\r\n654827: collect(), phase: 0\r\nekf2 [668:237]\r\n661698: measure(), phase: 1\r\n679172: collect(), phase: 1\r\n```\r\n\r\n@vincentpoont2 this should fix the altitude estimation problem that you discovered.\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20350/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20350/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20346","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20346/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20346/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20346/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20346","id":1395032796,"node_id":"PR_kwDOAFDaZs5AEkjF","number":20346,"title":"ControlAllocation: remove actuator trim value from actuator_sp to calculate allocated control","user":{"login":"sfuhrer","id":26798987,"node_id":"MDQ6VXNlcjI2Nzk4OTg3","avatar_url":"https://avatars.githubusercontent.com/u/26798987?v=4","gravatar_id":"","url":"https://api.github.com/users/sfuhrer","html_url":"https://github.com/sfuhrer","followers_url":"https://api.github.com/users/sfuhrer/followers","following_url":"https://api.github.com/users/sfuhrer/following{/other_user}","gists_url":"https://api.github.com/users/sfuhrer/gists{/gist_id}","starred_url":"https://api.github.com/users/sfuhrer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfuhrer/subscriptions","organizations_url":"https://api.github.com/users/sfuhrer/orgs","repos_url":"https://api.github.com/users/sfuhrer/repos","events_url":"https://api.github.com/users/sfuhrer/events{/privacy}","received_events_url":"https://api.github.com/users/sfuhrer/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-10-03T16:48:53Z","updated_at":"2022-10-04T05:51:26Z","closed_at":"2022-10-04T05:51:26Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20346","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20346","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20346.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20346.patch","merged_at":"2022-10-04T05:51:26Z"},"body":"\r\n## Describe problem solved by this pull request\r\nSetting a non-zero control surface trim on vehicles with control allocation leads to non-working Integral part of the PID controller of the FW rate controller.\r\nReason: the fed back \"allocated_torque\" contains the torque generated by the trim as well, which means that \"unallocated torque\" is never 0, which then prevents the I-part from growing (in the corresponding direction, so either + or -).\r\n\r\n![image](https://user-images.githubusercontent.com/26798987/193631320-9486ad08-9a54-4df7-8c2f-9f7f36da3eb0.png)\r\n\r\nOnly happens since https://github.com/PX4/PX4-Autopilot/pull/19912 is in, as from then on we listen to the unallocated torque info for disabling the integrator to avoid integrator windup due to actuator saturation.  \r\n\r\n## Describe your solution\r\nSubtract the trim value from the actuator setpoint to get to the \"net\" actuator setpoint. \r\n\r\n## Describe possible alternatives\r\nCan we move the trim setting from the allocation to the output part? So e.g. for PWM servos add option to set trim PWM? Feels more natural anyway to set it there where you also set the PWM min/max corresponding to the desired min/max deflections. \r\n\r\nMaybe part of a larger discussion, as currently also _control_trim is not used (always 0 because `config.linearization_point` is always 0).\r\n`_actuator_sp = _actuator_trim + _mix * (_control_sp - _control_trim)`\r\n\r\n## Test data / coverage\r\nLight SITL testing with VTOLs and non-zero servo trims. Checked that `control_allocator_status.unallcoated_torque` was 0 when actuators aren't saturated. \r\n\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20346/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20346/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20330","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20330/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20330/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20330/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20330","id":1392110196,"node_id":"PR_kwDOAFDaZs4_69IT","number":20330,"title":"FW Attitdue controller: fix throttle in acro (use _rate_sp.throttle_body)","user":{"login":"sfuhrer","id":26798987,"node_id":"MDQ6VXNlcjI2Nzk4OTg3","avatar_url":"https://avatars.githubusercontent.com/u/26798987?v=4","gravatar_id":"","url":"https://api.github.com/users/sfuhrer","html_url":"https://github.com/sfuhrer","followers_url":"https://api.github.com/users/sfuhrer/followers","following_url":"https://api.github.com/users/sfuhrer/following{/other_user}","gists_url":"https://api.github.com/users/sfuhrer/gists{/gist_id}","starred_url":"https://api.github.com/users/sfuhrer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfuhrer/subscriptions","organizations_url":"https://api.github.com/users/sfuhrer/orgs","repos_url":"https://api.github.com/users/sfuhrer/repos","events_url":"https://api.github.com/users/sfuhrer/events{/privacy}","received_events_url":"https://api.github.com/users/sfuhrer/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":78699916,"node_id":"MDU6TGFiZWw3ODY5OTkxNg==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Fixed%20Wing%20%F0%9F%9B%A9%EF%B8%8F","name":"Fixed Wing 🛩️","color":"009800","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2022-09-30T09:02:41Z","updated_at":"2022-09-30T11:45:21Z","closed_at":"2022-09-30T11:45:20Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20330","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20330","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20330.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20330.patch","merged_at":"2022-09-30T11:45:20Z"},"body":"\r\n## Describe problem solved by this pull request\r\nSomething we didn't consider in https://github.com/PX4/PX4-Autopilot/pull/20080: In Acro the` att_sp.thrust_body `obviously isn't updated, but is still listened to for filling `_actuator_controls` with.\r\n\r\n## Describe your solution\r\nFill `_actuator_controls` always with rate_sp.throttle_body, which in turn is set to` att_sp.thrust_body` if in a mode with an attitude setpoint. \r\n\r\n\r\n## Test data / coverage\r\nSITL tested.\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20330/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20330/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20324","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20324/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20324/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20324/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20324","id":1389916684,"node_id":"PR_kwDOAFDaZs4_ztDb","number":20324,"title":"mc_pos_control: fix trajectory setpoint copy","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":78699954,"node_id":"MDU6TGFiZWw3ODY5OTk1NA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Multirotor%20%F0%9F%9B%B8","name":"Multirotor 🛸","color":"0052cc","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2022-09-28T20:36:10Z","updated_at":"2022-10-17T09:50:43Z","closed_at":"2022-09-29T18:17:00Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20324","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20324","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20324.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20324.patch","merged_at":"2022-09-29T18:17:00Z"},"body":" - trajectory_setpoint and vehicle_local_position_setpoint used to be the same data type\r\n - we got extremely lucky here that this didn't cause any issues due to all the fields still aligning\r\n\r\n\r\n![Screenshot from 2022-09-28 16-35-45](https://user-images.githubusercontent.com/84712/192883613-9e240cfa-c8e7-4bc8-9e59-39916f032560.png)\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20324/reactions","total_count":4,"+1":1,"-1":0,"laugh":3,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20324/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20320","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20320/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20320/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20320/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20320","id":1389771771,"node_id":"PR_kwDOAFDaZs4_zN92","number":20320,"title":"Sanitize welford variance","user":{"login":"tstastny","id":8026163,"node_id":"MDQ6VXNlcjgwMjYxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8026163?v=4","gravatar_id":"","url":"https://api.github.com/users/tstastny","html_url":"https://github.com/tstastny","followers_url":"https://api.github.com/users/tstastny/followers","following_url":"https://api.github.com/users/tstastny/following{/other_user}","gists_url":"https://api.github.com/users/tstastny/gists{/gist_id}","starred_url":"https://api.github.com/users/tstastny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tstastny/subscriptions","organizations_url":"https://api.github.com/users/tstastny/orgs","repos_url":"https://api.github.com/users/tstastny/repos","events_url":"https://api.github.com/users/tstastny/events{/privacy}","received_events_url":"https://api.github.com/users/tstastny/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":{"login":"tstastny","id":8026163,"node_id":"MDQ6VXNlcjgwMjYxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8026163?v=4","gravatar_id":"","url":"https://api.github.com/users/tstastny","html_url":"https://github.com/tstastny","followers_url":"https://api.github.com/users/tstastny/followers","following_url":"https://api.github.com/users/tstastny/following{/other_user}","gists_url":"https://api.github.com/users/tstastny/gists{/gist_id}","starred_url":"https://api.github.com/users/tstastny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tstastny/subscriptions","organizations_url":"https://api.github.com/users/tstastny/orgs","repos_url":"https://api.github.com/users/tstastny/repos","events_url":"https://api.github.com/users/tstastny/events{/privacy}","received_events_url":"https://api.github.com/users/tstastny/received_events","type":"User","site_admin":false},"assignees":[{"login":"tstastny","id":8026163,"node_id":"MDQ6VXNlcjgwMjYxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8026163?v=4","gravatar_id":"","url":"https://api.github.com/users/tstastny","html_url":"https://github.com/tstastny","followers_url":"https://api.github.com/users/tstastny/followers","following_url":"https://api.github.com/users/tstastny/following{/other_user}","gists_url":"https://api.github.com/users/tstastny/gists{/gist_id}","starred_url":"https://api.github.com/users/tstastny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tstastny/subscriptions","organizations_url":"https://api.github.com/users/tstastny/orgs","repos_url":"https://api.github.com/users/tstastny/repos","events_url":"https://api.github.com/users/tstastny/events{/privacy}","received_events_url":"https://api.github.com/users/tstastny/received_events","type":"User","site_admin":false}],"milestone":null,"comments":2,"created_at":"2022-09-28T18:19:40Z","updated_at":"2022-09-29T22:28:14Z","closed_at":"2022-09-29T18:14:17Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20320","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20320","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20320.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20320.patch","merged_at":"2022-09-29T18:14:17Z"},"body":"Needs to go in after #20238\r\n\r\nProblem:\r\nvehicle_imu_status is consumed in the imbalanced propeller check and occasionally the welford variance would output negative due to floating point precision errors (when mean is very low). This then caused a the imbalanced propeller warning to not show up because of NANs in the prop imbalance metric caused by square-rooting the negative variances (to obtain standard deviation).\r\n\r\nSolution:\r\nconvert the welford mean class template to matrix form and sanitize the variance update (the prior necessary for the latter for the max function to be general)\r\n\r\nMore...\r\nNice to do.. but not sure how to do it -- would be to set up an additional unit test for the variance sanitation, but I was unable to reproduce the error offhand (the windowed sum is running at quite high rate, and not all intermediate messages are logged). It was a very rare, but consistent occurrence that the variance turned negative, however.","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20320/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20320/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20318","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20318/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20318/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20318/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20318","id":1389098201,"node_id":"PR_kwDOAFDaZs4_w87I","number":20318,"title":"VTOL: fix transitions in Stabilized","user":{"login":"sfuhrer","id":26798987,"node_id":"MDQ6VXNlcjI2Nzk4OTg3","avatar_url":"https://avatars.githubusercontent.com/u/26798987?v=4","gravatar_id":"","url":"https://api.github.com/users/sfuhrer","html_url":"https://github.com/sfuhrer","followers_url":"https://api.github.com/users/sfuhrer/followers","following_url":"https://api.github.com/users/sfuhrer/following{/other_user}","gists_url":"https://api.github.com/users/sfuhrer/gists{/gist_id}","starred_url":"https://api.github.com/users/sfuhrer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfuhrer/subscriptions","organizations_url":"https://api.github.com/users/sfuhrer/orgs","repos_url":"https://api.github.com/users/sfuhrer/repos","events_url":"https://api.github.com/users/sfuhrer/events{/privacy}","received_events_url":"https://api.github.com/users/sfuhrer/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":249514594,"node_id":"MDU6TGFiZWwyNDk1MTQ1OTQ=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Hybrid%20VTOL%20%F0%9F%9B%A9%EF%B8%8F%F0%9F%9A%81","name":"Hybrid VTOL 🛩️🚁","color":"bfe5bf","default":false,"description":"Multirotor + Fixedwing!"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-09-28T10:13:19Z","updated_at":"2022-09-29T14:01:45Z","closed_at":"2022-09-29T14:01:44Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20318","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20318","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20318.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20318.patch","merged_at":"2022-09-29T14:01:44Z"},"body":"## Describe problem solved by this pull request\r\nVTOL transition broken in Stabilized for Tiltrotor since https://github.com/PX4/PX4-Autopilot/pull/20257. Reason: In Stabilized mode only the FW attitude controller was running during transitions, and thus there was no virtual mc attitude setpoint recently published. \r\n\r\n## Describe your solution\r\n~MC Attitude controller: run and publish if vehicle is a MC or a VTOL in MC mode (which includes transitions). Before it was only run in full MC for Tiltrotor and Standard VTOL. The VTOL module does the selection on which virtual setpoint to use in the end (no changes there).~\r\nEDIT: the above proposed doesn't work because it means that both the mc and fw attitude constantly publish rate setpoints, while it should be always only once of them.\r\nNew proposal pushed: move \"is-recent\" check inside the update_transition_state() implementations for the 3 vtol types, as only there you know exactly which virtual attitude setpoint is used in the end.\r\nNote: I think it does the correct thing also for tailsitter, but transitions in Stabilized mode there are currently broken by other issues as well, see https://github.com/PX4/PX4-Autopilot/issues/20127.\r\n\r\n## Describe possible alternatives\r\nChange the [logic in vtol_att_control_main ](https://github.com/PX4/PX4-Autopilot/blob/70d73c86902276c15c74e4db4bcc83db6e02d057/src/modules/vtol_att_control/vtol_att_control_main.cpp#L339)on when to run the transition logic. \r\n\r\n## Test data / coverage\r\nSITLed on all VTOL types. Along the way I found that the tuning for them all is in a pretty bad state and improved it along the way (enabling airmode and using the tilts for yaw control in hover made a big difference).\r\n\r\n## Additional context\r\nLets get rid of the parallel controller architecture for VTOL asap. Work is currently going on in cleaning up the fw attitude controller, which enables us to merge it with the MC one.\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20318/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20318/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20313","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20313/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20313/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20313/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20313","id":1387852026,"node_id":"PR_kwDOAFDaZs4_sycw","number":20313,"title":"Mag: fix estimated bias save to calibration","user":{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":1442627275,"node_id":"MDU6TGFiZWwxNDQyNjI3Mjc1","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Sensors","name":"Sensors","color":"48c13e","default":false,"description":"All the sensors!"}],"state":"closed","locked":false,"assignee":{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false},"assignees":[{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false}],"milestone":null,"comments":1,"created_at":"2022-09-27T14:20:23Z","updated_at":"2022-09-28T14:04:13Z","closed_at":"2022-09-28T08:43:55Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20313","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20313","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20313.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20313.patch","merged_at":"2022-09-28T08:43:55Z"},"body":"Only clear when it's used, otherwise everything gets cleared after the first outer loop","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20313/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20313/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20310","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20310/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20310/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20310/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20310","id":1387009188,"node_id":"PR_kwDOAFDaZs4_p-Yy","number":20310,"title":"[v1.13] Fix RTK","user":{"login":"julianoes","id":1419688,"node_id":"MDQ6VXNlcjE0MTk2ODg=","avatar_url":"https://avatars.githubusercontent.com/u/1419688?v=4","gravatar_id":"","url":"https://api.github.com/users/julianoes","html_url":"https://github.com/julianoes","followers_url":"https://api.github.com/users/julianoes/followers","following_url":"https://api.github.com/users/julianoes/following{/other_user}","gists_url":"https://api.github.com/users/julianoes/gists{/gist_id}","starred_url":"https://api.github.com/users/julianoes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/julianoes/subscriptions","organizations_url":"https://api.github.com/users/julianoes/orgs","repos_url":"https://api.github.com/users/julianoes/repos","events_url":"https://api.github.com/users/julianoes/events{/privacy}","received_events_url":"https://api.github.com/users/julianoes/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2022-09-27T03:11:31Z","updated_at":"2022-09-28T02:01:49Z","closed_at":"2022-09-28T02:01:49Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20310","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20310","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20310.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20310.patch","merged_at":"2022-09-28T02:01:49Z"},"body":"Before this fix, this function would stall and somehow never return.\r\n\r\nThis makes RTK data sent from QGC work on top of v1.13 for me.","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20310/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20310/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20300","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20300/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20300/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20300/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20300","id":1384788233,"node_id":"PR_kwDOAFDaZs4_i-D-","number":20300,"title":"CRSF: Validate unknown packet sizes to be smaller than max packet size","user":{"login":"chris1seto","id":584080,"node_id":"MDQ6VXNlcjU4NDA4MA==","avatar_url":"https://avatars.githubusercontent.com/u/584080?v=4","gravatar_id":"","url":"https://api.github.com/users/chris1seto","html_url":"https://github.com/chris1seto","followers_url":"https://api.github.com/users/chris1seto/followers","following_url":"https://api.github.com/users/chris1seto/following{/other_user}","gists_url":"https://api.github.com/users/chris1seto/gists{/gist_id}","starred_url":"https://api.github.com/users/chris1seto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chris1seto/subscriptions","organizations_url":"https://api.github.com/users/chris1seto/orgs","repos_url":"https://api.github.com/users/chris1seto/repos","events_url":"https://api.github.com/users/chris1seto/events{/privacy}","received_events_url":"https://api.github.com/users/chris1seto/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-09-24T19:27:34Z","updated_at":"2022-09-24T20:36:17Z","closed_at":"2022-09-24T20:36:17Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20300","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20300","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20300.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20300.patch","merged_at":"2022-09-24T20:36:17Z"},"body":"An issue existed in the CSRF driver, where invalid serial data could result in the parser attempting to parse a packet of unknown type, with a length which is larger than the circular buffer itself. This would mean the parser would be stalled waiting for a packet larger than could ever be encountered. This PR fixes this bug to cap the possible unknown packet type size to the maximum size of a CRSF packet.","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20300/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20300/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20299","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20299/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20299/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20299/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20299","id":1384756842,"node_id":"PR_kwDOAFDaZs4_i4gF","number":20299,"title":"uORB: fix static orb_exists call for protected build","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2022-09-24T17:38:42Z","updated_at":"2022-09-26T16:38:59Z","closed_at":"2022-09-26T16:38:58Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20299","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20299","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20299.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20299.patch","merged_at":"2022-09-26T16:38:58Z"},"body":"In the recently merged initial VOXL2 support (https://github.com/PX4/PX4-Autopilot/pull/20274) `uORB::Manager::orb_exists()` needed to non-static so that it can check the remote subscribers. This broke the px4_fmu-v5_protected build which has a static orb_ioctl() method kernel side (https://github.com/PX4/PX4-Autopilot/commit/0b9505453d03cb586c2d6e8a927e0b5b5e1761b3).\r\n\r\nThis PR keeps orb_exists() non-static for VOXL2, but updates orb_ioctl() to call orb_exists() on the uORB::Manager instance (if available). I also updated ORBSet so it's used everywhere, rather than just being a typedef for std::string on Linux. We may want to optimize it later, but for now I think it would be better to keep it together.","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20299/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20299/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20286","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20286/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20286/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20286/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20286","id":1382564924,"node_id":"PR_kwDOAFDaZs4_b3Lm","number":20286,"title":"FW Attitude Controller: fix polling of rate setpoint for tailsitter","user":{"login":"sfuhrer","id":26798987,"node_id":"MDQ6VXNlcjI2Nzk4OTg3","avatar_url":"https://avatars.githubusercontent.com/u/26798987?v=4","gravatar_id":"","url":"https://api.github.com/users/sfuhrer","html_url":"https://github.com/sfuhrer","followers_url":"https://api.github.com/users/sfuhrer/followers","following_url":"https://api.github.com/users/sfuhrer/following{/other_user}","gists_url":"https://api.github.com/users/sfuhrer/gists{/gist_id}","starred_url":"https://api.github.com/users/sfuhrer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfuhrer/subscriptions","organizations_url":"https://api.github.com/users/sfuhrer/orgs","repos_url":"https://api.github.com/users/sfuhrer/repos","events_url":"https://api.github.com/users/sfuhrer/events{/privacy}","received_events_url":"https://api.github.com/users/sfuhrer/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":249514594,"node_id":"MDU6TGFiZWwyNDk1MTQ1OTQ=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Hybrid%20VTOL%20%F0%9F%9B%A9%EF%B8%8F%F0%9F%9A%81","name":"Hybrid VTOL 🛩️🚁","color":"bfe5bf","default":false,"description":"Multirotor + Fixedwing!"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2022-09-22T14:37:27Z","updated_at":"2022-09-22T17:13:38Z","closed_at":"2022-09-22T17:13:37Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20286","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20286","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20286.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20286.patch","merged_at":"2022-09-22T17:13:37Z"},"body":"vehicle_rates_setpoint_poll() rotated the rate setpoint for tailsitters from hover to fixes-wing orientation. That is though not correct, as the actual rate estimates get rotated and thus the setpoints shouldn't be touched.\r\n\r\nFixes https://github.com/PX4/PX4-Autopilot/issues/20279\r\n\r\nIssue arose with https://github.com/PX4/PX4-Autopilot/pull/20080. Acro was though also broken before it seems, as that one used vehicle_rates_setpoint_poll() already.","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20286/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20286/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20282","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20282/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20282/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20282/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20282","id":1381721426,"node_id":"PR_kwDOAFDaZs4_ZHbI","number":20282,"title":"platforms/posix: restore none SITL helper target for replay","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-09-22T02:12:44Z","updated_at":"2022-09-23T23:20:02Z","closed_at":"2022-09-23T23:20:01Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20282","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20282","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20282.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20282.patch","merged_at":"2022-09-23T23:20:01Z"},"body":" - possible fix for https://github.com/PX4/PX4-Autopilot/issues/20229","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20282/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20282/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20270","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20270/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20270/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20270/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20270","id":1380814485,"node_id":"PR_kwDOAFDaZs4_WG1G","number":20270,"title":"Payload Deliverer bug fix + status output improvements","user":{"login":"junwoo091400","id":23277211,"node_id":"MDQ6VXNlcjIzMjc3MjEx","avatar_url":"https://avatars.githubusercontent.com/u/23277211?v=4","gravatar_id":"","url":"https://api.github.com/users/junwoo091400","html_url":"https://github.com/junwoo091400","followers_url":"https://api.github.com/users/junwoo091400/followers","following_url":"https://api.github.com/users/junwoo091400/following{/other_user}","gists_url":"https://api.github.com/users/junwoo091400/gists{/gist_id}","starred_url":"https://api.github.com/users/junwoo091400/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/junwoo091400/subscriptions","organizations_url":"https://api.github.com/users/junwoo091400/orgs","repos_url":"https://api.github.com/users/junwoo091400/repos","events_url":"https://api.github.com/users/junwoo091400/events{/privacy}","received_events_url":"https://api.github.com/users/junwoo091400/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2022-09-21T12:00:50Z","updated_at":"2022-09-23T05:41:51Z","closed_at":"2022-09-23T05:41:51Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20270","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20270","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20270.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20270.patch","merged_at":"2022-09-23T05:41:51Z"},"body":"## Describe problem solved by this pull request\r\n![PayloadDelivererSpammingOutput](https://user-images.githubusercontent.com/23277211/191497802-a9bb8654-4c58-449e-a465-996c61480468.PNG)\r\n\r\n**Bug**: When the payload_deliverer's gripper wasn't configured correctly, the error message was spammed to the user for *any vehicle command received.\r\n\r\n**Room for Improvement**: Also, it was hard to check what the status of the payload_deliverer module was (especially the gripper instance)\r\n\r\n## Describe your solution\r\n1. First commit splits out the gripper state update function and only prints out info message when we did indeed receive the `DO_GRIPPER` vehicle command\r\n2. Second commit adds a status output function to show gripper state\r\n\r\n## Test data / coverage\r\n![PayloadDelivererImprovedStatus](https://user-images.githubusercontent.com/23277211/191497852-249432d4-5caf-43d8-a771-96fea3ad513c.PNG)\r\n\r\nHere, with the changes in this PR, the spamming doesn't occur anymore unless an actual DO_GRIPPER command is received, and the status output through the px4 shell gives a verbose status of the gripper, which is very useful for the operator!","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20270/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20270/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20260","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20260/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20260/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20260/events","html_url":"https://github.com/PX4/PX4-Autopilot/issues/20260","id":1379708528,"node_id":"I_kwDOAFDaZs5SPK5w","number":20260,"title":"Fixedwing RTL failsafe makes the vehicle crash right after takeoff","user":{"login":"Jaeyoung-Lim","id":5248102,"node_id":"MDQ6VXNlcjUyNDgxMDI=","avatar_url":"https://avatars.githubusercontent.com/u/5248102?v=4","gravatar_id":"","url":"https://api.github.com/users/Jaeyoung-Lim","html_url":"https://github.com/Jaeyoung-Lim","followers_url":"https://api.github.com/users/Jaeyoung-Lim/followers","following_url":"https://api.github.com/users/Jaeyoung-Lim/following{/other_user}","gists_url":"https://api.github.com/users/Jaeyoung-Lim/gists{/gist_id}","starred_url":"https://api.github.com/users/Jaeyoung-Lim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Jaeyoung-Lim/subscriptions","organizations_url":"https://api.github.com/users/Jaeyoung-Lim/orgs","repos_url":"https://api.github.com/users/Jaeyoung-Lim/repos","events_url":"https://api.github.com/users/Jaeyoung-Lim/events{/privacy}","received_events_url":"https://api.github.com/users/Jaeyoung-Lim/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":78699916,"node_id":"MDU6TGFiZWw3ODY5OTkxNg==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Fixed%20Wing%20%F0%9F%9B%A9%EF%B8%8F","name":"Fixed Wing 🛩️","color":"009800","default":false,"description":""},{"id":4147343828,"node_id":"LA_kwDOAFDaZs73M3HU","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug-report","name":"bug-report","color":"376B2E","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2022-09-20T16:44:58Z","updated_at":"2022-10-25T11:55:11Z","closed_at":"2022-10-25T11:55:11Z","author_association":"MEMBER","active_lock_reason":null,"body":"## Describe the bug\r\nWhen running takeoff in SITL without QGC running, the plane immediately goes into failsafe, goes into RTL and then crases\r\n\r\n## To Reproduce\r\nSteps to reproduce the behavior: (Make sure no QGC is running)\r\n1. Start plane SITL simulation\r\n```\r\nmake px4_sitl gazebo_plane\r\n```\r\n2. Command takeoff\r\n```\r\ncommander takeoff\r\n```\r\n\r\n## Expected behavior\r\n- Vehicle should either takes off or rejects the takeoff command\r\n\r\n## Log Files and Screenshots\r\n![plane_bug](https://user-images.githubusercontent.com/5248102/191316218-3a925953-5b73-4fca-82e9-a51dd60b0ded.gif)\r\n- Flight log: https://review.px4.io/plot_app?log=0314e693-cb1e-4675-a7ef-bad36473a129\r\n- Log:\r\n```\r\npxh> commander takeoff\r\npxh> INFO  [commander] Armed by internal command\t\r\nINFO  [tone_alarm] arming warning\r\nINFO  [navigator] Using minimum takeoff altitude: 30.00 m\t\r\nINFO  [fw_pos_control_l1] Takeoff on runway\t\r\nINFO  [commander] Takeoff detected\t\r\nWARN  [commander] Failsafe enabled: no datalink\t\r\nINFO  [commander] Failsafe mode activated\t\r\nINFO  [tone_alarm] battery warning (fast)\r\nINFO  [navigator] RTL: landing at home position.\t\r\nINFO  [navigator] RTL: climb to 589 m (100 m above destination)\t\r\nINFO  [commander] Failsafe mode deactivated\t\r\nWARN  [health_and_arming_checks] Preflight Fail: velocity estimate error\r\nERROR [commander] Critical failure detected: lockdown\t\r\nWARN  [commander] Motor failure detected\t\r\nWARN  [health_and_arming_checks] Preflight Fail: velocity estimate error\r\n```\r\n\r\n## Additional context\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20260/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20260/timeline","performed_via_github_app":null,"state_reason":"completed"},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20258","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20258/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20258/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20258/events","html_url":"https://github.com/PX4/PX4-Autopilot/issues/20258","id":1379339287,"node_id":"I_kwDOAFDaZs5SNwwX","number":20258,"title":"Set default PWM to 50Hz","user":{"login":"jstrebel","id":2244311,"node_id":"MDQ6VXNlcjIyNDQzMTE=","avatar_url":"https://avatars.githubusercontent.com/u/2244311?v=4","gravatar_id":"","url":"https://api.github.com/users/jstrebel","html_url":"https://github.com/jstrebel","followers_url":"https://api.github.com/users/jstrebel/followers","following_url":"https://api.github.com/users/jstrebel/following{/other_user}","gists_url":"https://api.github.com/users/jstrebel/gists{/gist_id}","starred_url":"https://api.github.com/users/jstrebel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jstrebel/subscriptions","organizations_url":"https://api.github.com/users/jstrebel/orgs","repos_url":"https://api.github.com/users/jstrebel/repos","events_url":"https://api.github.com/users/jstrebel/events{/privacy}","received_events_url":"https://api.github.com/users/jstrebel/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2022-09-20T12:27:48Z","updated_at":"2022-10-12T07:33:05Z","closed_at":"2022-10-12T07:33:04Z","author_association":"NONE","active_lock_reason":null,"body":"Please set the default PWM frequency to 50Hz. \r\nAnalog Servos get \"overloaded\" and burn. I refer to Issue #19866\r\nJust tested, fired up 1.13.beta (current main)","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20258/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20258/timeline","performed_via_github_app":null,"state_reason":"completed"},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20248","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20248/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20248/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20248/events","html_url":"https://github.com/PX4/PX4-Autopilot/issues/20248","id":1378040304,"node_id":"I_kwDOAFDaZs5SIznw","number":20248,"title":"Supress disarm in manual mode (only for Fixed Wing)","user":{"login":"jstrebel","id":2244311,"node_id":"MDQ6VXNlcjIyNDQzMTE=","avatar_url":"https://avatars.githubusercontent.com/u/2244311?v=4","gravatar_id":"","url":"https://api.github.com/users/jstrebel","html_url":"https://github.com/jstrebel","followers_url":"https://api.github.com/users/jstrebel/followers","following_url":"https://api.github.com/users/jstrebel/following{/other_user}","gists_url":"https://api.github.com/users/jstrebel/gists{/gist_id}","starred_url":"https://api.github.com/users/jstrebel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jstrebel/subscriptions","organizations_url":"https://api.github.com/users/jstrebel/orgs","repos_url":"https://api.github.com/users/jstrebel/repos","events_url":"https://api.github.com/users/jstrebel/events{/privacy}","received_events_url":"https://api.github.com/users/jstrebel/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":174161208,"node_id":"MDU6TGFiZWwxNzQxNjEyMDg=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/priority-critical","name":"priority-critical","color":"e11d21","default":false,"description":null}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":11,"created_at":"2022-09-19T14:20:09Z","updated_at":"2022-10-25T16:02:08Z","closed_at":null,"author_association":"NONE","active_lock_reason":null,"body":"**Describe the enhancement:**\r\nTo test the flight behavior of new fixed wing UAVs it may be necessary to perform flight maneuvers in manual mode that result in a \"disarm\" in the current XP4 software. This type of flight movement may be required to put the FW into critical flight conditions to determine how the aircraft is behaving.\r\nCurrently, remote control is no longer possible, it results in a crash.\r\n\r\n**To Reproduce:**\r\nPut the FW upside down (180° Roll). FW in going to disarm.\r\n \r\n**Expected behavior**\r\nInsert an optional parameter so that disarm can be suppressed. ","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20248/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20248/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20224","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20224/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20224/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20224/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20224","id":1374672134,"node_id":"PR_kwDOAFDaZs4_CInb","number":20224,"title":"ekf2: inhibit accel bias dynamically when fake position/height fusion active","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":666022583,"node_id":"MDU6TGFiZWw2NjYwMjI1ODM=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/EKF2","name":"EKF2","color":"1d76db","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2022-09-15T15:00:23Z","updated_at":"2022-09-23T00:32:21Z","closed_at":"2022-09-23T00:32:20Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20224","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20224","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20224.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20224.patch","merged_at":"2022-09-23T00:32:20Z"},"body":" - inhibit accel bias learning dynamically depending on the angle between an accelerometer and the vertical axis when fake position fusion is active\r\n - this is intended to fix a problem with accel bias learning when you have no valid position source and the vehicle is in a sustained pitch forward\r\n\r\n![inhibit_accel_bias_dynamically](https://user-images.githubusercontent.com/84712/190656897-7a11c66b-1c17-4c2a-870a-7a8632e13789.png)\r\n\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20224/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20224/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20223","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20223/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20223/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20223/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20223","id":1374671121,"node_id":"PR_kwDOAFDaZs4_CIZm","number":20223,"title":"ekf2: inhibit accel bias learning when fusing synthetic position (and not at rest)","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":666022583,"node_id":"MDU6TGFiZWw2NjYwMjI1ODM=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/EKF2","name":"EKF2","color":"1d76db","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-09-15T14:59:38Z","updated_at":"2022-09-15T14:59:57Z","closed_at":"2022-09-15T14:59:55Z","author_association":"MEMBER","active_lock_reason":null,"draft":true,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20223","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20223","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20223.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20223.patch","merged_at":null},"body":null,"reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20223/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20223/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20220","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20220/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20220/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20220/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20220","id":1374184390,"node_id":"PR_kwDOAFDaZs4_AfEA","number":20220,"title":"standard: fixed pusher assist in hover","user":{"login":"sfuhrer","id":26798987,"node_id":"MDQ6VXNlcjI2Nzk4OTg3","avatar_url":"https://avatars.githubusercontent.com/u/26798987?v=4","gravatar_id":"","url":"https://api.github.com/users/sfuhrer","html_url":"https://github.com/sfuhrer","followers_url":"https://api.github.com/users/sfuhrer/followers","following_url":"https://api.github.com/users/sfuhrer/following{/other_user}","gists_url":"https://api.github.com/users/sfuhrer/gists{/gist_id}","starred_url":"https://api.github.com/users/sfuhrer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfuhrer/subscriptions","organizations_url":"https://api.github.com/users/sfuhrer/orgs","repos_url":"https://api.github.com/users/sfuhrer/repos","events_url":"https://api.github.com/users/sfuhrer/events{/privacy}","received_events_url":"https://api.github.com/users/sfuhrer/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":249514594,"node_id":"MDU6TGFiZWwyNDk1MTQ1OTQ=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Hybrid%20VTOL%20%F0%9F%9B%A9%EF%B8%8F%F0%9F%9A%81","name":"Hybrid VTOL 🛩️🚁","color":"bfe5bf","default":false,"description":"Multirotor + Fixedwing!"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-09-15T09:02:12Z","updated_at":"2022-09-15T17:07:28Z","closed_at":"2022-09-15T17:07:27Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20220","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20220","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20220.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20220.patch","merged_at":"2022-09-15T17:07:27Z"},"body":"Port of https://github.com/PX4/PX4-Autopilot/pull/19865 to v1.13\r\n\r\nGot noticed about it being broken on 1.13 through https://discuss.px4.io/t/pusher-throttle-pulsing-with-vt-fwd-thrust-en/28994\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20220/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20220/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20218","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20218/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20218/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20218/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20218","id":1373693598,"node_id":"PR_kwDOAFDaZs4--3iU","number":20218,"title":"drivers/rc_input: don't allow starting on the px4io serial port","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2022-09-14T23:23:45Z","updated_at":"2022-09-15T01:24:11Z","closed_at":"2022-09-15T01:23:30Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20218","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20218","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20218.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20218.patch","merged_at":"2022-09-15T01:23:30Z"},"body":"Broken during the old mixer purge.\r\n\r\nPreviously we skipped starting `rc_input` entirely if the IO was present, but this isn't ideal because there are real cases where people want to use newer RC protocols like CRSF that are only supported FMU side.\r\n\r\n<img width=\"501\" alt=\"Screen Shot 2022-09-14 at 7 23 59 PM\" src=\"https://user-images.githubusercontent.com/84712/190279896-356cd3ba-0e6b-4eb0-899c-83d6400be2df.png\">\r\n\r\nFixes https://github.com/PX4/PX4-Autopilot/issues/20211.\r\n\r\nTo be clear, I don't particularly like this solution, and we'll likely come back to soon with a better mechanism to make RC completely user facing configurable (at least FMU side). The potential problem is how that intersects with the board manifest and serial port configuration. \r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20218/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20218/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20213","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20213/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20213/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20213/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20213","id":1372926815,"node_id":"PR_kwDOAFDaZs4-8S4r","number":20213,"title":"Board UUID format function wrong memory access bug fix","user":{"login":"junwoo091400","id":23277211,"node_id":"MDQ6VXNlcjIzMjc3MjEx","avatar_url":"https://avatars.githubusercontent.com/u/23277211?v=4","gravatar_id":"","url":"https://api.github.com/users/junwoo091400","html_url":"https://github.com/junwoo091400","followers_url":"https://api.github.com/users/junwoo091400/followers","following_url":"https://api.github.com/users/junwoo091400/following{/other_user}","gists_url":"https://api.github.com/users/junwoo091400/gists{/gist_id}","starred_url":"https://api.github.com/users/junwoo091400/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/junwoo091400/subscriptions","organizations_url":"https://api.github.com/users/junwoo091400/orgs","repos_url":"https://api.github.com/users/junwoo091400/repos","events_url":"https://api.github.com/users/junwoo091400/events{/privacy}","received_events_url":"https://api.github.com/users/junwoo091400/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2022-09-14T12:44:26Z","updated_at":"2022-09-15T17:06:16Z","closed_at":"2022-09-15T17:06:15Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20213","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20213","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20213.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20213.patch","merged_at":"2022-09-15T17:06:15Z"},"body":"## How it was discovered\r\nFrom #20036, it utilizes the `board_get_px4_guid_formated` function for filling in `uas_id` for OPEN DRONE ID MAVLink message, like [here](https://github.com/PX4/PX4-Autopilot/pull/20036/files#diff-9df698b07008acc1a7b23a558fb96d819a88ac3e378bf34602fe5f23a3efe809R163).\r\n\r\nThis led to the ['Standard VTOL w/ build type AddressSanitizer'](https://github.com/PX4/PX4-Autopilot/blob/main/.github/workflows/sitl_tests.yml#L19) SITL test to fail with Stack Buffer Overflow, as shown below in 'Cause' section.\r\n\r\nYou can reproduce this bug via:\r\n1. Checkout your branch to the one in #20036 \r\n2. Build SITL with AddressSanitizer enabled: `PX4_ASAN=1 make px4_sitl gazebo HEADLESS=1`\r\n3. The stack overflow error will occur shortly after the SITL starts\r\n\r\n### Cause\r\n`board_get_uuid32_formated` function didn't respect the `size` argument, and called `snprintf` function at the offset bigger than the `size`, which triggered the wrong memory access error.\r\n\r\n![SanitizerOutput](https://user-images.githubusercontent.com/23277211/188935923-94764587-a6f1-4947-a3a4-1010b48f2b46.PNG)\r\n\r\n### Reason\r\nAlthough this function is depreciated and rarely used, it does get called when the board target has \"BOARD_OVERRIDE_UUID\" defined in it's `board_config.h`, and the `board_get_px4_guid_formated` gets called.\r\n\r\n![Board_UUID_MemoryWrongAccess_DebugResult](https://user-images.githubusercontent.com/23277211/188935950-486ec0d9-2ec6-45d9-85d2-46d4d685e934.PNG)\r\n\r\nFor SITL few other targets listed below, this was the case, and we then don't stick to the generic global PX4 GUID format (which can be retrieved by the same function `board_get_px4_guid_formated`, but it sticks to the 18 bytes length specification), but rather uses the cascaded function structure that triggers the ill-coded `board_get_uuid32_formated`, located inside `platforms/common/board_identity.c`.\r\n\r\n### Affected Targets\r\nAny targets with `BOARD_OVERRIDE_UUID` defined are affected by this bug. Calling any of the board identity ID formatter function on any of these targets would have caused the buffer overflow. \r\n- Beaglebone Blue\r\n- Emlid Navio 2\r\n- Raspbery Pi\r\n- Scumaker Pilotpi\r\n\r\n## Describe your solution\r\n1. Added index sanity checks to make sure we don't go over the buffer's size\r\n4. Added unit test to detect buffer overflow & correct formatting for size-constrained buffers\r\n\r\n## Test data / coverage\r\nUnit test is added in the PR\r\n\r\n## Additional context\r\nIt would be nice to have the stack smashing error being reported as \"Buffer overflow\" error in the unit test itself (currently the test just aborts, as the error is coming from lower level than the testing framework. Any ideas on this? @dagar \r\n\r\nThis should go in to `main` before #20036, to prevent the CI failure mentioned in the beginning.","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20213/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20213/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20209","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20209/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20209/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20209/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20209","id":1372651390,"node_id":"PR_kwDOAFDaZs4-7XI_","number":20209,"title":"ekf2: vertical position/velocity validity checks","user":{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false},"assignees":[{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false}],"milestone":null,"comments":0,"created_at":"2022-09-14T09:24:22Z","updated_at":"2022-09-29T18:16:38Z","closed_at":"2022-09-29T18:16:37Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20209","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20209","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20209.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20209.patch","merged_at":"2022-09-29T18:16:37Z"},"body":"## Describe problem solved by this pull request\r\nVertical validity (`z_valid` and `v_z_valid`) are set by the ekf2 preflight checker and land detector (`landed` flag). This creates a circular dependency between ekf2 module and land detector that can cause race conditions. Furthermore, the estimate validity is known by the estimator and those fields should be used for that instead of preflight checking.\r\n\r\n## Describe your solution\r\n- add vertical position and velocity validity checks based on an inertial dead-reckoning maximum time\r\n\r\nAdditional change:\r\n- start fake position/height aiding only after dead-reckoning times-out in order to get a couple of seconds of pure inertial dead-reckoning before giving up completely on navigation.","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20209/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20209/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20193","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20193/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20193/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20193/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20193","id":1368972770,"node_id":"PR_kwDOAFDaZs4-vEM2","number":20193,"title":"logger: delay topic initialization until logging is actually starting","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":10884840,"node_id":"MDU6TGFiZWwxMDg4NDg0MA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/enhancement%20(improvement)%20%F0%9F%92%A1","name":"enhancement (improvement) 💡","color":"84b6eb","default":false,"description":""},{"id":1464915523,"node_id":"MDU6TGFiZWwxNDY0OTE1NTIz","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Logger","name":"Logger","color":"12b76f","default":false,"description":"ULog Logger"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2022-09-11T15:01:53Z","updated_at":"2022-09-30T07:15:27Z","closed_at":null,"author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20193","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20193","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20193.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20193.patch","merged_at":null},"body":" - this is a fix for logger missing things like UAVCAN sensors\r\n\r\n\r\nThreading in logger needs a careful review.\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20193/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20193/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20189","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20189/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20189/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20189/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20189","id":1368710460,"node_id":"PR_kwDOAFDaZs4-uQ_N","number":20189,"title":"cmake/metadata.cmake: metadata_extract_events limit to PX4_SRC_FILES","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2022-09-10T19:23:56Z","updated_at":"2022-09-22T13:42:53Z","closed_at":"2022-09-22T13:42:49Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20189","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20189","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20189.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20189.patch","merged_at":null},"body":" - otherwise metadata_extract_events fails on events in functional tests (px4_add_functional_gtest)\r\n\r\n``` Console\r\n\r\n$ make extract_events \r\n[0/2] Extracting events from full source\r\nException while parsing file /home/dagar/git/PX4-Autopilot/src/modules/commander/HealthAndArmingChecks/HealthAndArmingChecksTest.cpp\r\nException in file /home/dagar/git/PX4-Autopilot/src/modules/commander/HealthAndArmingChecks/HealthAndArmingChecksTest.cpp\r\nTraceback (most recent call last):\r\n  File \"/home/dagar/git/PX4-Autopilot/Tools/px_process_events.py\", line 102, in <module>\r\n    main()\r\n  File \"/home/dagar/git/PX4-Autopilot/Tools/px_process_events.py\", line 89, in main\r\n    if not scanner.ScanDir(src_paths, parser):\r\n  File \"/home/dagar/git/PX4-Autopilot/Tools/px4events/srcscanner.py\", line 28, in ScanDir\r\n    if not self.ScanFile(path, parser):\r\n  File \"/home/dagar/git/PX4-Autopilot/Tools/px4events/srcscanner.py\", line 49, in ScanFile\r\n    return parser.Parse(contents)\r\n  File \"/home/dagar/git/PX4-Autopilot/Tools/px4events/srcparser.py\", line 170, in Parse\r\n    assert 'events::ID(' not in line or line.startswith('//'), \\\r\nAssertionError: unmatched 'events::ID(' found in line 'events::ID(\"arming_test_basic_fail_all_modes_fail1\"), events::Log::Info, \"\");'\r\n[0/2] Generating git version header\r\nFAILED: CMakeFiles/metadata_extract_events /home/dagar/git/PX4-Autopilot/build/px4_sitl_default/CMakeFiles/metadata_extract_events \r\ncd /home/dagar/git/PX4-Autopilot/build/px4_sitl_default && /home/dagar/.local/lib/python3.8/site-packages/cmake/data/bin/cmake -E make_directory /home/dagar/git/PX4-Autopilot/build/px4_sitl_default/events && /usr/bin/python3 /home/dagar/git/PX4-Autopilot/Tools/px_process_events.py --src-path /home/dagar/git/PX4-Autopilot/src --json /home/dagar/git/PX4-Autopilot/build/px4_sitl_default/events/px4_full.json && /usr/bin/python3 /home/dagar/git/PX4-Autopilot/src/lib/events/libevents/scripts/combine.py /home/dagar/git/PX4-Autopilot/build/px4_sitl_default/events/px4_full.json /home/dagar/git/PX4-Autopilot/src/lib/events/libevents/events/common.json /home/dagar/git/PX4-Autopilot/src/lib/events/enums.json --output /home/dagar/git/PX4-Autopilot/build/px4_sitl_default/events/all_events_full.json && /usr/bin/python3 /home/dagar/git/PX4-Autopilot/src/lib/events/libevents/scripts/validate.py /home/dagar/git/PX4-Autopilot/build/px4_sitl_default/events/all_events_full.json && /usr/bin/python3 /home/dagar/git/PX4-Autopilot/Tools/compress.py /home/dagar/git/PX4-Autopilot/build/px4_sitl_default/events/all_events_full.json\r\n[2/2] Generating git version header\r\nninja: build stopped: subcommand failed.\r\nmake[1]: *** [Makefile:232: px4_sitl_default] Error 1\r\nmake: *** [Makefile:360: extract_events] Error 2\r\n```\r\n\r\nIs this the correct fix or do we want to include HealthAndArmingChecksTest events (eg events::ID(\"arming_test_basic_fail_all_modes_fail1\")) in `make extract_events`?","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20189/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20189/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20171","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20171/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20171/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20171/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20171","id":1363125343,"node_id":"PR_kwDOAFDaZs4-bnBs","number":20171,"title":"VTOL takeoff problem hotfix","user":{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":249514594,"node_id":"MDU6TGFiZWwyNDk1MTQ1OTQ=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Hybrid%20VTOL%20%F0%9F%9B%A9%EF%B8%8F%F0%9F%9A%81","name":"Hybrid VTOL 🛩️🚁","color":"bfe5bf","default":false,"description":"Multirotor + Fixedwing!"}],"state":"closed","locked":false,"assignee":{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false},"assignees":[{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false}],"milestone":null,"comments":6,"created_at":"2022-09-06T11:17:49Z","updated_at":"2022-11-08T11:27:26Z","closed_at":"2022-09-08T12:49:32Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20171","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20171","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20171.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20171.patch","merged_at":"2022-09-08T12:49:32Z"},"body":"## Describe the problem solved by this pull request\r\nVTOL takeoff depending on how the vehicle was landed before would not work properly. The tricky part is that even though the issue showed up pretty often after an update on one of our models used in its typical workflow I was never able to reproduce the root cause SITL. Also, the Symptom is flaky but most of the time it would not take off at all, get stuck during the initial ascent or even descend again somewhere in the middle of the ascent.\r\n\r\n## Describe your solution\r\nI was able to find the combination of all the in-between problems and two of them I'm fixing in this pr. That doesn't give us a guarantee for any related problem ever occurring again but I'm fairly confident it increases robustness.\r\n\r\n### What I cannot explain:\r\n- The global field `_mission_item.acceptance_radius` in navigator in some way got a value close to zero but just not zero e.g. 3e-38 after a certain mission flight/landing procedure (not directly after boot). My best guess is that the field gets reinitialized with zero in some place in navigator and for float arithmetics reason on the MCU this is interpreted as not exactly zero. I don't see how float has 10^-38 accuracy but other fields that are exactly zero show as exactly zero in the log.\r\n![image](https://user-images.githubusercontent.com/4668506/188593120-248c3e76-d9ea-4360-a784-d6d61d6c7ba9.png)\r\nAlso in most places the acceptance radius gets set to the default value e.g. in the global `reset_position_setpoint()` function:\r\nhttps://github.com/PX4/PX4-Autopilot/blob/92fbd86b463dabd4c1ff0e4cec5c4205dec402f5/src/modules/navigator/navigator_main.cpp#L1067\r\nI was not able to reproduce this in SITL presumably because of different float arithmetic.\r\n\r\n### What is easily reproducible:\r\n- The `MissionBlock::set_takeoff_item()` did not overwrite the acceptance radius with the default: https://github.com/PX4/PX4-Autopilot/blob/92fbd86b463dabd4c1ff0e4cec5c4205dec402f5/src/modules/navigator/mission_block.cpp#L747\r\nlike other `set_XX_item()` do e.g. land https://github.com/PX4/PX4-Autopilot/blob/92fbd86b463dabd4c1ff0e4cec5c4205dec402f5/src/modules/navigator/mission_block.cpp#L796\r\nso I added this in 64ffe93a6f044a5bc40ec801554d37c3c1f4ec33\r\n- This value gets accepted as a proper custom acceptance radius because it's even just slightly positive in the check here:\r\nhttps://github.com/PX4/PX4-Autopilot/blob/92fbd86b463dabd4c1ff0e4cec5c4205dec402f5/src/modules/navigator/mission_block.cpp#L626 so I increased the threshold for a minimal acceptance radius to 1mm (0.001m) in 0033384bf6bd1b1e37f3c4e944c7b876010e80fd\r\nI'm not sure what we need custom acceptance radiuses for at all but it's defined in MAVLink message for waypoints: https://mavlink.io/en/messages/common.html#MAV_CMD_NAV_WAYPOINT\r\n- This almost zero acceptance radius gets published as `position_setpoint_triplet.current.acceptance_radius` and intepreted in `FlightTaskAuto` and the biggest problem with that is the condition to check for the `previous_infront` state here: https://github.com/PX4/PX4-Autopilot/blob/92fbd86b463dabd4c1ff0e4cec5c4205dec402f5/src/modules/flight_mode_manager/tasks/Auto/FlightTaskAuto.cpp#L643\r\nWe have to evalueate what this is for exactly but the result of a too small acceptance radius is that every time the previous waypoint is close to the vehicle position which often is explicitly the case when there is no previous waypoint in the triplet then the `previous_infront` state is entered in a flaky way and can cause the vehicle to not take off at all, get stuck at some altitude or even start descending again.\r\n\r\n## Describe possible alternatives\r\nMid-term I'd try to get away from:\r\n- global navigator state - that can lead to all kinds of outcomes depending on the order things are executed\r\n- custom acceptance radiuses - we should have proper path following with a progress of execution and no need for an acceptance radius to jump to continuation\r\n- FlightTaskAuto `offtrack`, `target_behind`, `previous_infront` internal state - those are for special case handling to find back to the path but often lead to strange flight behavior if enabled in the wrong moment\r\n\r\nAll these defects lead to problems like the one solved by this pr.\r\n\r\n## Test data / coverage\r\nI went through the various scenarios of small and zero acceptance radius in SITL, that's also how I found out about big part of the problem and the fixes.\r\nThis exact change was tested on the real vehicle that originally had the issues and with this it didn't happen again.","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20171/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20171/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20138","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20138/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20138/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20138/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20138","id":1357636761,"node_id":"PR_kwDOAFDaZs4-JbCN","number":20138,"title":"ekf2: estimator interface handle sample time with signed integers","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":666022583,"node_id":"MDU6TGFiZWw2NjYwMjI1ODM=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/EKF2","name":"EKF2","color":"1d76db","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-08-31T17:19:36Z","updated_at":"2022-09-01T13:47:30Z","closed_at":"2022-09-01T13:47:30Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20138","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20138","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20138.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20138.patch","merged_at":"2022-09-01T13:47:29Z"},"body":" - this prevents unsigned integer underflow if the timestamp is smaller than the configured delay (mostly a simulation edge case)\r\n - discovered when testing https://github.com/PX4/PX4-Autopilot/pull/20137","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20138/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20138/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20100","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20100/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20100/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20100/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20100","id":1348041507,"node_id":"PR_kwDOAFDaZs49paTt","number":20100,"title":"ekf2: fix replay EKF2 start when CONSTRAINED_FLASH","user":{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":666022583,"node_id":"MDU6TGFiZWw2NjYwMjI1ODM=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/EKF2","name":"EKF2","color":"1d76db","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false},"assignees":[{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false}],"milestone":null,"comments":0,"created_at":"2022-08-23T14:21:32Z","updated_at":"2022-08-23T15:14:17Z","closed_at":"2022-08-23T15:14:15Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20100","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20100","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20100.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20100.patch","merged_at":"2022-08-23T15:14:15Z"},"body":"Before (with `CONSTRAINED_FLASH`):\r\n```\r\nif replay\r\n   set replay variable\r\nelse\r\n   start EKF instance\r\nend\r\n```\r\n\r\nNow:\r\n```\r\nif replay\r\n   set replay variable\r\nend\r\n\r\nstart EKF instance\r\n```","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20100/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20100/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20072","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20072/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20072/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20072/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20072","id":1344167686,"node_id":"PR_kwDOAFDaZs49cqnp","number":20072,"title":"EKF2 MC wind estimation: fix Kacc computation","user":{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":666022583,"node_id":"MDU6TGFiZWw2NjYwMjI1ODM=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/EKF2","name":"EKF2","color":"1d76db","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false},"assignees":[{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false}],"milestone":null,"comments":1,"created_at":"2022-08-19T09:09:08Z","updated_at":"2022-08-23T09:29:15Z","closed_at":"2022-08-23T09:29:11Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20072","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20072","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20072.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20072.patch","merged_at":null},"body":"since `drag = 0.5 * rho * bcoef_inv * airspeed^2 + mcoef * airspeed`\r\nand the model used in the jacobian computation is `drag = Kacc * airspeed`\r\nthen `Kacc = 0.5 * rho * bcoef_inv * airspeed + mcoef`\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20072/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20072/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20053","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20053/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20053/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20053/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20053","id":1338975235,"node_id":"PR_kwDOAFDaZs49Lixr","number":20053,"title":"adis16470: fix accel and gyro scaling","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":1442874742,"node_id":"MDU6TGFiZWwxNDQyODc0NzQy","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Drivers%20%F0%9F%94%A7","name":"Drivers 🔧","color":"5d3ebc","default":false,"description":"Sensors, Actuators, etc"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2022-08-15T13:02:44Z","updated_at":"2022-08-16T12:40:51Z","closed_at":"2022-08-16T12:40:44Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20053","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20053","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20053.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20053.patch","merged_at":"2022-08-16T12:40:44Z"},"body":"![Screenshot from 2022-08-15 09-04-03](https://user-images.githubusercontent.com/84712/184640171-a42ea6e2-7210-430a-bf05-d9823909cfd4.png)\r\n\r\nAccel scaling was equivalent, but this shows how it's directly derived from the datasheet. Gyro scaling was wrong (and being overwritten). ","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20053/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20053/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20052","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20052/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20052/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20052/events","html_url":"https://github.com/PX4/PX4-Autopilot/issues/20052","id":1338865209,"node_id":"I_kwDOAFDaZs5PzXY5","number":20052,"title":"Offboard acuator setpoints interfere with lockstep in SITL","user":{"login":"Jaeyoung-Lim","id":5248102,"node_id":"MDQ6VXNlcjUyNDgxMDI=","avatar_url":"https://avatars.githubusercontent.com/u/5248102?v=4","gravatar_id":"","url":"https://api.github.com/users/Jaeyoung-Lim","html_url":"https://github.com/Jaeyoung-Lim","followers_url":"https://api.github.com/users/Jaeyoung-Lim/followers","following_url":"https://api.github.com/users/Jaeyoung-Lim/following{/other_user}","gists_url":"https://api.github.com/users/Jaeyoung-Lim/gists{/gist_id}","starred_url":"https://api.github.com/users/Jaeyoung-Lim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Jaeyoung-Lim/subscriptions","organizations_url":"https://api.github.com/users/Jaeyoung-Lim/orgs","repos_url":"https://api.github.com/users/Jaeyoung-Lim/repos","events_url":"https://api.github.com/users/Jaeyoung-Lim/events{/privacy}","received_events_url":"https://api.github.com/users/Jaeyoung-Lim/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":1442618266,"node_id":"MDU6TGFiZWwxNDQyNjE4MjY2","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Offboard","name":"Offboard","color":"d8954e","default":false,"description":"Offboard mode control"},{"id":4147343828,"node_id":"LA_kwDOAFDaZs73M3HU","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug-report","name":"bug-report","color":"376B2E","default":false,"description":""}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-08-15T11:28:58Z","updated_at":"2022-08-15T12:46:08Z","closed_at":null,"author_association":"MEMBER","active_lock_reason":null,"body":"## Describe the bug\r\nWhen enabling actuator setpoints for offboard mode, the simulation progresses in a much slower speed than normal simulations. This seems to be caused by actuator controls published in offboard module interfering with lockstep.\r\n\r\nThis bug was discovered by @MarvinHarms \r\n\r\n## To Reproduce\r\n- Publish `offboard_control_mode` message with actuator controls enabled (internally from PX4)\r\n- Publish `actuator_controls_o` message when in offboard mode\r\n- switch vehicle to offboard mode\r\n\r\n## Expected behavior\r\nLockstep should continue whether or not the vehicle is in offboard mode\r\n\r\n## Log Files and Screenshots\r\n![ezgif com-gif-maker (7)](https://user-images.githubusercontent.com/5248102/184627710-599d08b6-7dd7-4575-87b4-3a20d15122c4.gif)\r\n\r\n- Video: https://youtu.be/Mpve5DSk0qk\r\n- Flight log: https://review.px4.io/plot_app?log=e2dcc255-3b39-40df-ae5b-3576c6185698\r\n\r\n## Additional context\r\n- We are currently implementing an iNDI controller using the offboard interface internally\r\n- Offboard actuator setpoints were added in https://github.com/PX4/PX4-Autopilot/pull/18581 , where lockstep has been disabled for testing until now","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20052/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20052/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20037","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20037/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20037/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20037/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20037","id":1335609529,"node_id":"PR_kwDOAFDaZs49Ajiw","number":20037,"title":"NuttX Backport critical F7 Ethernet issues","user":{"login":"davids5","id":1945821,"node_id":"MDQ6VXNlcjE5NDU4MjE=","avatar_url":"https://avatars.githubusercontent.com/u/1945821?v=4","gravatar_id":"","url":"https://api.github.com/users/davids5","html_url":"https://github.com/davids5","followers_url":"https://api.github.com/users/davids5/followers","following_url":"https://api.github.com/users/davids5/following{/other_user}","gists_url":"https://api.github.com/users/davids5/gists{/gist_id}","starred_url":"https://api.github.com/users/davids5/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davids5/subscriptions","organizations_url":"https://api.github.com/users/davids5/orgs","repos_url":"https://api.github.com/users/davids5/repos","events_url":"https://api.github.com/users/davids5/events{/privacy}","received_events_url":"https://api.github.com/users/davids5/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2022-08-11T08:04:04Z","updated_at":"2022-08-12T06:22:56Z","closed_at":"2022-08-12T06:22:55Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20037","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20037","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20037.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20037.patch","merged_at":"2022-08-12T06:22:55Z"},"body":"This a critical fix for F7 Ethernet. It look like a like got deleted in the F7.  H7 is fine \r\n\r\n@dagar @mrpollo This warrants a point release.","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20037/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20037/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20032","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20032/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20032/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20032/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20032","id":1334606797,"node_id":"PR_kwDOAFDaZs489RF7","number":20032,"title":"ekf2: reset ekf preflight checks on takeoff correctly","user":{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":666022583,"node_id":"MDU6TGFiZWw2NjYwMjI1ODM=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/EKF2","name":"EKF2","color":"1d76db","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false},"assignees":[{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false}],"milestone":null,"comments":0,"created_at":"2022-08-10T13:12:09Z","updated_at":"2022-08-10T14:52:29Z","closed_at":"2022-08-10T14:52:28Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20032","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20032","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20032.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20032.patch","merged_at":"2022-08-10T14:52:28Z"},"body":"Using the control status flags isn't robust as this part of the code runs at the EKF update rate while the in_air transition is don at the prediction rate; it was then likely to miss the transition","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20032/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20032/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20028","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20028/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20028/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20028/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20028","id":1333314336,"node_id":"PR_kwDOAFDaZs484-ro","number":20028,"title":"mpu9250: try all I2C addresses if not manually specified","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":10884840,"node_id":"MDU6TGFiZWwxMDg4NDg0MA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/enhancement%20(improvement)%20%F0%9F%92%A1","name":"enhancement (improvement) 💡","color":"84b6eb","default":false,"description":""},{"id":1442874742,"node_id":"MDU6TGFiZWwxNDQyODc0NzQy","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Drivers%20%F0%9F%94%A7","name":"Drivers 🔧","color":"5d3ebc","default":false,"description":"Sensors, Actuators, etc"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2022-08-09T14:06:45Z","updated_at":"2022-08-09T17:06:41Z","closed_at":"2022-08-09T17:06:40Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20028","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20028","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20028.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20028.patch","merged_at":"2022-08-09T17:06:40Z"},"body":" - possible fix for https://github.com/PX4/PX4-Autopilot/issues/19506 (not yet tested)\r\n\r\n@navunlimited can you try this?","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20028/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20028/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20020","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20020/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20020/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20020/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20020","id":1331821260,"node_id":"PR_kwDOAFDaZs48z8AZ","number":20020,"title":"lightware dist sensor: set min range based on datasheet","user":{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false},"assignees":[{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false}],"milestone":null,"comments":0,"created_at":"2022-08-08T12:46:11Z","updated_at":"2022-08-08T23:32:45Z","closed_at":"2022-08-08T23:32:44Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20020","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20020","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20020.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20020.patch","merged_at":"2022-08-08T23:32:44Z"},"body":"SF11: https://www.documents.lightware.co.za/SF11%20-%20Laser%20Altimeter%20Manual%20-%20Rev%209.pdf\r\n![DeepinScreenshot_select-area_20220808144536](https://user-images.githubusercontent.com/14822839/183421158-790c41f4-0493-4f91-92ab-35b12747bd8c.png)\r\n\r\nSF/LW20: https://www.documents.lightware.co.za/SF11%20-%20Laser%20Altimeter%20Manual%20-%20Rev%209.pdf\r\n![DeepinScreenshot_select-area_20220808144506](https://user-images.githubusercontent.com/14822839/183421072-0666034d-7b0f-4f30-bdeb-20b3ef4f1b86.png)\r\n\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20020/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20020/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20017","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20017/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20017/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20017/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20017","id":1330785835,"node_id":"PR_kwDOAFDaZs48wlVn","number":20017,"title":"ekf2: fix yaw estimator velocity accuracy","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":666022583,"node_id":"MDU6TGFiZWw2NjYwMjI1ODM=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/EKF2","name":"EKF2","color":"1d76db","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-08-06T15:55:46Z","updated_at":"2022-08-09T01:27:02Z","closed_at":"2022-08-09T01:27:01Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20017","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20017","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20017.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20017.patch","merged_at":"2022-08-09T01:27:01Z"},"body":" - additionally require GPS speed accuracy is within EKF2_REQ_SACC\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20017/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20017/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20016","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20016/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20016/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20016/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20016","id":1330775304,"node_id":"PR_kwDOAFDaZs48wjYV","number":20016,"title":"ekf2 replay fixes","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":666022583,"node_id":"MDU6TGFiZWw2NjYwMjI1ODM=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/EKF2","name":"EKF2","color":"1d76db","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-08-06T15:05:19Z","updated_at":"2022-08-09T01:27:48Z","closed_at":"2022-08-09T01:27:48Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20016","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20016","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20016.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20016.patch","merged_at":"2022-08-09T01:27:48Z"},"body":"We desperately need something added to CI if we want this to stop breaking silently.\r\n\r\nfixes https://github.com/PX4/PX4-Autopilot/issues/19969","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20016/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20016/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20013","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20013/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20013/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20013/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20013","id":1329187186,"node_id":"PR_kwDOAFDaZs48rd1u","number":20013,"title":"gimbal: add paranoid quaternion checks and initialized values","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-08-04T21:20:57Z","updated_at":"2022-09-27T20:20:26Z","closed_at":null,"author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20013","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20013","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20013.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20013.patch","merged_at":null},"body":null,"reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20013/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20013/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20008","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20008/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20008/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20008/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20008","id":1328619862,"node_id":"PR_kwDOAFDaZs48pkre","number":20008,"title":"setEkfGlobalOrigin fixes","user":{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":666022583,"node_id":"MDU6TGFiZWw2NjYwMjI1ODM=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/EKF2","name":"EKF2","color":"1d76db","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false},"assignees":[{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false}],"milestone":null,"comments":0,"created_at":"2022-08-04T13:21:10Z","updated_at":"2022-08-04T14:50:32Z","closed_at":"2022-08-04T14:50:32Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20008","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20008","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20008.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20008.patch","merged_at":"2022-08-04T14:50:32Z"},"body":"1. the test wasn't running properly because if the ekf doesn't run, the test ratio isn't populated, so the test ratio is 0\r\n1. the maximum size of the local position origin is a cube of 1e6m. If the origin is moved further than this, the state is clipped to that maximum value. \r\n1. baro and range height offsets are \"positive up\" while `posD_change` is \"positive down\" so we need to add the `posD_change`","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20008/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20008/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19985","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19985/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19985/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19985/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19985","id":1321889458,"node_id":"PR_kwDOAFDaZs48TMNd","number":19985,"title":"Skip VTOL_TAKEOFF mission item when in fixed wing mode","user":{"login":"RomanBapst","id":7610489,"node_id":"MDQ6VXNlcjc2MTA0ODk=","avatar_url":"https://avatars.githubusercontent.com/u/7610489?v=4","gravatar_id":"","url":"https://api.github.com/users/RomanBapst","html_url":"https://github.com/RomanBapst","followers_url":"https://api.github.com/users/RomanBapst/followers","following_url":"https://api.github.com/users/RomanBapst/following{/other_user}","gists_url":"https://api.github.com/users/RomanBapst/gists{/gist_id}","starred_url":"https://api.github.com/users/RomanBapst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RomanBapst/subscriptions","organizations_url":"https://api.github.com/users/RomanBapst/orgs","repos_url":"https://api.github.com/users/RomanBapst/repos","events_url":"https://api.github.com/users/RomanBapst/events{/privacy}","received_events_url":"https://api.github.com/users/RomanBapst/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":78699916,"node_id":"MDU6TGFiZWw3ODY5OTkxNg==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Fixed%20Wing%20%F0%9F%9B%A9%EF%B8%8F","name":"Fixed Wing 🛩️","color":"009800","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2022-07-29T07:51:42Z","updated_at":"2022-09-08T12:41:33Z","closed_at":"2022-08-02T13:34:42Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/19985","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19985","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/19985.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/19985.patch","merged_at":"2022-08-02T13:34:42Z"},"body":"\r\n## Describe problem solved by this pull request\r\nWhen updating a mission while the vehicle is already flying in fixed wing mode the mission index is reset. If the mission contains a VTOL_TAKEOFF item then the vehicle will navigate to it. This does not make sense as the vehicle has already transitioned.\r\n\r\n## Describe your solution\r\nSkip VTOL_TAKEOFF item when already in fixed wing mode.\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19985/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19985/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19962","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19962/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19962/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19962/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19962","id":1317854729,"node_id":"PR_kwDOAFDaZs48F65Y","number":19962,"title":"MCPosControl: fix horizontal anti-reset windup algorithm","user":{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false},"assignees":[{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false}],"milestone":null,"comments":0,"created_at":"2022-07-26T08:02:44Z","updated_at":"2022-08-18T12:19:11Z","closed_at":"2022-08-18T12:19:10Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/19962","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19962","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/19962.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/19962.patch","merged_at":"2022-08-18T12:19:10Z"},"body":"Since the horizontal and vertical velocity controllers are now decoupled, it can be that the horizontal acceleration produced by the controller is actually greater than the desired one (by design). This condition would actually make the ARW run \"backwards\", degrading the controller performance.\r\n\r\nCurrent state of PX4:\r\nWe can see below that the integrator continues to increase even when the velocity overshoots the setpoint because  the anti-reset windup loop works in reverse when the produced acceleration is larger than the desired one (this was never possible in the past, with the coupled XY and Z axes).\r\n![DeepinScreenshot_select-area_20220725163435](https://user-images.githubusercontent.com/14822839/180954042-168bedeb-9457-446a-b314-9e1d95dee14d.png)\r\n\r\nWith this PR:\r\nThe integrator now works properly; there is also less overshoot in general\r\n![DeepinScreenshot_select-area_20220725164006](https://user-images.githubusercontent.com/14822839/180954100-8cd6a7f3-6bdc-4bbe-bff4-44e103670c85.png)\r\n\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19962/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19962/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19950","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19950/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19950/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19950/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19950","id":1315229833,"node_id":"PR_kwDOAFDaZs479jTp","number":19950,"title":"ekf2: handle all time on delayed horizon (except for newest sample checks)","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":666022583,"node_id":"MDU6TGFiZWw2NjYwMjI1ODM=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/EKF2","name":"EKF2","color":"1d76db","default":false,"description":""},{"id":803319897,"node_id":"MDU6TGFiZWw4MDMzMTk4OTc=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/cleanup%20(housekeeping)%20%F0%9F%A7%B9","name":"cleanup (housekeeping) 🧹","color":"aefcbd","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2022-07-22T16:57:21Z","updated_at":"2022-08-31T12:52:31Z","closed_at":"2022-08-31T12:52:30Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/19950","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19950","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/19950.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/19950.patch","merged_at":"2022-08-31T12:52:30Z"},"body":" - a growing number of samples come into the backend with the time already delayed (sensor's interrupt setting timestamp sample)\r\n - if the incoming timestamp is already delayed then the new data checks (relative to latest IMU) can be slightly wrong\r\n - handle almost all timestamps and checks on delayed time horizon, except for explicit checks of new samples\r\n - isRecent() and isTimedOut() helpers use delayed time\r\n - add new isNewestSampleRecent() used for checking the incoming timestamp of the incoming (adjusted) data\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19950/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19950/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19942","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19942/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19942/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19942/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19942","id":1313206096,"node_id":"PR_kwDOAFDaZs472h5I","number":19942,"title":"FW Position control: do not use position_setpoint.valid to validate current position_setpoint","user":{"login":"sfuhrer","id":26798987,"node_id":"MDQ6VXNlcjI2Nzk4OTg3","avatar_url":"https://avatars.githubusercontent.com/u/26798987?v=4","gravatar_id":"","url":"https://api.github.com/users/sfuhrer","html_url":"https://github.com/sfuhrer","followers_url":"https://api.github.com/users/sfuhrer/followers","following_url":"https://api.github.com/users/sfuhrer/following{/other_user}","gists_url":"https://api.github.com/users/sfuhrer/gists{/gist_id}","starred_url":"https://api.github.com/users/sfuhrer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfuhrer/subscriptions","organizations_url":"https://api.github.com/users/sfuhrer/orgs","repos_url":"https://api.github.com/users/sfuhrer/repos","events_url":"https://api.github.com/users/sfuhrer/events{/privacy}","received_events_url":"https://api.github.com/users/sfuhrer/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":78699916,"node_id":"MDU6TGFiZWw3ODY5OTkxNg==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Fixed%20Wing%20%F0%9F%9B%A9%EF%B8%8F","name":"Fixed Wing 🛩️","color":"009800","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2022-07-21T12:47:09Z","updated_at":"2022-10-21T07:51:40Z","closed_at":"2022-10-21T07:51:39Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/19942","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19942","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/19942.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/19942.patch","merged_at":"2022-10-21T07:51:39Z"},"body":"## Describe problem solved by this pull request\r\nThe fixed-wing GPS failure mitigation mode was broken as (seemingly only since recently) `pos_sp_curr_valid` gets invalidated when local position is invalid. That made it up ending up in FW_POSCTRL_MODE_OTHER, resulting in undefined behavior basically. \r\n\r\n## Describe your solution\r\n~Removed the check for `pos_sp_curr_valid` and only check the `control_mode.flag_control_*` flags in the fixed-wing position controller mode selection. \r\nContext: https://github.com/PX4/PX4-Autopilot/issues/18573#issuecomment-962078351. If nobody exactly knows what this additional check is there for let's better remove it and keep the logic simple. Happy to learn about the need for it otherwise, and find an different solution.~\r\n\r\nEDIT: I've pushed 3 commits to solve it and make hopefully more robust:\r\n- https://github.com/PX4/PX4-Autopilot/pull/19942/commits/a09c68fbd163eddceca1525e363a4cdc1592e0c9: allow to switch to AUTO_ALTITUDE and AUTO_CLIMBRATE also if the .valid flag is false, and also don't check the position_sp lat/lon, as it's not needed.\r\n- a994f76636876060fc23518db29cf5e162a4cb6e: instead of checking for the .valid flag, check the lat/lon/alt fields of the position_setpoints, as I saw instances where the .valid was true, lat/lon though NAN. Happens e.g. when triggering a LAND (which is what happens when GPS is lost --> global_position invalid --> LAND --> local_position invalid --> DESCEND).\r\n- 6e168cf4d366ef45cb23868bfc13c28c3a138107: within npfg, guard airspeed_ref_ against NAN. Added as I saw that when you feed a NAN waypoint into npfg the airspeed_ref becomes NAN. This in theory isn't required with the introduced check for lat/lon/alt validity (see above commit) , but as the outcome of a airspeed_ref = NAN is quite drastic (it blows up TECS to an unrecoverable state), I think adding this safety there makes sense. @tstastny maybe you know a better place to add the NAN-guards.\r\n\r\n## Describe possible alternatives\r\n\r\n## Test data / coverage\r\nSITL tested on VTOL (w/ and w/o NAV_FORCE_VT, making it transition prior to descend), and plane.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19942/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19942/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19928","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19928/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19928/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19928/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19928","id":1309747218,"node_id":"PR_kwDOAFDaZs47qba-","number":19928,"title":"Fix fw rtl delay","user":{"login":"tstastny","id":8026163,"node_id":"MDQ6VXNlcjgwMjYxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8026163?v=4","gravatar_id":"","url":"https://api.github.com/users/tstastny","html_url":"https://github.com/tstastny","followers_url":"https://api.github.com/users/tstastny/followers","following_url":"https://api.github.com/users/tstastny/following{/other_user}","gists_url":"https://api.github.com/users/tstastny/gists{/gist_id}","starred_url":"https://api.github.com/users/tstastny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tstastny/subscriptions","organizations_url":"https://api.github.com/users/tstastny/orgs","repos_url":"https://api.github.com/users/tstastny/repos","events_url":"https://api.github.com/users/tstastny/events{/privacy}","received_events_url":"https://api.github.com/users/tstastny/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":78699916,"node_id":"MDU6TGFiZWw3ODY5OTkxNg==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Fixed%20Wing%20%F0%9F%9B%A9%EF%B8%8F","name":"Fixed Wing 🛩️","color":"009800","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"tstastny","id":8026163,"node_id":"MDQ6VXNlcjgwMjYxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8026163?v=4","gravatar_id":"","url":"https://api.github.com/users/tstastny","html_url":"https://github.com/tstastny","followers_url":"https://api.github.com/users/tstastny/followers","following_url":"https://api.github.com/users/tstastny/following{/other_user}","gists_url":"https://api.github.com/users/tstastny/gists{/gist_id}","starred_url":"https://api.github.com/users/tstastny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tstastny/subscriptions","organizations_url":"https://api.github.com/users/tstastny/orgs","repos_url":"https://api.github.com/users/tstastny/repos","events_url":"https://api.github.com/users/tstastny/events{/privacy}","received_events_url":"https://api.github.com/users/tstastny/received_events","type":"User","site_admin":false},"assignees":[{"login":"tstastny","id":8026163,"node_id":"MDQ6VXNlcjgwMjYxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8026163?v=4","gravatar_id":"","url":"https://api.github.com/users/tstastny","html_url":"https://github.com/tstastny","followers_url":"https://api.github.com/users/tstastny/followers","following_url":"https://api.github.com/users/tstastny/following{/other_user}","gists_url":"https://api.github.com/users/tstastny/gists{/gist_id}","starred_url":"https://api.github.com/users/tstastny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tstastny/subscriptions","organizations_url":"https://api.github.com/users/tstastny/orgs","repos_url":"https://api.github.com/users/tstastny/repos","events_url":"https://api.github.com/users/tstastny/events{/privacy}","received_events_url":"https://api.github.com/users/tstastny/received_events","type":"User","site_admin":false}],"milestone":null,"comments":5,"created_at":"2022-07-19T16:07:29Z","updated_at":"2022-10-21T15:26:37Z","closed_at":"2022-07-20T12:15:12Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/19928","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19928","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/19928.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/19928.patch","merged_at":"2022-07-20T12:15:12Z"},"body":"## Describe problem solved by this pull request\r\nRTL delay was being ignored when flying with a fixed-wing.\r\n\r\n## Describe your solution\r\n- allow fixed-wing platforms to progress all the way to the \"loiter\" state in RTL, respecting the delay if enabled, or loitering indefinitely at the destination\r\n- fix home vs destination altitude discrepancy for RTL altitude (was flying back at an unexpected altitude due to setting home instead of destination as reference)\r\n- fix RTL delay printout\r\n\r\n## Test data / coverage\r\nTested in SITL\r\n\r\n## Additional context\r\nIn the future, we should really get rid of the mission / RTL switching happening. It's quite error prone. But this is another whole project.\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19928/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19928/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19920","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19920/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19920/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19920/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19920","id":1306854756,"node_id":"PR_kwDOAFDaZs47g1On","number":19920,"title":"ekf2: update range sample fix ekf2_timestamps","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":666022583,"node_id":"MDU6TGFiZWw2NjYwMjI1ODM=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/EKF2","name":"EKF2","color":"1d76db","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2022-07-16T16:56:29Z","updated_at":"2022-07-18T18:39:13Z","closed_at":"2022-07-18T18:39:13Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/19920","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19920","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/19920.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/19920.patch","merged_at":"2022-07-18T18:39:13Z"},"body":" - this is necessary to use distance_sensor data in replay\r\n\r\nBackport for v1.13.1\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19920/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19920/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19918","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19918/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19918/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19918/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19918","id":1305973567,"node_id":"PR_kwDOAFDaZs47d726","number":19918,"title":"ekf2: add missing mag fuse type in enum","user":{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":666022583,"node_id":"MDU6TGFiZWw2NjYwMjI1ODM=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/EKF2","name":"EKF2","color":"1d76db","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false},"assignees":[{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false}],"milestone":null,"comments":0,"created_at":"2022-07-15T12:23:08Z","updated_at":"2022-07-15T13:57:19Z","closed_at":"2022-07-15T13:57:18Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/19918","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19918","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/19918.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/19918.patch","merged_at":"2022-07-15T13:57:18Z"},"body":"Got accidentally removed in https://github.com/PX4/PX4-Autopilot/commit/ea10eacb997d6ad9e91b0ba8777b1454fd9bf54e#diff-a2d8d24867c9fe8a41c8277913b3fba8469e69338097db46ab315e4fa65f21a6L211 , creating an enum mismatch between PX4 and the EKF backend.","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19918/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19918/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19906","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19906/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19906/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19906/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19906","id":1302453480,"node_id":"PR_kwDOAFDaZs47SQD5","number":19906,"title":"Fix busy loop in gps module when using RTCM","user":{"login":"RomanBapst","id":7610489,"node_id":"MDQ6VXNlcjc2MTA0ODk=","avatar_url":"https://avatars.githubusercontent.com/u/7610489?v=4","gravatar_id":"","url":"https://api.github.com/users/RomanBapst","html_url":"https://github.com/RomanBapst","followers_url":"https://api.github.com/users/RomanBapst/followers","following_url":"https://api.github.com/users/RomanBapst/following{/other_user}","gists_url":"https://api.github.com/users/RomanBapst/gists{/gist_id}","starred_url":"https://api.github.com/users/RomanBapst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RomanBapst/subscriptions","organizations_url":"https://api.github.com/users/RomanBapst/orgs","repos_url":"https://api.github.com/users/RomanBapst/repos","events_url":"https://api.github.com/users/RomanBapst/events{/privacy}","received_events_url":"https://api.github.com/users/RomanBapst/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2022-07-12T18:13:45Z","updated_at":"2022-07-13T05:49:48Z","closed_at":"2022-07-13T05:49:47Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/19906","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19906","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/19906.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/19906.patch","merged_at":"2022-07-13T05:49:47Z"},"body":"Please use [PX4 Discuss](http://discuss.px4.io/) or [Slack](http://slack.px4.io/) to align on pull requests if necessary. You can then open draft pull requests to get early feedback.\r\n\r\n## Describe problem solved by this pull request\r\nRTCM data message length was increased to 300 bytes without changing data type of integer holding the length.\r\nThis caused an overflow which lead to a busy loop in the gps driver.\r\n\r\n## Describe your solution\r\nUse a uint16.\r\n\r\n## Describe possible alternatives\r\nA clear and concise description of alternative solutions or features you've considered.\r\n\r\n## Test data / coverage\r\nHow was it tested? What cases were covered? Logs uploaded to https://review.px4.io/ and screenshots of the important plot parts.\r\n\r\n## Additional context\r\nAdd any other related context or media.\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19906/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19906/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19903","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19903/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19903/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19903/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19903","id":1302101413,"node_id":"PR_kwDOAFDaZs47RDHl","number":19903,"title":"ekf2: vehicle_local_position add dead_reckoning flag","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":10884840,"node_id":"MDU6TGFiZWwxMDg4NDg0MA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/enhancement%20(improvement)%20%F0%9F%92%A1","name":"enhancement (improvement) 💡","color":"84b6eb","default":false,"description":""},{"id":78699916,"node_id":"MDU6TGFiZWw3ODY5OTkxNg==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Fixed%20Wing%20%F0%9F%9B%A9%EF%B8%8F","name":"Fixed Wing 🛩️","color":"009800","default":false,"description":""},{"id":249514594,"node_id":"MDU6TGFiZWwyNDk1MTQ1OTQ=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Hybrid%20VTOL%20%F0%9F%9B%A9%EF%B8%8F%F0%9F%9A%81","name":"Hybrid VTOL 🛩️🚁","color":"bfe5bf","default":false,"description":"Multirotor + Fixedwing!"},{"id":666022583,"node_id":"MDU6TGFiZWw2NjYwMjI1ODM=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/EKF2","name":"EKF2","color":"1d76db","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-07-12T13:54:01Z","updated_at":"2022-07-13T07:01:34Z","closed_at":"2022-07-13T07:01:34Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/19903","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19903","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/19903.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/19903.patch","merged_at":"2022-07-13T07:01:34Z"},"body":null,"reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19903/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19903/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19894","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19894/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19894/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19894/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19894","id":1300831984,"node_id":"PR_kwDOAFDaZs47MzXs","number":19894,"title":"differential_pressure/sdp3x: sdp3x_main fix 'keep running' regression","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2022-07-11T14:55:31Z","updated_at":"2022-07-12T07:11:59Z","closed_at":"2022-07-12T07:11:58Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/19894","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19894","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/19894.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/19894.patch","merged_at":"2022-07-12T07:11:58Z"},"body":null,"reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19894/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19894/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19873","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19873/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19873/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19873/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19873","id":1294277084,"node_id":"PR_kwDOAFDaZs462sEd","number":19873,"title":"Landing position updates for precision landing.","user":{"login":"kapacheuski","id":186350,"node_id":"MDQ6VXNlcjE4NjM1MA==","avatar_url":"https://avatars.githubusercontent.com/u/186350?v=4","gravatar_id":"","url":"https://api.github.com/users/kapacheuski","html_url":"https://github.com/kapacheuski","followers_url":"https://api.github.com/users/kapacheuski/followers","following_url":"https://api.github.com/users/kapacheuski/following{/other_user}","gists_url":"https://api.github.com/users/kapacheuski/gists{/gist_id}","starred_url":"https://api.github.com/users/kapacheuski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kapacheuski/subscriptions","organizations_url":"https://api.github.com/users/kapacheuski/orgs","repos_url":"https://api.github.com/users/kapacheuski/repos","events_url":"https://api.github.com/users/kapacheuski/events{/privacy}","received_events_url":"https://api.github.com/users/kapacheuski/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2022-07-05T13:06:39Z","updated_at":"2023-02-07T17:07:47Z","closed_at":"2023-02-07T17:07:46Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/19873","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19873","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/19873.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/19873.patch","merged_at":null},"body":"## Problem\r\n\r\nPrecision landing works incorrectly - Target position is not updated during the descent above target.\r\n\r\n## Solution\r\n`_prepareLandSetpoints` needs to update `_land_position` continuously.\r\n\r\n## Test coverage\r\nTests were performed on quadcopters with and without a fix.\r\n\r\n### Log without fix\r\n<img width=\"693\" alt=\"WithoutFix\" src=\"https://user-images.githubusercontent.com/186350/177326007-654a6cc2-364c-4c6c-a144-08f3e91afd47.png\">\r\n\r\n### Log with fix\r\n<img width=\"693\" alt=\"WithFix\" src=\"https://user-images.githubusercontent.com/186350/177326010-aeb1c73c-ba12-408e-972c-1acb47af53aa.png\">","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19873/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19873/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19846","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19846/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19846/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19846/events","html_url":"https://github.com/PX4/PX4-Autopilot/issues/19846","id":1287561998,"node_id":"I_kwDOAFDaZs5MvqMO","number":19846,"title":"Issue with heading estimation","user":{"login":"FrankvVeelen","id":38689015,"node_id":"MDQ6VXNlcjM4Njg5MDE1","avatar_url":"https://avatars.githubusercontent.com/u/38689015?v=4","gravatar_id":"","url":"https://api.github.com/users/FrankvVeelen","html_url":"https://github.com/FrankvVeelen","followers_url":"https://api.github.com/users/FrankvVeelen/followers","following_url":"https://api.github.com/users/FrankvVeelen/following{/other_user}","gists_url":"https://api.github.com/users/FrankvVeelen/gists{/gist_id}","starred_url":"https://api.github.com/users/FrankvVeelen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/FrankvVeelen/subscriptions","organizations_url":"https://api.github.com/users/FrankvVeelen/orgs","repos_url":"https://api.github.com/users/FrankvVeelen/repos","events_url":"https://api.github.com/users/FrankvVeelen/events{/privacy}","received_events_url":"https://api.github.com/users/FrankvVeelen/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"assignees":[{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false}],"milestone":null,"comments":22,"created_at":"2022-06-28T15:56:49Z","updated_at":"2022-12-19T15:21:17Z","closed_at":"2022-12-19T15:21:17Z","author_association":"NONE","active_lock_reason":null,"body":"We are developing a drone with the PX4 firmware, running on a holybro V5x FCU.\r\n\r\nWe have run into an issue which we can't understand within the team, so I am hoping for someone to help us.\r\nThe issue has happened in multiple flights, but can be easiest seen in the following flight log: \r\n[log](https://review.px4.io/plot_app?log=9d997dff-c93e-4d6b-a257-8a581f824e0a)\r\n\r\nThe heading estimate is very unstable (a jump of >90 degrees at the 1:12 mark), after which the drone is almost uncontrollable, since all orientations are messed up. This has started happening repeatedly, but we have also made more than 10 flights before where the issue did not arise.\r\n\r\nI have noticed that the EKFs are also using the internal magnetometer, while it is set at a lower priority and the external magnetometer does produce data.\r\n\r\nIf anyone can assist (even if only giving some pointers on how to analyse this issue) that'd be greatly appreciated.","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19846/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19846/timeline","performed_via_github_app":null,"state_reason":"completed"},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19843","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19843/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19843/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19843/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19843","id":1286119541,"node_id":"PR_kwDOAFDaZs46brot","number":19843,"title":"px4io: minimal backup scheduling regardless of dynamic mixing","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-06-27T17:24:09Z","updated_at":"2022-07-20T05:15:37Z","closed_at":"2022-07-20T05:15:36Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/19843","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19843","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/19843.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/19843.patch","merged_at":"2022-07-20T05:15:36Z"},"body":" - even if there's no configured output we still need to run to grab RC data\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19843/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19843/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19842","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19842/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19842/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19842/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19842","id":1286102569,"node_id":"PR_kwDOAFDaZs46boFz","number":19842,"title":"fw_att_control: add simple backup scheduling if vehicle_attitude unavailable (or stops)","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":10884840,"node_id":"MDU6TGFiZWwxMDg4NDg0MA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/enhancement%20(improvement)%20%F0%9F%92%A1","name":"enhancement (improvement) 💡","color":"84b6eb","default":false,"description":""},{"id":78699916,"node_id":"MDU6TGFiZWw3ODY5OTkxNg==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Fixed%20Wing%20%F0%9F%9B%A9%EF%B8%8F","name":"Fixed Wing 🛩️","color":"009800","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-06-27T17:07:35Z","updated_at":"2022-07-20T04:53:38Z","closed_at":"2022-07-20T04:53:37Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/19842","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19842","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/19842.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/19842.patch","merged_at":"2022-07-20T04:53:37Z"},"body":"This adds simple backup scheduling to the FW attitude controller so that it continues to run if the `vehicle_attitude` isn't available (or stops midflight). The changes are intended to be a minimal quick fix, but later I'd like to do a larger refactor with separation of the attitude and rate controller that only run if/when the relevant input data is available. It would also be nice to fully remove FW manual mode handling from the attitude controller into a future FlightTask (soon to be standalone flight mode).\r\n\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19842/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19842/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19840","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19840/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19840/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19840/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19840","id":1286065444,"node_id":"PR_kwDOAFDaZs46bgHF","number":19840,"title":"ekf2: if multi-mag disabled (EKF2_MULTI_MAG <= 1) properly re-enable sensors hub selection (SENS_MAG_MODE)","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":666022583,"node_id":"MDU6TGFiZWw2NjYwMjI1ODM=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/EKF2","name":"EKF2","color":"1d76db","default":false,"description":""},{"id":1442627275,"node_id":"MDU6TGFiZWwxNDQyNjI3Mjc1","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Sensors","name":"Sensors","color":"48c13e","default":false,"description":"All the sensors!"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-06-27T16:40:03Z","updated_at":"2022-07-20T05:16:56Z","closed_at":"2022-07-20T05:16:55Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/19840","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19840","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/19840.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/19840.patch","merged_at":"2022-07-20T05:16:55Z"},"body":" - this prevents potential misconfiguration if trying to disable ekf2 multi mag\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19840/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19840/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19839","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19839/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19839/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19839/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19839","id":1286015178,"node_id":"PR_kwDOAFDaZs46bV7C","number":19839,"title":"sensors/vehicle_magnetometer: don't advertise vehicle_magnetometer instance if mag has been disable","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-06-27T16:01:29Z","updated_at":"2022-07-20T05:18:20Z","closed_at":"2022-07-20T05:18:19Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/19839","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19839","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/19839.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/19839.patch","merged_at":"2022-07-20T05:18:19Z"},"body":" - if using multi-EKF across all magnetometers then an instance of vehicle_magnetometer is advertised immediately for every sensor_mag instance\r\n - this can become problematic if EKF2 multi-mag is enabled, but with only 1 IMU (EKF2_MULTI_MAG) because you will be stuck with no magnetometer data\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19839/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19839/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19777","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19777/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19777/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19777/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19777","id":1263570372,"node_id":"PR_kwDOAFDaZs45QhbK","number":19777,"title":"Safety disabled startup tune","user":{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false},"assignees":[{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false}],"milestone":null,"comments":0,"created_at":"2022-06-07T16:32:37Z","updated_at":"2022-06-08T09:12:06Z","closed_at":"2022-06-08T09:12:05Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/19777","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19777","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/19777.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/19777.patch","merged_at":"2022-06-08T09:12:05Z"},"body":"## Describe problem solved by this pull request\r\nIt was reported that the startup tune doesn't play fully anymore on master. It was reproducible all the time on my setup. I found the breaking commit to be https://github.com/PX4/PX4-Autopilot/commit/08dcc72e1fea75d2609234cecd7588ecb37492d1. Looking into more detail the safety handling can be and is by default disabled by circuit breaker parameter `CBRK_IO_SAFETY`. In that case the safety status changes once at boot and for that change with mentioned commit there is a tune output for the user that interrupts the startup tune.  \r\n\r\n## Describe your solution\r\nI don't output any tunes for safety if it's disabled (3rd commit [1310dde](https://github.com/PX4/PX4-Autopilot/pull/19777/commits/1310dde035d4196ec5844992ede6b1260f5231fe)) the rest is just refactoring.\r\n\r\n## Test data / coverage\r\nI tested that the startup tune is not interrupted anymore and disabling safety still works with tune notification when the circuit breaker is not set (safety enabled).\r\n\r\n## Additional context\r\nRelated to https://github.com/PX4/PX4-Autopilot/pull/19558\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19777/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19777/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19765","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19765/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19765/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19765/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19765","id":1260799622,"node_id":"PR_kwDOAFDaZs45HURC","number":19765,"title":"sensors/vehicle_imu: don't bother checking IMU_GYRO_RATEMAX","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":10884840,"node_id":"MDU6TGFiZWwxMDg4NDg0MA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/enhancement%20(improvement)%20%F0%9F%92%A1","name":"enhancement (improvement) 💡","color":"84b6eb","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2022-06-04T15:17:07Z","updated_at":"2022-06-07T19:45:49Z","closed_at":"2022-06-07T19:45:48Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/19765","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19765","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/19765.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/19765.patch","merged_at":"2022-06-07T19:45:48Z"},"body":" - fixes https://github.com/PX4/PX4-Autopilot/issues/19760","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19765/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19765/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19746","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19746/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19746/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19746/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19746","id":1252839487,"node_id":"PR_kwDOAFDaZs44sFaj","number":19746,"title":"FlightModeManager: only execute flight task commands when multicopter","user":{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false},"assignees":[{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false}],"milestone":null,"comments":1,"created_at":"2022-05-30T14:47:02Z","updated_at":"2022-06-01T13:14:09Z","closed_at":"2022-06-01T13:14:08Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/19746","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19746","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/19746.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/19746.patch","merged_at":"2022-06-01T13:14:08Z"},"body":"## Describe problem solved by this pull request\r\nWhen flying a VTOL in fixed-wing operation and sending an Orbit command with a large radius the user gets an error that the limit is exceeded even though for fixed-wing there is apparently no limit.\r\n\r\n## Describe your solution\r\nThe issue is that for VTOLs in fixed-wing all flight tasks are stopped as part of the loop but an incoming command can still get processed and start a task that checks the parameters just to get stopped again. I'm only allowing task switching commands while the vehicle is a multicopter.\r\n\r\n## Describe possible alternatives\r\nLater on we need to dispatch the different modes depending on vehicle type. That's also why I just solved it this way and didn't just prohibit running any flight mode manager activity when the vehicle type is different from a multicopter.\r\n\r\n## Test data / coverage\r\nI verified in simulation that the problem is solved.","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19746/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19746/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19741","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19741/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19741/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19741/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19741","id":1251938370,"node_id":"PR_kwDOAFDaZs44pHwz","number":19741,"title":"update NuttX and apps to latest with sem holder fixes and updated ostest","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":581805812,"node_id":"MDU6TGFiZWw1ODE4MDU4MTI=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/NuttX%20(OS)","name":"NuttX (OS)","color":"3C33E3","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2022-05-29T16:52:12Z","updated_at":"2022-05-29T17:41:17Z","closed_at":"2022-05-29T17:41:17Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/19741","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19741","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/19741.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/19741.patch","merged_at":"2022-05-29T17:41:16Z"},"body":null,"reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19741/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19741/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19725","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19725/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19725/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19725/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19725","id":1249786546,"node_id":"PR_kwDOAFDaZs44iEwP","number":19725,"title":"Fix bug with yaw only reposition","user":{"login":"DonLakeFlyer","id":5876851,"node_id":"MDQ6VXNlcjU4NzY4NTE=","avatar_url":"https://avatars.githubusercontent.com/u/5876851?v=4","gravatar_id":"","url":"https://api.github.com/users/DonLakeFlyer","html_url":"https://github.com/DonLakeFlyer","followers_url":"https://api.github.com/users/DonLakeFlyer/followers","following_url":"https://api.github.com/users/DonLakeFlyer/following{/other_user}","gists_url":"https://api.github.com/users/DonLakeFlyer/gists{/gist_id}","starred_url":"https://api.github.com/users/DonLakeFlyer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DonLakeFlyer/subscriptions","organizations_url":"https://api.github.com/users/DonLakeFlyer/orgs","repos_url":"https://api.github.com/users/DonLakeFlyer/repos","events_url":"https://api.github.com/users/DonLakeFlyer/events{/privacy}","received_events_url":"https://api.github.com/users/DonLakeFlyer/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2022-05-26T16:30:31Z","updated_at":"2022-09-08T22:02:23Z","closed_at":"2022-09-08T21:55:31Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/19725","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19725","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/19725.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/19725.patch","merged_at":"2022-09-08T21:55:31Z"},"body":"Fix for #19722","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19725/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19725/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19715","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19715/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19715/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19715/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19715","id":1247017306,"node_id":"PR_kwDOAFDaZs44Y2Gw","number":19715,"title":"px4iofirmwre: remove enter bl protection flag","user":{"login":"Igor-Misic","id":10188706,"node_id":"MDQ6VXNlcjEwMTg4NzA2","avatar_url":"https://avatars.githubusercontent.com/u/10188706?v=4","gravatar_id":"","url":"https://api.github.com/users/Igor-Misic","html_url":"https://github.com/Igor-Misic","followers_url":"https://api.github.com/users/Igor-Misic/followers","following_url":"https://api.github.com/users/Igor-Misic/following{/other_user}","gists_url":"https://api.github.com/users/Igor-Misic/gists{/gist_id}","starred_url":"https://api.github.com/users/Igor-Misic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Igor-Misic/subscriptions","organizations_url":"https://api.github.com/users/Igor-Misic/orgs","repos_url":"https://api.github.com/users/Igor-Misic/repos","events_url":"https://api.github.com/users/Igor-Misic/events{/privacy}","received_events_url":"https://api.github.com/users/Igor-Misic/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2022-05-24T19:13:05Z","updated_at":"2022-05-30T09:53:10Z","closed_at":"2022-05-27T13:47:11Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/19715","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19715","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/19715.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/19715.patch","merged_at":null},"body":"Removing the flag `PX4IO_P_SETUP_ARMING_FMU_ARMED` from preventing from entering in BL. It was wrongly interpreted as vehicle armed state, but the reality is that it gets to 1 with reboot and it prevents IO board flashing. ","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19715/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19715/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19709","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19709/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19709/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19709/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19709","id":1246407179,"node_id":"PR_kwDOAFDaZs44W1f2","number":19709,"title":"MulticopterRateControl: fix thrust sign for acro","user":{"login":"bkueng","id":281593,"node_id":"MDQ6VXNlcjI4MTU5Mw==","avatar_url":"https://avatars.githubusercontent.com/u/281593?v=4","gravatar_id":"","url":"https://api.github.com/users/bkueng","html_url":"https://github.com/bkueng","followers_url":"https://api.github.com/users/bkueng/followers","following_url":"https://api.github.com/users/bkueng/following{/other_user}","gists_url":"https://api.github.com/users/bkueng/gists{/gist_id}","starred_url":"https://api.github.com/users/bkueng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bkueng/subscriptions","organizations_url":"https://api.github.com/users/bkueng/orgs","repos_url":"https://api.github.com/users/bkueng/repos","events_url":"https://api.github.com/users/bkueng/events{/privacy}","received_events_url":"https://api.github.com/users/bkueng/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":78699954,"node_id":"MDU6TGFiZWw3ODY5OTk1NA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Multirotor%20%F0%9F%9B%B8","name":"Multirotor 🛸","color":"0052cc","default":false,"description":""},{"id":174161208,"node_id":"MDU6TGFiZWwxNzQxNjEyMDg=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/priority-critical","name":"priority-critical","color":"e11d21","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-05-24T11:34:56Z","updated_at":"2022-05-25T08:14:10Z","closed_at":"2022-05-24T13:03:17Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/19709","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19709","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/19709.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/19709.patch","merged_at":"2022-05-24T13:03:17Z"},"body":"Regression from fbc109436f00a815eb6130c6d177086e6b1ae80a\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19709/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19709/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19701","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19701/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19701/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19701/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19701","id":1245379411,"node_id":"PR_kwDOAFDaZs44TepM","number":19701,"title":"ekf2: use explicit flags instead of bitmask position","user":{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":666022583,"node_id":"MDU6TGFiZWw2NjYwMjI1ODM=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/EKF2","name":"EKF2","color":"1d76db","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false},"assignees":[{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false}],"milestone":null,"comments":0,"created_at":"2022-05-23T15:47:49Z","updated_at":"2022-05-23T18:43:03Z","closed_at":"2022-05-23T18:43:02Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/19701","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19701","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/19701.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/19701.patch","merged_at":"2022-05-23T18:43:02Z"},"body":"This prevents bitmask mismatch when a new flag is inserted\r\n\r\nOffsets of 3 for mag and 10 for flow was in the \"old\" bitmask; now it's 4 and 11 but it's even better to use the name directly.","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19701/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19701/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19699","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19699/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19699/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19699/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19699","id":1245344181,"node_id":"PR_kwDOAFDaZs44TW2a","number":19699,"title":"px4iofirmware: fix for bug introduced with #19558","user":{"login":"Igor-Misic","id":10188706,"node_id":"MDQ6VXNlcjEwMTg4NzA2","avatar_url":"https://avatars.githubusercontent.com/u/10188706?v=4","gravatar_id":"","url":"https://api.github.com/users/Igor-Misic","html_url":"https://github.com/Igor-Misic","followers_url":"https://api.github.com/users/Igor-Misic/followers","following_url":"https://api.github.com/users/Igor-Misic/following{/other_user}","gists_url":"https://api.github.com/users/Igor-Misic/gists{/gist_id}","starred_url":"https://api.github.com/users/Igor-Misic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Igor-Misic/subscriptions","organizations_url":"https://api.github.com/users/Igor-Misic/orgs","repos_url":"https://api.github.com/users/Igor-Misic/repos","events_url":"https://api.github.com/users/Igor-Misic/events{/privacy}","received_events_url":"https://api.github.com/users/Igor-Misic/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-05-23T15:24:55Z","updated_at":"2022-05-23T18:59:12Z","closed_at":"2022-05-23T18:59:12Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/19699","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19699","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/19699.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/19699.patch","merged_at":"2022-05-23T18:59:12Z"},"body":"This should solve the issue for px4io entering in BL. ","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19699/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19699/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19695","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19695/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19695/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19695/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19695","id":1244919798,"node_id":"PR_kwDOAFDaZs44R6gD","number":19695,"title":"sensors/vehicle_magnetometer: fix multi_mode check","user":{"login":"aksuns96","id":70697874,"node_id":"MDQ6VXNlcjcwNjk3ODc0","avatar_url":"https://avatars.githubusercontent.com/u/70697874?v=4","gravatar_id":"","url":"https://api.github.com/users/aksuns96","html_url":"https://github.com/aksuns96","followers_url":"https://api.github.com/users/aksuns96/followers","following_url":"https://api.github.com/users/aksuns96/following{/other_user}","gists_url":"https://api.github.com/users/aksuns96/gists{/gist_id}","starred_url":"https://api.github.com/users/aksuns96/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aksuns96/subscriptions","organizations_url":"https://api.github.com/users/aksuns96/orgs","repos_url":"https://api.github.com/users/aksuns96/repos","events_url":"https://api.github.com/users/aksuns96/events{/privacy}","received_events_url":"https://api.github.com/users/aksuns96/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2022-05-23T10:08:46Z","updated_at":"2022-05-23T14:12:33Z","closed_at":"2022-05-23T14:09:42Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/19695","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19695","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/19695.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/19695.patch","merged_at":"2022-05-23T14:09:42Z"},"body":"Signed-off-by: Serhat Aksun <serhat.aksun@maxwell-innovations.com>\r\n\r\n## Describe problem solved by this pull request\r\nIn VehicleMagnetometer, multi mode for magnetometers are enabled when sens_mag_mode parameter is set to 1 which is not correct.\r\n\r\n## Describe your solution\r\nmulti mode for magnetometers are enabled when sens_mag_mode parameter is set to 0. This pr fixes the multi_mode check in VehicleMagnetometer\r\n\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19695/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19695/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19690","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19690/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19690/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19690/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19690","id":1243843668,"node_id":"PR_kwDOAFDaZs44OiEL","number":19690,"title":"scripts: Hotfix px_uploader.py to avoid PX4BL bug","user":{"login":"amikhalev","id":4969631,"node_id":"MDQ6VXNlcjQ5Njk2MzE=","avatar_url":"https://avatars.githubusercontent.com/u/4969631?v=4","gravatar_id":"","url":"https://api.github.com/users/amikhalev","html_url":"https://github.com/amikhalev","followers_url":"https://api.github.com/users/amikhalev/followers","following_url":"https://api.github.com/users/amikhalev/following{/other_user}","gists_url":"https://api.github.com/users/amikhalev/gists{/gist_id}","starred_url":"https://api.github.com/users/amikhalev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amikhalev/subscriptions","organizations_url":"https://api.github.com/users/amikhalev/orgs","repos_url":"https://api.github.com/users/amikhalev/repos","events_url":"https://api.github.com/users/amikhalev/events{/privacy}","received_events_url":"https://api.github.com/users/amikhalev/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":10,"created_at":"2022-05-21T02:38:11Z","updated_at":"2022-05-27T18:26:27Z","closed_at":"2022-05-27T18:26:26Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/19690","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19690","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/19690.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/19690.patch","merged_at":null},"body":"## Describe problem solved by this pull request\r\nWe were experiencing a this hardfault while opening mavlink shell\r\n```\r\n[hardfault_log] -- 2022-05-19-22:12:56 Begin Fault Log --                                                            \r\nSystem fault Occurred on: 2022-05-19-22:12:56                                                                        \r\n Type:Hard Fault in file:armv7-m/up_hardfault.c at line: 148 running task: mavlink_rcv_if2                           \r\n FW git-hash: b188bcb465002613d3a45a7cc1a3a6aff8f62ae0                                                               \r\n Build datetime: May 18 2022 19:59:10                                                                                \r\n Build url: localhost                                                                                                \r\n Processor registers: from 0x30012314                                                                                \r\n r0:0xffffffff r1:0x2400101c  r2:0x30011a90  r3:0x2400585c  r4:0xffffffff  r5:0x24001020 r6:0x30011a90 r7:0x00000002 \r\n r8:0x30012750 r9:0x00000021 r10:0x00000000 r11:0x00000000 r12:0x0000000a  sp:0x300123e8 lr:0x08023633 pc:0x08024608 \r\n xpsr:0x01000000 basepri:0x00000080 control:0x00000004                                                               \r\n exe return:0xffffffe9                                                                                                                                           \r\n```\r\nThe call stack matched what @LorenzMeier found in #17063.\r\nIt appeared with a single-line change in a completely unrelated file.\r\n\r\nThis is caused by the semaphore `g_pipesem` being initialized to invalid data (all 1s) when copied from flash to sram.\r\n\r\nHere are the last few bytes of the firmware .bin file.  `g_pipesem` is at `0x19ada4`.\r\n```\r\n0019ad80  00 00 00 00 00 00 00 00  00 00 00 00 01 00 00 00  |................|\r\n0019ad90  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\r\n0019ada0  ff ff 01 00 01 00 00 00  00 00 00 00 00 00 00 00  |................|\r\n0019adb0  00 00 00 00 00 00 00 00  ff                       |.........|\r\n```\r\nHere what is actually on the device immediately after flashing in BL and before jumping to application (addresses are offset by `0x08020000` from what is above)\r\n```\r\n(gdb) x/32wx 0x81bad80\r\n0x81bad80:      0x00000000      0x00000000      0x00000000      0x00000001\r\n0x81bad90:      0x00000000      0x00000000      0x00000000      0x00000000\r\n0x81bada0:      0xffffffff      0xffffffff      0xffffffff      0xffffffff\r\n0x81badb0:      0xffffffff      0xffffffff      0xffffffff      0xffffffff\r\n```\r\n\r\nThe data gets written to the [flash cache](https://github.com/PX4/PX4-Autopilot/blob/422be90140c9dee6f0e59ee4d181301b13fb11de/platforms/nuttx/src/bootloader/common/lib/flash_cache.c), but if it does not fill up the flash block, then it never actually writes the data. The [read-back verify](https://github.com/PX4/PX4-Autopilot/blob/422be90140c9dee6f0e59ee4d181301b13fb11de/platforms/nuttx/src/bootloader/common/bl.c#L838-L839) does not catch this because it only reads from the cache.\r\n\r\nThe specific hardfault occurs only happens when `g_pipesem` is placed at the end of the firmware image and the length of the image. In theory any variable in `.data` could be incorrectly initialized, and the behavior widely varies with small changes to the source code.\r\n\r\nThe flash cache was originally only required on STM32H7, but since [this commit](https://github.com/PX4/PX4-Autopilot/commit/64d264b49a072e29044fc6132113de41698152ec) (v1.12) it is used for the bootloader on all platforms. I suspect this is the root cause of #17065 and #19308.\r\n\r\n## Describe your solution\r\nPad the firmware image in `px_uploader.py` up to a flash cache block so all data will be written.\r\n\r\n## Describe possible alternatives\r\nIt would be better to fix the cache implementation in the bootloader, but this fix is easy and works with all current bootloaders.\r\n\r\n## Test data / coverage\r\nBench test shows that the same firmware binary is correctly written and does not hardfault with this change.\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19690/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19690/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19685","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19685/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19685/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19685/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19685","id":1242925599,"node_id":"PR_kwDOAFDaZs44LdtL","number":19685,"title":"HITL: undefined time_remaining_s should be NAN","user":{"login":"NicolasM0","id":59083163,"node_id":"MDQ6VXNlcjU5MDgzMTYz","avatar_url":"https://avatars.githubusercontent.com/u/59083163?v=4","gravatar_id":"","url":"https://api.github.com/users/NicolasM0","html_url":"https://github.com/NicolasM0","followers_url":"https://api.github.com/users/NicolasM0/followers","following_url":"https://api.github.com/users/NicolasM0/following{/other_user}","gists_url":"https://api.github.com/users/NicolasM0/gists{/gist_id}","starred_url":"https://api.github.com/users/NicolasM0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/NicolasM0/subscriptions","organizations_url":"https://api.github.com/users/NicolasM0/orgs","repos_url":"https://api.github.com/users/NicolasM0/repos","events_url":"https://api.github.com/users/NicolasM0/events{/privacy}","received_events_url":"https://api.github.com/users/NicolasM0/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2022-05-20T10:08:47Z","updated_at":"2022-05-23T12:53:51Z","closed_at":"2022-05-20T13:38:44Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/19685","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19685","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/19685.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/19685.patch","merged_at":"2022-05-20T13:38:44Z"},"body":"**Describe problem solved by this pull request**\r\nHITL publishes a null battery remaining time that triggers a return right after takeoff.\r\n\r\n**Describe your solution**\r\nThe remaining time from mavlink HIL SENSOR messages is set to NAN instead of 0\r\n\r\n**Additional context**\r\nLinked issue seen here : https://github.com/PX4/PX4-Autopilot/issues/19667\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19685/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19685/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19680","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19680/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19680/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19680/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19680","id":1241907713,"node_id":"PR_kwDOAFDaZs44IJHx","number":19680,"title":"commander: handle RC loss timeout if manual_control_setpoint stops publishing","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":803319897,"node_id":"MDU6TGFiZWw4MDMzMTk4OTc=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/cleanup%20(housekeeping)%20%F0%9F%A7%B9","name":"cleanup (housekeeping) 🧹","color":"aefcbd","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2022-05-19T14:50:25Z","updated_at":"2022-05-20T23:37:31Z","closed_at":"2022-05-20T23:37:30Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/19680","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19680","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/19680.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/19680.patch","merged_at":"2022-05-20T23:37:30Z"},"body":"If the `manual_control` module stops publishing for whatever reason we still need to catch the timeout in commander to handle the loss of manual control.","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19680/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19680/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19672","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19672/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19672/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19672/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19672","id":1240251092,"node_id":"PR_kwDOAFDaZs44CqM0","number":19672,"title":"[WIP] NuttX sem holder fixes","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":174161208,"node_id":"MDU6TGFiZWwxNzQxNjEyMDg=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/priority-critical","name":"priority-critical","color":"e11d21","default":false,"description":null},{"id":581805812,"node_id":"MDU6TGFiZWw1ODE4MDU4MTI=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/NuttX%20(OS)","name":"NuttX (OS)","color":"3C33E3","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-05-18T17:11:15Z","updated_at":"2022-05-29T16:53:01Z","closed_at":"2022-05-29T16:53:01Z","author_association":"MEMBER","active_lock_reason":null,"draft":true,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/19672","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19672","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/19672.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/19672.patch","merged_at":null},"body":"Requires\r\n - https://github.com/PX4/NuttX/pull/184\r\n - https://github.com/PX4/NuttX-apps/pull/15\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19672/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19672/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19667","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19667/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19667/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19667/events","html_url":"https://github.com/PX4/PX4-Autopilot/issues/19667","id":1239081518,"node_id":"I_kwDOAFDaZs5J2uIu","number":19667,"title":"Preflight Fail in HITL with v1.13.0","user":{"login":"Katawann","id":23118386,"node_id":"MDQ6VXNlcjIzMTE4Mzg2","avatar_url":"https://avatars.githubusercontent.com/u/23118386?v=4","gravatar_id":"","url":"https://api.github.com/users/Katawann","html_url":"https://github.com/Katawann","followers_url":"https://api.github.com/users/Katawann/followers","following_url":"https://api.github.com/users/Katawann/following{/other_user}","gists_url":"https://api.github.com/users/Katawann/gists{/gist_id}","starred_url":"https://api.github.com/users/Katawann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Katawann/subscriptions","organizations_url":"https://api.github.com/users/Katawann/orgs","repos_url":"https://api.github.com/users/Katawann/repos","events_url":"https://api.github.com/users/Katawann/events{/privacy}","received_events_url":"https://api.github.com/users/Katawann/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":552258139,"node_id":"MDU6TGFiZWw1NTIyNTgxMzk=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/hitl","name":"hitl","color":"d4c5f9","default":false,"description":"hardware in the loop simulation"}],"state":"closed","locked":false,"assignee":{"login":"julianoes","id":1419688,"node_id":"MDQ6VXNlcjE0MTk2ODg=","avatar_url":"https://avatars.githubusercontent.com/u/1419688?v=4","gravatar_id":"","url":"https://api.github.com/users/julianoes","html_url":"https://github.com/julianoes","followers_url":"https://api.github.com/users/julianoes/followers","following_url":"https://api.github.com/users/julianoes/following{/other_user}","gists_url":"https://api.github.com/users/julianoes/gists{/gist_id}","starred_url":"https://api.github.com/users/julianoes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/julianoes/subscriptions","organizations_url":"https://api.github.com/users/julianoes/orgs","repos_url":"https://api.github.com/users/julianoes/repos","events_url":"https://api.github.com/users/julianoes/events{/privacy}","received_events_url":"https://api.github.com/users/julianoes/received_events","type":"User","site_admin":false},"assignees":[{"login":"julianoes","id":1419688,"node_id":"MDQ6VXNlcjE0MTk2ODg=","avatar_url":"https://avatars.githubusercontent.com/u/1419688?v=4","gravatar_id":"","url":"https://api.github.com/users/julianoes","html_url":"https://github.com/julianoes","followers_url":"https://api.github.com/users/julianoes/followers","following_url":"https://api.github.com/users/julianoes/following{/other_user}","gists_url":"https://api.github.com/users/julianoes/gists{/gist_id}","starred_url":"https://api.github.com/users/julianoes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/julianoes/subscriptions","organizations_url":"https://api.github.com/users/julianoes/orgs","repos_url":"https://api.github.com/users/julianoes/repos","events_url":"https://api.github.com/users/julianoes/events{/privacy}","received_events_url":"https://api.github.com/users/julianoes/received_events","type":"User","site_admin":false}],"milestone":null,"comments":8,"created_at":"2022-05-17T19:42:34Z","updated_at":"2022-05-23T04:51:46Z","closed_at":"2022-05-21T21:53:20Z","author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug**\r\nWhen I run PX4 v1.13.0-beta on Pixhawk 4 in HITL with jmavsim, it fails to arm because of `Preflight Fail` (compass, accel, gyro and baro). I tried with 3  different Pixhawk 4 but the issue is always the same\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Follow the [steps](https://docs.px4.io/v1.12/en/simulation/hitl.html) to have PX4 in HITL mode\r\n2. It fails with:\r\n```\r\n$ ./Tools/jmavsim_run.sh -q -s -d /dev/ttyACM0 -b 921600 -r 250\r\nBuildfile: /home/PX4-Autopilot/Tools/jMAVSim/build.xml\r\n\r\nmake_dirs:\r\n\r\ncompile:\r\n\r\ncreate_run_jar:\r\n\r\ncopy_res:\r\n\r\nBUILD SUCCESSFUL\r\nTotal time: 0 seconds\r\nOptions parsed, starting Sim.\r\nStarting GUI...\r\nWARNING: An illegal reflective access operation has occurred\r\nWARNING: Illegal reflective access by javax.media.j3d.JoglPipeline (rsrc:j3dcore.jar) to method sun.awt.AppContext.getAppContext()\r\nWARNING: Please consider reporting this to the maintainers of javax.media.j3d.JoglPipeline\r\nWARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations\r\nWARNING: All illegal access operations will be denied in a future release\r\nMSG: Preflight Fail: Compass Sensor 0 missing\r\nMSG: Preflight Fail: Accel Sensor 0 missing\r\nMSG: Preflight Fail: Gyro Sensor 0 missing\r\nMSG: Preflight Fail: Baro Sensor 0 missing\r\nInit MAVLink\r\nMSG: Failsafe mode deactivated\t\r\nMSG: Arming denied! Flight termination active\r\n```\r\n\r\n**Expected behavior**\r\nSensors should not be failing as we are do a simulation through jMAVSim\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19667/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19667/timeline","performed_via_github_app":null,"state_reason":"completed"},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19665","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19665/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19665/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19665/events","html_url":"https://github.com/PX4/PX4-Autopilot/issues/19665","id":1238924870,"node_id":"I_kwDOAFDaZs5J2H5G","number":19665,"title":"Tx queue overflow with HITL in Gazebo 11 and Pixhawk 4","user":{"login":"Katawann","id":23118386,"node_id":"MDQ6VXNlcjIzMTE4Mzg2","avatar_url":"https://avatars.githubusercontent.com/u/23118386?v=4","gravatar_id":"","url":"https://api.github.com/users/Katawann","html_url":"https://github.com/Katawann","followers_url":"https://api.github.com/users/Katawann/followers","following_url":"https://api.github.com/users/Katawann/following{/other_user}","gists_url":"https://api.github.com/users/Katawann/gists{/gist_id}","starred_url":"https://api.github.com/users/Katawann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Katawann/subscriptions","organizations_url":"https://api.github.com/users/Katawann/orgs","repos_url":"https://api.github.com/users/Katawann/repos","events_url":"https://api.github.com/users/Katawann/events{/privacy}","received_events_url":"https://api.github.com/users/Katawann/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":552258139,"node_id":"MDU6TGFiZWw1NTIyNTgxMzk=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/hitl","name":"hitl","color":"d4c5f9","default":false,"description":"hardware in the loop simulation"},{"id":663879765,"node_id":"MDU6TGFiZWw2NjM4Nzk3NjU=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/gazebo%20classic","name":"gazebo classic","color":"EE7F04","default":false,"description":"Gazebo classic simulator"}],"state":"closed","locked":false,"assignee":{"login":"julianoes","id":1419688,"node_id":"MDQ6VXNlcjE0MTk2ODg=","avatar_url":"https://avatars.githubusercontent.com/u/1419688?v=4","gravatar_id":"","url":"https://api.github.com/users/julianoes","html_url":"https://github.com/julianoes","followers_url":"https://api.github.com/users/julianoes/followers","following_url":"https://api.github.com/users/julianoes/following{/other_user}","gists_url":"https://api.github.com/users/julianoes/gists{/gist_id}","starred_url":"https://api.github.com/users/julianoes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/julianoes/subscriptions","organizations_url":"https://api.github.com/users/julianoes/orgs","repos_url":"https://api.github.com/users/julianoes/repos","events_url":"https://api.github.com/users/julianoes/events{/privacy}","received_events_url":"https://api.github.com/users/julianoes/received_events","type":"User","site_admin":false},"assignees":[{"login":"julianoes","id":1419688,"node_id":"MDQ6VXNlcjE0MTk2ODg=","avatar_url":"https://avatars.githubusercontent.com/u/1419688?v=4","gravatar_id":"","url":"https://api.github.com/users/julianoes","html_url":"https://github.com/julianoes","followers_url":"https://api.github.com/users/julianoes/followers","following_url":"https://api.github.com/users/julianoes/following{/other_user}","gists_url":"https://api.github.com/users/julianoes/gists{/gist_id}","starred_url":"https://api.github.com/users/julianoes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/julianoes/subscriptions","organizations_url":"https://api.github.com/users/julianoes/orgs","repos_url":"https://api.github.com/users/julianoes/repos","events_url":"https://api.github.com/users/julianoes/events{/privacy}","received_events_url":"https://api.github.com/users/julianoes/received_events","type":"User","site_admin":false}],"milestone":null,"comments":18,"created_at":"2022-05-17T17:01:18Z","updated_at":"2023-12-13T07:26:22Z","closed_at":"2022-05-21T01:00:34Z","author_association":"NONE","active_lock_reason":null,"body":"**Describe the bug**\r\nWhen I run HITL with Pixhawk 4, Gazebo 11 and PX4 v1.13.0-beta1 (or master), the simulation failed to `Tx queue overflow` after it connects to the USB port. \r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Plug the Pixhawk 4 with PX4 v1.13.0-beta1 and HITL airframe config to USB port \r\n2. Wait the Pixhawk 4 to boot\r\n3. Run the command `gzserver --verbose Tools/sitl_gazebo/worlds/hitl_iris.world`\r\n4. See error:\r\n```\r\ngzserver --verbose Tools/sitl_gazebo/worlds/hitl_iris.world\r\nGazebo multi-robot simulator, version 11.10.2\r\nCopyright (C) 2012 Open Source Robotics Foundation.\r\nReleased under the Apache 2 License.\r\nhttp://gazebosim.org\r\n\r\n[Msg] Waiting for master.\r\n[Msg] Connected to gazebo master @ http://127.0.0.1:11345\r\n[Msg] Publicized address: 192.168.1.235\r\n[Msg] Loading world file [/home/PX4-Autopilot/Tools/sitl_gazebo/worlds/hitl_iris.world]\r\n[Wrn] [gazebo_gps_plugin.cpp:78] [gazebo_gps_plugin]: iris::gps0 using gps topic \"gps0\"\r\n[Wrn] [gazebo_gps_plugin.cpp:203] [gazebo_gps_plugin] Using default update rate of 5hz \r\n[Msg] Connecting to PX4 SITL using serial\r\n[Msg] Lockstep is disabled\r\n[Msg] Using MAVLink protocol v2.0\r\nOpened serial device /dev/ttyACM0\r\nTx queue overflow\r\nTx queue overflow\r\nTx queue overflow\r\n...\r\n```\r\n\r\n**Expected behavior**\r\nGazebo should not go to this `Tx queue overflow` and we should see the drone in QGC through UDP\r\n\r\n**Additional context**\r\nI tried also with master branch, with new install of Ubuntu 20.04, with new Pixhawk 4 but I always get this same error. With v1.12.3 it works fine with Gazebo. Also with v1.13.0-beta1 or master HITL works fine with jmavsim so I guess the issue comes from Gazebo","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19665/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19665/timeline","performed_via_github_app":null,"state_reason":"completed"},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19656","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19656/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19656/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19656/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19656","id":1235258122,"node_id":"PR_kwDOAFDaZs43yVql","number":19656,"title":"navigator: mission_block relax yaw acceptance if heading not good for control","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2022-05-13T13:39:19Z","updated_at":"2022-06-01T17:42:44Z","closed_at":"2022-06-01T17:42:44Z","author_association":"MEMBER","active_lock_reason":null,"draft":true,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/19656","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19656","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/19656.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/19656.patch","merged_at":null},"body":"This is a good example of a problem that probably wouldn't have existed in the first place if the auto mission flight mode was largely consolidated into a single flight task. ","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19656/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19656/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19655","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19655/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19655/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19655/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19655","id":1235231212,"node_id":"PR_kwDOAFDaZs43yP4c","number":19655,"title":"airspeed_selector_main: plug in numbers in switch event message","user":{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":655645519,"node_id":"MDU6TGFiZWw2NTU2NDU1MTk=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/question","name":"question","color":"d93f0b","default":true,"description":null}],"state":"closed","locked":false,"assignee":{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false},"assignees":[{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false}],"milestone":null,"comments":0,"created_at":"2022-05-13T13:16:06Z","updated_at":"2022-05-16T12:17:55Z","closed_at":"2022-05-16T12:17:52Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/19655","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19655","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/19655.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/19655.patch","merged_at":null},"body":"**Describe problem solved by this pull request**\r\nI was checking on an example on how to send numbers in an event and found that the numbers in the airspeed selector are not plugged into the message. Is this just not necessary, they get appended to the message anyways and I'm being extra verbose here? Or was this just forgotten? I'm also not sure how they would be appended e.g. without space between them and so on?\r\n\r\n**Describe your solution**\r\nI'm plugging in the numbers like it's done in the legacy `mavlink_log_info()` message just above.\r\n\r\n**Test data / coverage**\r\nI did not test this. Just changed according to my observation of how it works.","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19655/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19655/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19650","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19650/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19650/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19650/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19650","id":1234195891,"node_id":"PR_kwDOAFDaZs43u0Qx","number":19650,"title":"Make power off tune uninterruptable","user":{"login":"junwoo091400","id":23277211,"node_id":"MDQ6VXNlcjIzMjc3MjEx","avatar_url":"https://avatars.githubusercontent.com/u/23277211?v=4","gravatar_id":"","url":"https://api.github.com/users/junwoo091400","html_url":"https://github.com/junwoo091400","followers_url":"https://api.github.com/users/junwoo091400/followers","following_url":"https://api.github.com/users/junwoo091400/following{/other_user}","gists_url":"https://api.github.com/users/junwoo091400/gists{/gist_id}","starred_url":"https://api.github.com/users/junwoo091400/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/junwoo091400/subscriptions","organizations_url":"https://api.github.com/users/junwoo091400/orgs","repos_url":"https://api.github.com/users/junwoo091400/repos","events_url":"https://api.github.com/users/junwoo091400/events{/privacy}","received_events_url":"https://api.github.com/users/junwoo091400/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2022-05-12T16:01:12Z","updated_at":"2022-07-08T12:51:18Z","closed_at":"2022-07-08T12:51:15Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/19650","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19650","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/19650.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/19650.patch","merged_at":"2022-07-08T12:51:15Z"},"body":"**Describe problem solved by this pull request**\r\nCurrently when you have a low battery warning, pressing down the power button (e.g. on ATL Mantis Edu) doesn't play the power-off tune, because it gets overridden by the low battery warning tune request published by the Commander\r\n1. Commander was sending the \"low battery warning\" tune request on every single loop, thus filling up the uORB queue of the `tune_control` message.\r\n\r\n**Describe your solution**\r\n1. Fix the commander's `set_tune` function to only allow transmitting the tune_control uORB message request for a tune only after it has finished playing, so that it wouldn't fill up the queue excessively\r\n2. Allow 'override' when requesting the Power button down tune in Commander\r\n\r\n**Describe possible alternatives**\r\nI think that a 'priority' should exist that allows override on certain tones over others, etc.\r\n\r\nOr, the `Tunes` library that all the module / drivers actually playing the tune should integrate this prioritization in a smarter level, so that an already-playing tune wouldn't get overridden in cases like this. :thinking: \r\n\r\n## Discussion\r\nI think that having this knowledge of \"tune duration\" in the `commander_helper` level, and limiting the rate of sending out the `tune_control` message with it's own logic is quite weird.\r\n\r\nBut since it's all connected to the uORB, it's quite tricky to liimit it's rate of publishing without the knowledge of the tune duration as well :shrug:\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19650/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19650/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19646","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19646/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19646/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19646/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19646","id":1233687223,"node_id":"PR_kwDOAFDaZs43tHLB","number":19646,"title":"output drivers: init SmartLock after exit_and_cleanup","user":{"login":"bkueng","id":281593,"node_id":"MDQ6VXNlcjI4MTU5Mw==","avatar_url":"https://avatars.githubusercontent.com/u/281593?v=4","gravatar_id":"","url":"https://api.github.com/users/bkueng","html_url":"https://github.com/bkueng","followers_url":"https://api.github.com/users/bkueng/followers","following_url":"https://api.github.com/users/bkueng/following{/other_user}","gists_url":"https://api.github.com/users/bkueng/gists{/gist_id}","starred_url":"https://api.github.com/users/bkueng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bkueng/subscriptions","organizations_url":"https://api.github.com/users/bkueng/orgs","repos_url":"https://api.github.com/users/bkueng/repos","events_url":"https://api.github.com/users/bkueng/events{/privacy}","received_events_url":"https://api.github.com/users/bkueng/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-05-12T09:06:30Z","updated_at":"2022-05-12T12:16:37Z","closed_at":"2022-05-12T12:16:36Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/19646","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19646","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/19646.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/19646.patch","merged_at":"2022-05-12T12:16:36Z"},"body":"This fixes an invalid memory access (regression from https://github.com/PX4/PX4-Autopilot/pull/19490) when exiting the module:\r\nexit_and_cleanup destroys the object, but lock_guard is destructed after and accesses the lock.","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19646/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19646/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19642","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19642/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19642/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19642/events","html_url":"https://github.com/PX4/PX4-Autopilot/issues/19642","id":1233247718,"node_id":"I_kwDOAFDaZs5Jgd3m","number":19642,"title":"v1.13.0-beta1 UAVCAN Battery Can't Take Off Due to RTL Time Estimate","user":{"login":"AlexKlimaj","id":2019539,"node_id":"MDQ6VXNlcjIwMTk1Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/2019539?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexKlimaj","html_url":"https://github.com/AlexKlimaj","followers_url":"https://api.github.com/users/AlexKlimaj/followers","following_url":"https://api.github.com/users/AlexKlimaj/following{/other_user}","gists_url":"https://api.github.com/users/AlexKlimaj/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexKlimaj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexKlimaj/subscriptions","organizations_url":"https://api.github.com/users/AlexKlimaj/orgs","repos_url":"https://api.github.com/users/AlexKlimaj/repos","events_url":"https://api.github.com/users/AlexKlimaj/events{/privacy}","received_events_url":"https://api.github.com/users/AlexKlimaj/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"assignees":[{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false}],"milestone":null,"comments":1,"created_at":"2022-05-11T22:35:49Z","updated_at":"2022-05-12T19:44:26Z","closed_at":"2022-05-12T17:08:15Z","author_association":"MEMBER","active_lock_reason":null,"body":"I am unable to take off on v1.13.0-beta1 using a uavcan battery in any mode. As soon as I start throttling up, it throws a \"Remaining flight time low, returning to land\" error and switches into RTL.\r\n\r\nhttps://review.px4.io/plot_app?log=761b3a20-94ae-43d9-aba3-1205751f58ce\r\nhttps://review.px4.io/plot_app?log=25386252-9972-4f8f-bac0-716c54559f68\r\n\r\nBeta on a different non uavcan battery drone. ARK GPS + ARK Flow flies well.\r\nhttps://review.px4.io/plot_app?log=3618593a-4485-4606-9236-2316af742a07\r\n\r\nComparing the two, in the failure case, the RTL Time Estimate values are very low, below 100. But in the working case, the values are in the 1000000's.","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19642/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19642/timeline","performed_via_github_app":null,"state_reason":"completed"},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19601","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19601/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19601/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19601/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19601","id":1227732830,"node_id":"PR_kwDOAFDaZs43aJks","number":19601,"title":"uavcan: use timer 6 for boards where timer 5 is used for peripherals","user":{"login":"Igor-Misic","id":10188706,"node_id":"MDQ6VXNlcjEwMTg4NzA2","avatar_url":"https://avatars.githubusercontent.com/u/10188706?v=4","gravatar_id":"","url":"https://api.github.com/users/Igor-Misic","html_url":"https://github.com/Igor-Misic","followers_url":"https://api.github.com/users/Igor-Misic/followers","following_url":"https://api.github.com/users/Igor-Misic/following{/other_user}","gists_url":"https://api.github.com/users/Igor-Misic/gists{/gist_id}","starred_url":"https://api.github.com/users/Igor-Misic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Igor-Misic/subscriptions","organizations_url":"https://api.github.com/users/Igor-Misic/orgs","repos_url":"https://api.github.com/users/Igor-Misic/repos","events_url":"https://api.github.com/users/Igor-Misic/events{/privacy}","received_events_url":"https://api.github.com/users/Igor-Misic/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2022-05-06T11:16:29Z","updated_at":"2022-05-06T23:45:54Z","closed_at":"2022-05-06T23:45:53Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/19601","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19601","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/19601.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/19601.patch","merged_at":"2022-05-06T23:45:53Z"},"body":"**Describe problem solved by this pull request**\r\nUAVCAN has dedicated timer 5 for STM32 MCUs. Some boards are using Timer 5 for peripherals and this causes conflicts.\r\n\r\nSymptoms:\r\nUAVCAN stops working if param `USE_SYS_IO` is set to 0. \r\n\r\nAffected boards:\r\ncuav_nora\r\ncuav_x7pro\r\nholybro_kakutef7\r\nholybro_pix32v5\r\nmatek_h743-slim\r\nmodalai_fc-v2\r\npx4_fmu-v5\r\npx4_fmu-v5x\r\npx4_fmu-v6x\r\nspracing_h7extreme\r\n\r\n**Describe your solution**\r\nUAVCAN Timer 5 changed to Timer 6 which is free for all STM32 boards. \r\n\r\n**Describe possible alternatives**\r\nUAVCAN driver can be adapted to use the PX4 High-resolution timer (HRT). \r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19601/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19601/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19594","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19594/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19594/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19594/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19594","id":1226850284,"node_id":"PR_kwDOAFDaZs43XRLK","number":19594,"title":"Commander: ensure diconnected battery is cleared from bit field","user":{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false},"assignees":[{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false}],"milestone":null,"comments":2,"created_at":"2022-05-05T15:39:54Z","updated_at":"2022-06-07T13:46:42Z","closed_at":"2022-05-06T14:32:28Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/19594","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19594","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/19594.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/19594.patch","merged_at":"2022-05-06T14:32:27Z"},"body":"**Describe problem solved by this pull request**\r\nUpon battery disconnect, the error message is spammed instead of only being sent once like it was intended.\r\n![Screenshot from 2022-05-05 10-14-37](https://user-images.githubusercontent.com/4668506/166959992-e75d2ca4-a786-403b-8d13-b744cce95ad3.png)\r\nReported by @dagar over Slack.\r\nFYI @cmic0 \r\n\r\n**Describe your solution**\r\nMake sure the corresponding bit for the battery in the bit field `_last_connected_batteries` is updated when the battery gets disconnected and not just when it's connected.\r\n\r\nBug must have been introduced here: https://github.com/PX4/PX4-Autopilot/pull/18919/files#diff-e4b611e75eba3844661619867ee06befbcf230aced354a14f167f7d0ebbca8e0R3783\r\n\r\n**Describe possible alternatives**\r\nI could do a bitfield class that does this such that set/reset don't have to be repeated everywhere.\r\n\r\n**Test data / coverage**\r\nUntested, issue was found in code inspection after the report. Please review.","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19594/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19594/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19589","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19589/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19589/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19589/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19589","id":1226476414,"node_id":"PR_kwDOAFDaZs43WCJs","number":19589,"title":"fw pos ctrl: fix state switching logic for takeoff and landing","user":{"login":"tstastny","id":8026163,"node_id":"MDQ6VXNlcjgwMjYxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8026163?v=4","gravatar_id":"","url":"https://api.github.com/users/tstastny","html_url":"https://github.com/tstastny","followers_url":"https://api.github.com/users/tstastny/followers","following_url":"https://api.github.com/users/tstastny/following{/other_user}","gists_url":"https://api.github.com/users/tstastny/gists{/gist_id}","starred_url":"https://api.github.com/users/tstastny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tstastny/subscriptions","organizations_url":"https://api.github.com/users/tstastny/orgs","repos_url":"https://api.github.com/users/tstastny/repos","events_url":"https://api.github.com/users/tstastny/events{/privacy}","received_events_url":"https://api.github.com/users/tstastny/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":78699916,"node_id":"MDU6TGFiZWw3ODY5OTkxNg==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Fixed%20Wing%20%F0%9F%9B%A9%EF%B8%8F","name":"Fixed Wing 🛩️","color":"009800","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"tstastny","id":8026163,"node_id":"MDQ6VXNlcjgwMjYxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8026163?v=4","gravatar_id":"","url":"https://api.github.com/users/tstastny","html_url":"https://github.com/tstastny","followers_url":"https://api.github.com/users/tstastny/followers","following_url":"https://api.github.com/users/tstastny/following{/other_user}","gists_url":"https://api.github.com/users/tstastny/gists{/gist_id}","starred_url":"https://api.github.com/users/tstastny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tstastny/subscriptions","organizations_url":"https://api.github.com/users/tstastny/orgs","repos_url":"https://api.github.com/users/tstastny/repos","events_url":"https://api.github.com/users/tstastny/events{/privacy}","received_events_url":"https://api.github.com/users/tstastny/received_events","type":"User","site_admin":false},"assignees":[{"login":"tstastny","id":8026163,"node_id":"MDQ6VXNlcjgwMjYxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8026163?v=4","gravatar_id":"","url":"https://api.github.com/users/tstastny","html_url":"https://github.com/tstastny","followers_url":"https://api.github.com/users/tstastny/followers","following_url":"https://api.github.com/users/tstastny/following{/other_user}","gists_url":"https://api.github.com/users/tstastny/gists{/gist_id}","starred_url":"https://api.github.com/users/tstastny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tstastny/subscriptions","organizations_url":"https://api.github.com/users/tstastny/orgs","repos_url":"https://api.github.com/users/tstastny/repos","events_url":"https://api.github.com/users/tstastny/events{/privacy}","received_events_url":"https://api.github.com/users/tstastny/received_events","type":"User","site_admin":false}],"milestone":null,"comments":3,"created_at":"2022-05-05T10:15:03Z","updated_at":"2022-05-06T14:39:04Z","closed_at":"2022-05-06T14:36:03Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/19589","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19589","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/19589.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/19589.patch","merged_at":"2022-05-06T14:36:03Z"},"body":"**Describe problem solved by this pull request**\r\nTakeoff and landing modes were separated from the `control_auto()` umbrella in #19495 in an effort to start untangling the fixed-wing position control module before some more significant refactoring to come. However, some of the internal state resets  and position setpoint handling logic was not exactly translated in a way that reproduced the previous behavior. Sorry - I missed them as well in the PR review.\r\n\r\nExample: takeoff mode would be overridden from this logic:\r\nhttps://github.com/PX4/PX4-Autopilot/blob/14a2fdfe551435638e22864437e75030abbf28eb/src/modules/fw_pos_control_l1/FixedwingPositionControl.cpp#L760-L766\r\n\r\nAnd some TECS states and other attitude integral resets were not initialized in takeoff and landing modes as they were before. \r\n\r\n**Describe your solution**\r\nThis PR is a hotfix to revive the same behavior the module had prior to #19495, while keeping the takeoff and landing modes separated. There are more fundamental issues that need work in this module.. e.g. `in_takeoff_situation()` is a quite egregious one IMHO. But these can be saved for a subsequent discussion and PR. \r\n\r\n**Test data / coverage**\r\nTested that the basic functionality operates as it did before. E.g. making sure the takeoff mode is not exited until navigator sees the mission item reached, loiter down to waypoints work (the position setpoint switching), flying back to takeoff waypoints later in a mission does not re-enter takeoff logic, etc.\r\n\r\nhttps://user-images.githubusercontent.com/8026163/166902577-a16f9fea-6010-46be-a9c2-f1b3434d9a48.mp4\r\n\r\nNote the takeoff behavior is actually kind of terrible (no loiter up to takeoff point when below the takeoff point altitude) - but this has been the behavior for some time now. I'm working on a larger refactor of takeoff and landing for fixed-wing which will simplify these modes and also allow for a more general discussion on what takeoff actually *should* look like. But for now.. this PR is just to make sure the next release has the behavior that's been expected.\r\n\r\n@sfuhrer would be great if you could check that I did not mess up any VTOL functionality.\r\n@dagar if the current release branch has #19495 in it .. we would probably need to include this PR as well to make sure the logic isnt broken on the release.\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19589/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19589/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19583","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19583/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19583/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19583/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19583","id":1225415288,"node_id":"PR_kwDOAFDaZs43SwGk","number":19583,"title":"Fixed rm3100 self-test bug","user":{"login":"bmeagher","id":7788917,"node_id":"MDQ6VXNlcjc3ODg5MTc=","avatar_url":"https://avatars.githubusercontent.com/u/7788917?v=4","gravatar_id":"","url":"https://api.github.com/users/bmeagher","html_url":"https://github.com/bmeagher","followers_url":"https://api.github.com/users/bmeagher/followers","following_url":"https://api.github.com/users/bmeagher/following{/other_user}","gists_url":"https://api.github.com/users/bmeagher/gists{/gist_id}","starred_url":"https://api.github.com/users/bmeagher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bmeagher/subscriptions","organizations_url":"https://api.github.com/users/bmeagher/orgs","repos_url":"https://api.github.com/users/bmeagher/repos","events_url":"https://api.github.com/users/bmeagher/events{/privacy}","received_events_url":"https://api.github.com/users/bmeagher/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2022-05-04T13:59:41Z","updated_at":"2022-07-14T13:44:00Z","closed_at":"2022-07-14T13:44:00Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/19583","html_url":"https://github.com/PX4/PX4-Autopilot/pull/19583","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/19583.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/19583.patch","merged_at":"2022-07-14T13:44:00Z"},"body":"**Describe problem solved by this pull request**\r\nThe latest changes to the rm3100 driver introduced a bug in self-test.  On fast processors, like the QRB5165, the rm3100 occasionally fails self-test due to incorrect registers configuration.  Further, failed devices return successful if any one of the oscillators passed BIST.  If any of the x, y, or z LR oscillators is malfunctioning then self-test should fail.\r\n\r\n**Describe your solution**\r\nFixed the bug according to the RM3100 datasheet.\r\n\r\n**Test data / coverage**\r\nThis was tested on multiple good RM3100 devices as well as a failed RM3100 (missing z coil).\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19583/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/19583/timeline","performed_via_github_app":null,"state_reason":null},