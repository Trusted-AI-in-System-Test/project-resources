[{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22574","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22574/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22574/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22574/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22574","id":2050463758,"node_id":"PR_kwDOAFDaZs5id2lw","number":22574,"title":"matrix: fix slice to slice assignment to do deep copy","user":{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":5535857183,"node_id":"LA_kwDOAFDaZs8AAAABSfZ6Hw","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/v1.14","name":"v1.14","color":"F9E2EB","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false},"assignees":[{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false}],"milestone":null,"comments":0,"created_at":"2023-12-20T12:33:26Z","updated_at":"2023-12-21T10:50:16Z","closed_at":"2023-12-21T10:42:08Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/22574","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22574","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/22574.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/22574.patch","merged_at":"2023-12-21T10:42:08Z"},"body":"### Solved Problem\r\n@bresch warned me about this bug report yesterday: #22565\r\nWe started debugging and were puzzled why the assignment of `a.xy() = b.xy()` with two `Vector3f`s did not call `Slice::operator=()` which implements a deep copy of the submatrix in b, in this case the first two elements.\r\n\r\n@jwidauer kindly spent some time analyzing the case. He found out by separating the steps and explicitly deleting constructors and the detailed output of clang that the autogenerated implicit default copy constructor of `Slice<Type, P, Q, M, N>` is the preferred template match over `Slice<Type, P, Q, M, N> &operator=(const Slice<Type, P, Q, MM, NN>)` when the original unsliced size of matrix `b` (`MM` and `NN`) exactly matches the size of matrix `a` (`M` and `N`). As a result the pointer in `a.x()` was replaced with a thin copy of `b.xy()` and none of the elements were copied to the original matrix `a`.\r\n\r\nFixes #22565\r\n\r\n### Solution\r\nExplicitly define `Slice<Type, P, Q, M, N> &operator=(const Slice<Type, P, Q, M, N>)` with exactly matching original sizes `M` and `N` and make it call the original deep copy implementation. The compiler then gives a warning if we don't also explicitly declare the default copy constructor without the assignment operator to do what it originally did.\r\n\r\n### Changelog Entry\r\n- [x] Evaluate the end-user effect and update the changelog entry\r\n```\r\nBugfix: Position lock fix for non-default MPC_POS_MODE 0 (Direct velocity stick mapping)\r\n```\r\n\r\n### Test coverage\r\nThe added test now does what it should.\r\n\r\n- [x] I'm evaluating what the effect is and verifying that things are working correctly compared to before. E.g. \r\n\r\nPosition lock in Position mode\r\nBefore:\r\n<img src=\"https://github.com/PX4/PX4-Autopilot/assets/4668506/70e816c3-f40e-4edf-8f58-a8207e642e30\" width=\"500\" />\r\n\r\nAfter:\r\n<img src=\"https://github.com/PX4/PX4-Autopilot/assets/4668506/f8b1ef06-ca3d-414c-b683-818a8ed8ea04\" width=\"500\" />\r\n\r\nFake position fusion:\r\nI have no idea how to verify this. @bresch could you have a quick look at the change indicator?\r\n\r\n### Context\r\nIn\r\nhttps://github.com/PX4/PX4-Autopilot/pull/20440/files#diff-6a93912921c62df6bced857c3dea68c3c275d25faa3f6c78866eafedc4e5612fR113\r\nand\r\nhttps://github.com/PX4/PX4-Autopilot/pull/20021/files#diff-61244855f5e70ce3cf45228c9915530a01583ea7906fb25b93547c8ff839ad74R513\r\nwe started using assignments of a slice to a slice `a.xy() = b.xy()` with two `Vector3f`s. We expected this to assign the elements of slice `b` to the elements of slice `a` just like how it works when doing `a.xy() = Vector2f()`. Turns out the later case is unit tested, the first one not.","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22574/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22574/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22532","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22532/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22532/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22532/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22532","id":2039723894,"node_id":"PR_kwDOAFDaZs5h5dYZ","number":22532,"title":"Navigator/FlightTaskAuto yaw handling improvements/simplifications","user":{"login":"sfuhrer","id":26798987,"node_id":"MDQ6VXNlcjI2Nzk4OTg3","avatar_url":"https://avatars.githubusercontent.com/u/26798987?v=4","gravatar_id":"","url":"https://api.github.com/users/sfuhrer","html_url":"https://github.com/sfuhrer","followers_url":"https://api.github.com/users/sfuhrer/followers","following_url":"https://api.github.com/users/sfuhrer/following{/other_user}","gists_url":"https://api.github.com/users/sfuhrer/gists{/gist_id}","starred_url":"https://api.github.com/users/sfuhrer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfuhrer/subscriptions","organizations_url":"https://api.github.com/users/sfuhrer/orgs","repos_url":"https://api.github.com/users/sfuhrer/repos","events_url":"https://api.github.com/users/sfuhrer/events{/privacy}","received_events_url":"https://api.github.com/users/sfuhrer/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":803319897,"node_id":"MDU6TGFiZWw4MDMzMTk4OTc=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/cleanup%20(housekeeping)%20%F0%9F%A7%B9","name":"cleanup (housekeeping) 🧹","color":"aefcbd","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"sfuhrer","id":26798987,"node_id":"MDQ6VXNlcjI2Nzk4OTg3","avatar_url":"https://avatars.githubusercontent.com/u/26798987?v=4","gravatar_id":"","url":"https://api.github.com/users/sfuhrer","html_url":"https://github.com/sfuhrer","followers_url":"https://api.github.com/users/sfuhrer/followers","following_url":"https://api.github.com/users/sfuhrer/following{/other_user}","gists_url":"https://api.github.com/users/sfuhrer/gists{/gist_id}","starred_url":"https://api.github.com/users/sfuhrer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfuhrer/subscriptions","organizations_url":"https://api.github.com/users/sfuhrer/orgs","repos_url":"https://api.github.com/users/sfuhrer/repos","events_url":"https://api.github.com/users/sfuhrer/events{/privacy}","received_events_url":"https://api.github.com/users/sfuhrer/received_events","type":"User","site_admin":false},"assignees":[{"login":"sfuhrer","id":26798987,"node_id":"MDQ6VXNlcjI2Nzk4OTg3","avatar_url":"https://avatars.githubusercontent.com/u/26798987?v=4","gravatar_id":"","url":"https://api.github.com/users/sfuhrer","html_url":"https://github.com/sfuhrer","followers_url":"https://api.github.com/users/sfuhrer/followers","following_url":"https://api.github.com/users/sfuhrer/following{/other_user}","gists_url":"https://api.github.com/users/sfuhrer/gists{/gist_id}","starred_url":"https://api.github.com/users/sfuhrer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfuhrer/subscriptions","organizations_url":"https://api.github.com/users/sfuhrer/orgs","repos_url":"https://api.github.com/users/sfuhrer/repos","events_url":"https://api.github.com/users/sfuhrer/events{/privacy}","received_events_url":"https://api.github.com/users/sfuhrer/received_events","type":"User","site_admin":false}],"milestone":null,"comments":6,"created_at":"2023-12-13T13:32:42Z","updated_at":"2023-12-21T16:29:20Z","closed_at":"2023-12-21T15:50:13Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/22532","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22532","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/22532.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/22532.patch","merged_at":"2023-12-21T15:50:13Z"},"body":"### Solved Problem\r\nFixes https://github.com/PX4/PX4-Autopilot/pull/22413\r\nAlternative to https://github.com/PX4/PX4-Autopilot/pull/22455\r\n\r\nBeside it's also a proposal to make the logic around yaw setpoints in the Navigator vs FlightTasks simpler and cleaner.\r\n\r\n### Solution\r\nStrictly use the following concept: If Navigator publishes a finite yaw setpoint (`position_setpoint_tripplet.current.yaw`), then disable weather vane. This should be used if waypoints have an associated yaw setpoint (eg landings, VTOL transitions or waypoint mission items with the yaw field set). Otherwise leave authority over yaw to the FlightTask - it can then set it e.g. to direction of the next waypoint, to current yaw, or point the vehicle into the wind with the use of weather vane. \r\n\r\nThat allows us to remove the `disable_weather_vane` field from the position_setpoint.\r\n\r\nAdditionally I propose to thin out the position_setpoint topic and remove unnecessary fields: \r\n- `yaw_valid` (yaw is declared valid when `yaw` field is finite) --> we should init the yaw field to NAN ideally\r\n- `yawspeed` (doesn't seem to be used)\r\n- `yawspeed_valid`\r\n\r\nThere's also some other small cleanup proposal, check commits. \r\n\r\n### Changelog Entry\r\nFor release notes:\r\n```\r\nBugfix: FlightTaskAuto: disable wather vane if position setpoint contains yaw setpoint.\r\n```\r\n\r\n### Alternatives\r\n\r\n\r\n### Test coverage\r\nSITL tested for MC and VTOL. \r\nMC test:\r\n- Start the windy gazebo environment: `make px4_sitl gazebo_iris__windy`\r\n- Enable parameter `WV_EN`\r\n- Takeoff and RTL --> on current main it is stuck, doesn't RTL. With the fix here sets the yaw to the home_position.yaw, disables weather vane because the yaw field is finite, aligns yaw and descends. \r\n\r\n\r\n### Context\r\nWe should remove the yaw field of the Takeoff mission item in QGC, it has no effect (already previously to this PR).  Conceptionally I don't see the need of a yaw attribute to a MC takeoff, and wouldn't know what to expect (yaw once takeoff altitude achieved? Or already when climbing?)\r\n![image](https://github.com/PX4/PX4-Autopilot/assets/26798987/971572b0-f998-42fd-9547-192d3e4d8b69)\r\n\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22532/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22532/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22480","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22480/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22480/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22480/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22480","id":2024287845,"node_id":"PR_kwDOAFDaZs5hE9bz","number":22480,"title":"mixer_module: round float value when casting to uint16_t","user":{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false},"assignees":[{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false}],"milestone":null,"comments":6,"created_at":"2023-12-04T16:44:39Z","updated_at":"2023-12-08T02:35:57Z","closed_at":"2023-12-08T02:35:56Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/22480","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22480","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/22480.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/22480.patch","merged_at":"2023-12-08T02:35:56Z"},"body":"### Solved Problem\r\nWhen reviewing and testing #22402  I found that some input values to the mixer produce unexpected rounding errors on the out interface. Namely with symmetric differential rover wheel commands the rover would not go completely straight. I narrowed th issue down to the `output_limit_calc` in the mixer module which converts float to uint16_t (which we want to remove anyways). But I found that the issue comes from not very obvious rounding errors in this very old calculation.\r\n\r\n### Solution\r\nI suggest to fix it by adding `0.5f` before letting the machine round down during the datatype cast.\r\nPlease review carefully and tell me if there's a preferred method.\r\n\r\n### Changelog Entry\r\n```\r\nBugfix: Rounding error at the output of mixing\r\n```\r\n\r\n### Alternatives\r\nWe'll move to floats for outputs completely which will allow also reverse outputs with negative values. I might create a pr for this as well.\r\n\r\n### Test coverage\r\nHere is my test case with which I found the issue. I have two outputs and the configuration is:\r\n`_min_value`: 0\r\n`_max_value` 100\r\n\r\n**Before:**\r\n`value`: 0.050\r\n`value * (_max_value[i] - _min_value[i])`: 5.000\r\n`(_max_value[i] + _min_value[i]) / 2`: 100.000\r\n`value * (_max_value[i] - _min_value[i]) / 2 + (_max_value[i] + _min_value[i]) / 2`: 105.000\r\n`effective_output`: _104_\r\n\r\n`value`: -0.050\r\n`value * (_max_value[i] - _min_value[i])`: -5.000\r\n`(_max_value[i] + _min_value[i]) / 2`: 100.000\r\n`value * (_max_value[i] - _min_value[i]) / 2 + (_max_value[i] + _min_value[i]) / 2`: 95.000\r\n`effective_output`: 95\r\n\r\n`outputs`: _104_ 95\r\n\r\n**After:**\r\n`value`: 0.050\r\n`value * (_max_value[i] - _min_value[i])`: 5.000\r\n`(_max_value[i] + _min_value[i]) / 2`: 100.000\r\n`value * (_max_value[i] - _min_value[i]) / 2 + (_max_value[i] + _min_value[i]) / 2`: 105.000\r\n`effective_output`: _105_\r\n\r\n`value`: -0.050\r\n`value * (_max_value[i] - _min_value[i])`: -5.000\r\n`(_max_value[i] + _min_value[i]) / 2`: 100.000\r\n`value * (_max_value[i] - _min_value[i]) / 2 + (_max_value[i] + _min_value[i]) / 2`: 95.000\r\n`effective_output`: 95\r\n\r\n`outputs`: _105_ 95","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22480/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22480/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22331","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22331/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22331/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22331/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22331","id":1981703148,"node_id":"PR_kwDOAFDaZs5e00J3","number":22331,"title":"PositionSmoothing: fix corner altitude bug","user":{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":78699954,"node_id":"MDU6TGFiZWw3ODY5OTk1NA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Multirotor%20%F0%9F%9B%B8","name":"Multirotor 🛸","color":"0052cc","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false},"assignees":[{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false}],"milestone":null,"comments":9,"created_at":"2023-11-07T16:02:26Z","updated_at":"2023-11-10T09:02:21Z","closed_at":"2023-11-10T09:02:20Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/22331","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22331","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/22331.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/22331.patch","merged_at":"2023-11-10T09:02:20Z"},"body":"### Solved Problem\r\nWe got multiple reports that the altitude profile between two waypoints is not a diagonal line but changes altitude much quicker when leaving the previous waypoint and getting much flatter after that.\r\n\r\nDuring a round corner the L1 distance calculation\r\nwas only done in 2D and the z-axis coordinate\r\nwas directly coming from the next waypoint.\r\nThis lead to an unpredictable altitude profile\r\nbetween two waypoints. Sometimes almost all\r\naltitude difference was already covered during\r\nthe turn instead of going diagonally.\r\n\r\nFixes #{Github issue ID}\r\n\r\n### Solution\r\n- Make the entire L1 distance and intersection calculation 3D\r\n- Refactor ...\r\n\r\n### Changelog Entry\r\n```\r\nBugfix: Multicopter altitude change sometimes not linear between two waypoints\r\n```\r\n\r\n### Test coverage\r\nSimulation testing procedure:\r\n\r\n1. Command to test: `PX4_SIM_SPEED_FACTOR=100 make px4_sitl jmavsim`\r\n1. [Load plan file](https://docs.qgroundcontrol.com/master/en/PlanView/PlanView.html#file) for jMAVsim location through QGC: [rounded_altitude_change.plan](https://github.com/PX4/PX4-Autopilot/files/13283004/rounded_altitude_change.plan.txt)\r\n\r\nI still need to verify the 2D only case with no valid altitude works as expected.\r\n\r\n### Context\r\nBefore: https://logs.px4.io/3d?log=45c8f43e-32e7-4c7f-ab30-975e1c8aa32b\r\n![image](https://github.com/PX4/PX4-Autopilot/assets/4668506/d7da8173-9016-48f8-ada5-49fb1e6c2d25)\r\nAfter: https://logs.px4.io/3d?log=17dd1c3e-bd5e-46b0-abad-3bba6c517e2f\r\n![image](https://github.com/PX4/PX4-Autopilot/assets/4668506/e161ac7a-5966-4623-97f1-47192f13683c)\r\n\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22331/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":1,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22331/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22261","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22261/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22261/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22261/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22261","id":1961453648,"node_id":"PR_kwDOAFDaZs5dwZsO","number":22261,"title":"sdcardCheck: shorten hardfault log availability message","user":{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false},"assignees":[{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false}],"milestone":null,"comments":0,"created_at":"2023-10-25T13:38:29Z","updated_at":"2023-10-25T20:43:07Z","closed_at":"2023-10-25T20:43:06Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/22261","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22261","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/22261.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/22261.patch","merged_at":"2023-10-25T20:43:06Z"},"body":"### Solved Problem\r\nFix expected behavior points 2. and 3. from https://github.com/PX4/PX4-Autopilot/issues/22259\r\n![image](https://github.com/PX4/PX4-Autopilot/assets/4668506/e6197956-a8eb-4615-bc3f-2b4e2a6e21d7)\r\n\r\n### Solution\r\nShorten the message\r\nIt seems to cause multiple issues to have a long message:\r\n- The full message doesn't show on the console because the buffer only has length of `log_message.text` which is 127.\r\n- The additional text shows even if the event that replaces this message already exists. I honestly didn't find the mechanism that breaks there.\r\n\r\n### Changelog Entry\r\n```\r\nBugfix: Show hard fault log availability message correctly\r\n```\r\n\r\n### Alternatives\r\nIdeally, longer messages would be supported correctly or there would be a compile error preventing developers from using them. Note that it's not that easy because e.g. the colorized console output uses up > 50 bytes for all the WARN, coloring and module name from the 127-byte buffer.\r\n\r\n### Test coverage\r\n- Tested the change on a pixhawk 4 and the message ending doesn't show up unexpectedly anymore.","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22261/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22261/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22253","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22253/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22253/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22253/events","html_url":"https://github.com/PX4/PX4-Autopilot/issues/22253","id":1955875008,"node_id":"I_kwDOAFDaZs50lEjA","number":22253,"title":"[Bug] QGC does not flash release v1.14.0 on Pixhawk 6X","user":{"login":"mzahana","id":8803307,"node_id":"MDQ6VXNlcjg4MDMzMDc=","avatar_url":"https://avatars.githubusercontent.com/u/8803307?v=4","gravatar_id":"","url":"https://api.github.com/users/mzahana","html_url":"https://github.com/mzahana","followers_url":"https://api.github.com/users/mzahana/followers","following_url":"https://api.github.com/users/mzahana/following{/other_user}","gists_url":"https://api.github.com/users/mzahana/gists{/gist_id}","starred_url":"https://api.github.com/users/mzahana/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mzahana/subscriptions","organizations_url":"https://api.github.com/users/mzahana/orgs","repos_url":"https://api.github.com/users/mzahana/repos","events_url":"https://api.github.com/users/mzahana/events{/privacy}","received_events_url":"https://api.github.com/users/mzahana/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":4147343828,"node_id":"LA_kwDOAFDaZs73M3HU","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug-report","name":"bug-report","color":"376B2E","default":false,"description":""},{"id":5167361665,"node_id":"LA_kwDOAFDaZs8AAAABM_-ugQ","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/maintainers%20call","name":"maintainers call","color":"78BFE1","default":false,"description":"Add items that should be discussed in the weekly maintainers call!"},{"id":5535857183,"node_id":"LA_kwDOAFDaZs8AAAABSfZ6Hw","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/v1.14","name":"v1.14","color":"F9E2EB","default":false,"description":""}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2023-10-22T12:04:04Z","updated_at":"2023-11-07T16:50:36Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"### Describe the bug\n\nI have QGC `4.2.8` (also tried the daily build), and Pixhaw 6X.\r\nI tried to install the latest stable PX4 `v1.14.0`. However the reported version after installation is `v1.13.3`\r\n\r\nI am not sure if this is PX4 bug or QGC bug.\r\n\n\n### To Reproduce\n\n1. Download latest stabel QGC\r\n2. Flash the latest PX4 release (`v1.14.0` at the time of writing this issue)\r\n3. QGC reports PX4 version as `v1.13.3`\n\n### Expected behavior\n\nQGC should report `v1.14.0`\n\n### Screenshot / Media\n\n_No response_\n\n### Flight Log\n\nThere is no need for flight log.\n\n### Software Version\n\nSupposed to be `v1.14.0`\n\n### Flight controller\n\nPixhawk 6X\n\n### Vehicle type\n\nMulticopter\n\n### How are the different components wired up (including port information)\n\n_No response_\n\n### Additional context\n\n_No response_","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22253/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22253/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22248","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22248/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22248/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22248/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22248","id":1953087766,"node_id":"PR_kwDOAFDaZs5dUYns","number":22248,"title":"mavlink: properly set mission_type","user":{"login":"julianoes","id":1419688,"node_id":"MDQ6VXNlcjE0MTk2ODg=","avatar_url":"https://avatars.githubusercontent.com/u/1419688?v=4","gravatar_id":"","url":"https://api.github.com/users/julianoes","html_url":"https://github.com/julianoes","followers_url":"https://api.github.com/users/julianoes/followers","following_url":"https://api.github.com/users/julianoes/following{/other_user}","gists_url":"https://api.github.com/users/julianoes/gists{/gist_id}","starred_url":"https://api.github.com/users/julianoes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/julianoes/subscriptions","organizations_url":"https://api.github.com/users/julianoes/orgs","repos_url":"https://api.github.com/users/julianoes/repos","events_url":"https://api.github.com/users/julianoes/events{/privacy}","received_events_url":"https://api.github.com/users/julianoes/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2023-10-19T21:31:01Z","updated_at":"2023-10-20T02:20:16Z","closed_at":"2023-10-20T02:20:15Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/22248","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22248","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/22248.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/22248.patch","merged_at":"2023-10-20T02:20:15Z"},"body":"Fixes #22069.\r\n\r\nThe mission_type was defaulted to 0 before which messed with transmitting geofence and rally items.\r\n\r\nNeeds to go into v1.14 as well.\r\n\r\nThanks to [av-jeroen](https://github.com/av-jeroen) for reporting the bug.","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22248/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22248/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22202","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22202/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22202/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22202/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22202","id":1934348122,"node_id":"PR_kwDOAFDaZs5cVEWs","number":22202,"title":"fix lightware_laser_serial: prevent potential heap buffer overflow","user":{"login":"zeroone-kr","id":42103354,"node_id":"MDQ6VXNlcjQyMTAzMzU0","avatar_url":"https://avatars.githubusercontent.com/u/42103354?v=4","gravatar_id":"","url":"https://api.github.com/users/zeroone-kr","html_url":"https://github.com/zeroone-kr","followers_url":"https://api.github.com/users/zeroone-kr/followers","following_url":"https://api.github.com/users/zeroone-kr/following{/other_user}","gists_url":"https://api.github.com/users/zeroone-kr/gists{/gist_id}","starred_url":"https://api.github.com/users/zeroone-kr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zeroone-kr/subscriptions","organizations_url":"https://api.github.com/users/zeroone-kr/orgs","repos_url":"https://api.github.com/users/zeroone-kr/repos","events_url":"https://api.github.com/users/zeroone-kr/events{/privacy}","received_events_url":"https://api.github.com/users/zeroone-kr/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2023-10-10T04:50:09Z","updated_at":"2023-10-30T16:40:26Z","closed_at":"2023-10-11T05:01:09Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/22202","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22202","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/22202.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/22202.patch","merged_at":"2023-10-11T05:01:09Z"},"body":"In the lightware_parser function, LW_PARSE_STATE2_GOT_DIGIT0 state can be repeated unexpectedly without proper parserbuf_index or state checking. This behavior will trigger a heap buffer overflow vulnerability by allowing to write some data. And the writable size is maximum value of `unsigned int`.\r\n\r\nWe've discussed for this bug with @bkueng ","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22202/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22202/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22165","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22165/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22165/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22165/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22165","id":1921413323,"node_id":"PR_kwDOAFDaZs5bpYSP","number":22165,"title":"mission_base: if FW and Takeoff do not enter climb before mission start","user":{"login":"sfuhrer","id":26798987,"node_id":"MDQ6VXNlcjI2Nzk4OTg3","avatar_url":"https://avatars.githubusercontent.com/u/26798987?v=4","gravatar_id":"","url":"https://api.github.com/users/sfuhrer","html_url":"https://github.com/sfuhrer","followers_url":"https://api.github.com/users/sfuhrer/followers","following_url":"https://api.github.com/users/sfuhrer/following{/other_user}","gists_url":"https://api.github.com/users/sfuhrer/gists{/gist_id}","starred_url":"https://api.github.com/users/sfuhrer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfuhrer/subscriptions","organizations_url":"https://api.github.com/users/sfuhrer/orgs","repos_url":"https://api.github.com/users/sfuhrer/repos","events_url":"https://api.github.com/users/sfuhrer/events{/privacy}","received_events_url":"https://api.github.com/users/sfuhrer/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":78699916,"node_id":"MDU6TGFiZWw3ODY5OTkxNg==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Fixed%20Wing%20%F0%9F%9B%A9%EF%B8%8F","name":"Fixed Wing 🛩️","color":"009800","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2023-10-02T07:47:41Z","updated_at":"2023-10-02T13:25:48Z","closed_at":"2023-10-02T13:25:46Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/22165","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22165","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/22165.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/22165.patch","merged_at":"2023-10-02T13:25:46Z"},"body":"### Solved Problem\r\nFixes issue raised [here](https://discord.com/channels/1022170275984457759/1022186266957201480/1156841185160204329) about weird FW takeoff path. \r\n\r\n### Solution\r\nIssue was introduced with https://github.com/PX4/PX4-Autopilot/pull/20908. There was a missing customization for FW, where we don't want to do the same as for MC/VTOLs in hover when starting a mission (go directly to first WP and not first climb to altitude).\r\n\r\nI also removed some outdated config in the advanced_plane config. \r\n\r\n### Changelog Entry\r\nFor release notes:\r\n```\r\nBugfix: FW Mission start with Takeoff item: by-pass climbing-first logic and go straight to the Takeoff item.\r\n```\r\n\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22165/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22165/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22154","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22154/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22154/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22154/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22154","id":1917107454,"node_id":"PR_kwDOAFDaZs5ba_-8","number":22154,"title":"vfr_hud: fix throttle display for FW","user":{"login":"sfuhrer","id":26798987,"node_id":"MDQ6VXNlcjI2Nzk4OTg3","avatar_url":"https://avatars.githubusercontent.com/u/26798987?v=4","gravatar_id":"","url":"https://api.github.com/users/sfuhrer","html_url":"https://github.com/sfuhrer","followers_url":"https://api.github.com/users/sfuhrer/followers","following_url":"https://api.github.com/users/sfuhrer/following{/other_user}","gists_url":"https://api.github.com/users/sfuhrer/gists{/gist_id}","starred_url":"https://api.github.com/users/sfuhrer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfuhrer/subscriptions","organizations_url":"https://api.github.com/users/sfuhrer/orgs","repos_url":"https://api.github.com/users/sfuhrer/repos","events_url":"https://api.github.com/users/sfuhrer/events{/privacy}","received_events_url":"https://api.github.com/users/sfuhrer/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":78699916,"node_id":"MDU6TGFiZWw3ODY5OTkxNg==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Fixed%20Wing%20%F0%9F%9B%A9%EF%B8%8F","name":"Fixed Wing 🛩️","color":"009800","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2023-09-28T09:41:14Z","updated_at":"2023-09-30T14:33:44Z","closed_at":"2023-09-28T15:15:27Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/22154","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22154","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/22154.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/22154.patch","merged_at":"2023-09-28T15:15:26Z"},"body":"\r\n### Solved Problem\r\nhttps://discord.com/channels/1022170275984457759/1022186266957201480/1156786412729933824\r\n\r\n### Solution\r\nAlso check thrust in x for FW.\r\n\r\n### Changelog Entry\r\nFor release notes:\r\n```\r\nBugfix: Fix  throttle display in VFR_HUD mavlink message\r\n```\r\n\r\nHas to be ported to 1.14.","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22154/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22154/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22152","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22152/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22152/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22152/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22152","id":1916764337,"node_id":"PR_kwDOAFDaZs5bZ19-","number":22152,"title":"fix crsf_rc: prevent potential buffer overflow for unknown packets","user":{"login":"bkueng","id":281593,"node_id":"MDQ6VXNlcjI4MTU5Mw==","avatar_url":"https://avatars.githubusercontent.com/u/281593?v=4","gravatar_id":"","url":"https://api.github.com/users/bkueng","html_url":"https://github.com/bkueng","followers_url":"https://api.github.com/users/bkueng/followers","following_url":"https://api.github.com/users/bkueng/following{/other_user}","gists_url":"https://api.github.com/users/bkueng/gists{/gist_id}","starred_url":"https://api.github.com/users/bkueng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bkueng/subscriptions","organizations_url":"https://api.github.com/users/bkueng/orgs","repos_url":"https://api.github.com/users/bkueng/repos","events_url":"https://api.github.com/users/bkueng/events{/privacy}","received_events_url":"https://api.github.com/users/bkueng/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2023-09-28T05:49:20Z","updated_at":"2023-10-05T06:00:24Z","closed_at":"2023-10-05T06:00:23Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/22152","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22152","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/22152.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/22152.patch","merged_at":"2023-10-05T06:00:23Z"},"body":"The length check for unknown packets did not include PACKET_SIZE_TYPE_SIZE and CRC_SIZE, and hence working_index could overflow CRSF_MAX_PACKET_LEN, triggering invalid memory access further down in QueueBuffer_PeekBuffer.\r\n\r\nAlso the working_segment_size was wrong for unknown packets.\r\n\r\nCredits for finding this go to @Pwn9uin.\r\n\r\nI did not test this, as I currrently don't have hw.","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22152/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22152/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22147","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22147/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22147/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22147/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22147","id":1915833293,"node_id":"PR_kwDOAFDaZs5bWrRZ","number":22147,"title":"Fix Helicopter saturation logic","user":{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":5304381750,"node_id":"LA_kwDOAFDaZs8AAAABPCpxNg","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Helicopter%20%F0%9F%9A%81","name":"Helicopter 🚁","color":"963BB8","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false},"assignees":[{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false}],"milestone":null,"comments":2,"created_at":"2023-09-27T15:26:20Z","updated_at":"2023-10-25T17:19:02Z","closed_at":"2023-09-28T06:53:36Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/22147","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22147","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/22147.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/22147.patch","merged_at":"2023-09-28T06:53:36Z"},"body":"This became necessary otherwise\r\nthe allocation reports saturation all\r\nthe time and the rate integrator doesn't work.\r\n\r\n### Solved Problem\r\nWhen using a helicopter on the latest version I found that the integrator doesn't have any effect. The issue seems to be the same as was fixed for tiltrotors in https://github.com/PX4/PX4-Autopilot/pull/21994 I'm looking for the original change that made this necessary.\r\n\r\n### Solution\r\nHandle the unsaturated case explicitly and report 0 unallocated torque in that case.\r\n\r\n### Changelog Entry\r\nFor release notes:\r\n```\r\nBugfix: Helicopter saturation logic leads to rate control integrator not working\r\n```\r\n\r\n### Test coverage\r\nAfter this change it was working like expected again, tested on a real helicopter.\r\n\r\n### Context\r\nBefore\r\n![image](https://github.com/PX4/PX4-Autopilot/assets/4668506/ffc75af5-a05f-4461-af86-9691283df33a)\r\nAfter\r\n![image](https://github.com/PX4/PX4-Autopilot/assets/4668506/05f94b55-93ca-4bc9-82b9-f6e8e11316d5)\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22147/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22147/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22100","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22100/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22100/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22100/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22100","id":1903264622,"node_id":"PR_kwDOAFDaZs5asWuk","number":22100,"title":"[BACKPORT] Avoid unexpected repositions","user":{"login":"tstastny","id":8026163,"node_id":"MDQ6VXNlcjgwMjYxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8026163?v=4","gravatar_id":"","url":"https://api.github.com/users/tstastny","html_url":"https://github.com/tstastny","followers_url":"https://api.github.com/users/tstastny/followers","following_url":"https://api.github.com/users/tstastny/following{/other_user}","gists_url":"https://api.github.com/users/tstastny/gists{/gist_id}","starred_url":"https://api.github.com/users/tstastny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tstastny/subscriptions","organizations_url":"https://api.github.com/users/tstastny/orgs","repos_url":"https://api.github.com/users/tstastny/repos","events_url":"https://api.github.com/users/tstastny/events{/privacy}","received_events_url":"https://api.github.com/users/tstastny/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":{"login":"tstastny","id":8026163,"node_id":"MDQ6VXNlcjgwMjYxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8026163?v=4","gravatar_id":"","url":"https://api.github.com/users/tstastny","html_url":"https://github.com/tstastny","followers_url":"https://api.github.com/users/tstastny/followers","following_url":"https://api.github.com/users/tstastny/following{/other_user}","gists_url":"https://api.github.com/users/tstastny/gists{/gist_id}","starred_url":"https://api.github.com/users/tstastny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tstastny/subscriptions","organizations_url":"https://api.github.com/users/tstastny/orgs","repos_url":"https://api.github.com/users/tstastny/repos","events_url":"https://api.github.com/users/tstastny/events{/privacy}","received_events_url":"https://api.github.com/users/tstastny/received_events","type":"User","site_admin":false},"assignees":[{"login":"tstastny","id":8026163,"node_id":"MDQ6VXNlcjgwMjYxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8026163?v=4","gravatar_id":"","url":"https://api.github.com/users/tstastny","html_url":"https://github.com/tstastny","followers_url":"https://api.github.com/users/tstastny/followers","following_url":"https://api.github.com/users/tstastny/following{/other_user}","gists_url":"https://api.github.com/users/tstastny/gists{/gist_id}","starred_url":"https://api.github.com/users/tstastny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tstastny/subscriptions","organizations_url":"https://api.github.com/users/tstastny/orgs","repos_url":"https://api.github.com/users/tstastny/repos","events_url":"https://api.github.com/users/tstastny/events{/privacy}","received_events_url":"https://api.github.com/users/tstastny/received_events","type":"User","site_admin":false}],"milestone":null,"comments":0,"created_at":"2023-09-19T15:40:58Z","updated_at":"2023-09-19T23:16:04Z","closed_at":"2023-09-19T23:16:03Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/22100","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22100","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/22100.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/22100.patch","merged_at":"2023-09-19T23:16:03Z"},"body":"backport of https://github.com/PX4/PX4-Autopilot/pull/22078\r\n\r\n### Changelog Entry\r\nFor release notes:\r\n```\r\nBugfix: Don't allow external reposition commands without a mode switch, and ensure old reposition commands are not erroneously set.\r\n```","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22100/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22100/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22099","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22099/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22099/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22099/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22099","id":1903261244,"node_id":"PR_kwDOAFDaZs5asWAM","number":22099,"title":"[BACKPORT] FixedwingPositionControl: initialize the airspeed slew rate controller with trim airspeed in the constructor","user":{"login":"tstastny","id":8026163,"node_id":"MDQ6VXNlcjgwMjYxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8026163?v=4","gravatar_id":"","url":"https://api.github.com/users/tstastny","html_url":"https://github.com/tstastny","followers_url":"https://api.github.com/users/tstastny/followers","following_url":"https://api.github.com/users/tstastny/following{/other_user}","gists_url":"https://api.github.com/users/tstastny/gists{/gist_id}","starred_url":"https://api.github.com/users/tstastny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tstastny/subscriptions","organizations_url":"https://api.github.com/users/tstastny/orgs","repos_url":"https://api.github.com/users/tstastny/repos","events_url":"https://api.github.com/users/tstastny/events{/privacy}","received_events_url":"https://api.github.com/users/tstastny/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":78699916,"node_id":"MDU6TGFiZWw3ODY5OTkxNg==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Fixed%20Wing%20%F0%9F%9B%A9%EF%B8%8F","name":"Fixed Wing 🛩️","color":"009800","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"tstastny","id":8026163,"node_id":"MDQ6VXNlcjgwMjYxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8026163?v=4","gravatar_id":"","url":"https://api.github.com/users/tstastny","html_url":"https://github.com/tstastny","followers_url":"https://api.github.com/users/tstastny/followers","following_url":"https://api.github.com/users/tstastny/following{/other_user}","gists_url":"https://api.github.com/users/tstastny/gists{/gist_id}","starred_url":"https://api.github.com/users/tstastny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tstastny/subscriptions","organizations_url":"https://api.github.com/users/tstastny/orgs","repos_url":"https://api.github.com/users/tstastny/repos","events_url":"https://api.github.com/users/tstastny/events{/privacy}","received_events_url":"https://api.github.com/users/tstastny/received_events","type":"User","site_admin":false},"assignees":[{"login":"tstastny","id":8026163,"node_id":"MDQ6VXNlcjgwMjYxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8026163?v=4","gravatar_id":"","url":"https://api.github.com/users/tstastny","html_url":"https://github.com/tstastny","followers_url":"https://api.github.com/users/tstastny/followers","following_url":"https://api.github.com/users/tstastny/following{/other_user}","gists_url":"https://api.github.com/users/tstastny/gists{/gist_id}","starred_url":"https://api.github.com/users/tstastny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tstastny/subscriptions","organizations_url":"https://api.github.com/users/tstastny/orgs","repos_url":"https://api.github.com/users/tstastny/repos","events_url":"https://api.github.com/users/tstastny/events{/privacy}","received_events_url":"https://api.github.com/users/tstastny/received_events","type":"User","site_admin":false}],"milestone":null,"comments":0,"created_at":"2023-09-19T15:38:54Z","updated_at":"2023-09-19T23:15:42Z","closed_at":"2023-09-19T23:15:41Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/22099","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22099","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/22099.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/22099.patch","merged_at":"2023-09-19T23:15:41Z"},"body":"backport of https://github.com/PX4/PX4-Autopilot/pull/22077\r\n\r\n### Changelog Entry\r\nFor release notes:\r\n```\r\nBugfix: initialize airspeed setpoint by default at at trim speed\r\n```","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22099/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22099/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22097","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22097/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22097/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22097/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22097","id":1902703620,"node_id":"PR_kwDOAFDaZs5aqc3b","number":22097,"title":"VTOL Takeoff: Use global position instead of home for takoeff","user":{"login":"RomanBapst","id":7610489,"node_id":"MDQ6VXNlcjc2MTA0ODk=","avatar_url":"https://avatars.githubusercontent.com/u/7610489?v=4","gravatar_id":"","url":"https://api.github.com/users/RomanBapst","html_url":"https://github.com/RomanBapst","followers_url":"https://api.github.com/users/RomanBapst/followers","following_url":"https://api.github.com/users/RomanBapst/following{/other_user}","gists_url":"https://api.github.com/users/RomanBapst/gists{/gist_id}","starred_url":"https://api.github.com/users/RomanBapst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RomanBapst/subscriptions","organizations_url":"https://api.github.com/users/RomanBapst/orgs","repos_url":"https://api.github.com/users/RomanBapst/repos","events_url":"https://api.github.com/users/RomanBapst/events{/privacy}","received_events_url":"https://api.github.com/users/RomanBapst/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":249514594,"node_id":"MDU6TGFiZWwyNDk1MTQ1OTQ=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Hybrid%20VTOL%20%F0%9F%9B%A9%EF%B8%8F%F0%9F%9A%81","name":"Hybrid VTOL 🛩️🚁","color":"bfe5bf","default":false,"description":"Multirotor + Fixedwing!"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2023-09-19T10:47:07Z","updated_at":"2023-09-19T17:00:55Z","closed_at":"2023-09-19T17:00:54Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/22097","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22097","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/22097.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/22097.patch","merged_at":"2023-09-19T17:00:54Z"},"body":"\r\n### Solved Problem\r\nWhen the vehicle home position does not coincide with the takeoff position the vehicle drifts off towards the home position during takeoff which is not the expected behavior.\r\n\r\n\r\n### Solution\r\n- Use global position for takeoff instead of home position.\r\n\r\n### Changelog Entry\r\nFor release notes:\r\n```\r\nBugfix: \r\nPrevent VTOL Takeoff from drifting during takeoff ascent when home position does not coincide with takeoff position.\r\n```","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22097/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22097/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22078","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22078/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22078/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22078/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22078","id":1894964683,"node_id":"PR_kwDOAFDaZs5aQi7Y","number":22078,"title":"Avoid unexpected repositions","user":{"login":"tstastny","id":8026163,"node_id":"MDQ6VXNlcjgwMjYxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8026163?v=4","gravatar_id":"","url":"https://api.github.com/users/tstastny","html_url":"https://github.com/tstastny","followers_url":"https://api.github.com/users/tstastny/followers","following_url":"https://api.github.com/users/tstastny/following{/other_user}","gists_url":"https://api.github.com/users/tstastny/gists{/gist_id}","starred_url":"https://api.github.com/users/tstastny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tstastny/subscriptions","organizations_url":"https://api.github.com/users/tstastny/orgs","repos_url":"https://api.github.com/users/tstastny/repos","events_url":"https://api.github.com/users/tstastny/events{/privacy}","received_events_url":"https://api.github.com/users/tstastny/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":{"login":"tstastny","id":8026163,"node_id":"MDQ6VXNlcjgwMjYxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8026163?v=4","gravatar_id":"","url":"https://api.github.com/users/tstastny","html_url":"https://github.com/tstastny","followers_url":"https://api.github.com/users/tstastny/followers","following_url":"https://api.github.com/users/tstastny/following{/other_user}","gists_url":"https://api.github.com/users/tstastny/gists{/gist_id}","starred_url":"https://api.github.com/users/tstastny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tstastny/subscriptions","organizations_url":"https://api.github.com/users/tstastny/orgs","repos_url":"https://api.github.com/users/tstastny/repos","events_url":"https://api.github.com/users/tstastny/events{/privacy}","received_events_url":"https://api.github.com/users/tstastny/received_events","type":"User","site_admin":false},"assignees":[{"login":"tstastny","id":8026163,"node_id":"MDQ6VXNlcjgwMjYxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8026163?v=4","gravatar_id":"","url":"https://api.github.com/users/tstastny","html_url":"https://github.com/tstastny","followers_url":"https://api.github.com/users/tstastny/followers","following_url":"https://api.github.com/users/tstastny/following{/other_user}","gists_url":"https://api.github.com/users/tstastny/gists{/gist_id}","starred_url":"https://api.github.com/users/tstastny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tstastny/subscriptions","organizations_url":"https://api.github.com/users/tstastny/orgs","repos_url":"https://api.github.com/users/tstastny/repos","events_url":"https://api.github.com/users/tstastny/events{/privacy}","received_events_url":"https://api.github.com/users/tstastny/received_events","type":"User","site_admin":false}],"milestone":null,"comments":0,"created_at":"2023-09-13T17:32:25Z","updated_at":"2023-09-13T19:29:32Z","closed_at":"2023-09-13T19:29:32Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/22078","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22078","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/22078.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/22078.patch","merged_at":"2023-09-13T19:29:31Z"},"body":"<!--\r\n\r\nThank you for your contribution!\r\n\r\nGet early feedback through\r\n- Dronecode Discord: https://discord.gg/dronecode\r\n- PX4 Discuss: http://discuss.px4.io/\r\n- opening a draft pr and sharing the link\r\n\r\n-->\r\n\r\n### Solved Problem\r\n1. Geofence reposition lifetime: when in RTL, the geofence reposition setpoint is ignored (ok, fine) - however, the reposition struct that holds that geofence position is stored until the next flight. If a manual control loss then engages a hold (during RTL delay time), the reposition setpoint is taken for the hold, which may be anywhere else other than the vehicle's current position.. which would be the desired hold position.\r\n2. External reposition commands without a requested mode switch (flag) are silently accepted and can cause unexpected positioning when hold is engaged.\r\n\r\n### Solution\r\n1. In the loiter activation methods, check the reposition setpoint's timestamp in addition to validity.\r\n3. Don't allow reposition commands without a requested mode switch.\r\n\r\n### Changelog Entry\r\nFor release notes:\r\n```\r\nBugfix: Don't allow external reposition commands without a mode switch, and ensure old reposition commands are not erroneously set.\r\n```\r\n\r\n### Alternatives\r\nReal solution is not sharing the reposition struct between multiple modes, and not reusing loiter mode for goto and hold.\r\n\r\n### Test coverage\r\n- used libmav to send a reposition command without the modeswitch bit.. it rejects now\r\n- test case:\r\n  - unplug manual control\r\n  - let the multicopter rtl with geo fence boundary set near home\r\n  - geo fence sets reposition struct somewhere along the path towards home (but rtl ignores)\r\n  - vehicle lands, disarms\r\n  - arm and takeoff again in manual\r\n  - unplug manual control\r\n  - rtl ensues\r\n  - the rtl hold delay before returning to home is correctly set to the vehicle's current position (not the previously set reposition struct from last flight)","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22078/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22078/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22077","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22077/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22077/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22077/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22077","id":1894592223,"node_id":"PR_kwDOAFDaZs5aPRpA","number":22077,"title":"FixedwingPositionControl: initialize airspeed slew controller in constructor","user":{"login":"tstastny","id":8026163,"node_id":"MDQ6VXNlcjgwMjYxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8026163?v=4","gravatar_id":"","url":"https://api.github.com/users/tstastny","html_url":"https://github.com/tstastny","followers_url":"https://api.github.com/users/tstastny/followers","following_url":"https://api.github.com/users/tstastny/following{/other_user}","gists_url":"https://api.github.com/users/tstastny/gists{/gist_id}","starred_url":"https://api.github.com/users/tstastny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tstastny/subscriptions","organizations_url":"https://api.github.com/users/tstastny/orgs","repos_url":"https://api.github.com/users/tstastny/repos","events_url":"https://api.github.com/users/tstastny/events{/privacy}","received_events_url":"https://api.github.com/users/tstastny/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":78699916,"node_id":"MDU6TGFiZWw3ODY5OTkxNg==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Fixed%20Wing%20%F0%9F%9B%A9%EF%B8%8F","name":"Fixed Wing 🛩️","color":"009800","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"tstastny","id":8026163,"node_id":"MDQ6VXNlcjgwMjYxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8026163?v=4","gravatar_id":"","url":"https://api.github.com/users/tstastny","html_url":"https://github.com/tstastny","followers_url":"https://api.github.com/users/tstastny/followers","following_url":"https://api.github.com/users/tstastny/following{/other_user}","gists_url":"https://api.github.com/users/tstastny/gists{/gist_id}","starred_url":"https://api.github.com/users/tstastny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tstastny/subscriptions","organizations_url":"https://api.github.com/users/tstastny/orgs","repos_url":"https://api.github.com/users/tstastny/repos","events_url":"https://api.github.com/users/tstastny/events{/privacy}","received_events_url":"https://api.github.com/users/tstastny/received_events","type":"User","site_admin":false},"assignees":[{"login":"tstastny","id":8026163,"node_id":"MDQ6VXNlcjgwMjYxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8026163?v=4","gravatar_id":"","url":"https://api.github.com/users/tstastny","html_url":"https://github.com/tstastny","followers_url":"https://api.github.com/users/tstastny/followers","following_url":"https://api.github.com/users/tstastny/following{/other_user}","gists_url":"https://api.github.com/users/tstastny/gists{/gist_id}","starred_url":"https://api.github.com/users/tstastny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tstastny/subscriptions","organizations_url":"https://api.github.com/users/tstastny/orgs","repos_url":"https://api.github.com/users/tstastny/repos","events_url":"https://api.github.com/users/tstastny/events{/privacy}","received_events_url":"https://api.github.com/users/tstastny/received_events","type":"User","site_admin":false}],"milestone":null,"comments":2,"created_at":"2023-09-13T13:55:32Z","updated_at":"2023-09-28T08:28:53Z","closed_at":"2023-09-13T20:18:16Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/22077","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22077","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/22077.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/22077.patch","merged_at":"2023-09-13T20:18:16Z"},"body":"<!--\r\n\r\nThank you for your contribution!\r\n\r\nGet early feedback through\r\n- Dronecode Discord: https://discord.gg/dronecode\r\n- PX4 Discuss: http://discuss.px4.io/\r\n- opening a draft pr and sharing the link\r\n\r\n-->\r\n\r\n### Solved Problem\r\nThe airspeed slew rate controller in the fixed wing position controller is only explicitly intialized in takeoff modes - but otherwise defaults to zero.. which then gets bounded to min airspeed on first pass to the airspeed handling logic.. which then requires a slewed ramp in of whatever actual setpoint the mode demands. Undesireable.\r\n\r\nFixes #{Github issue ID}\r\n\r\n### Solution\r\nInitialize the slew rate to trim airspeed in the constructor. This way no matter what mode enters the slewing logic first.. the starting point is a reasonable one. And takeoff modes still initialize to takeoff speed explicitly.\r\n\r\nAdditionally move the slew constraint checks to end of adapt airspeed method to make sure setpoint and constraints are decoupled.\r\n\r\n### Changelog Entry\r\nFor release notes:\r\n```\r\nBugfix: initialize airspeed setpoint by default at at trim speed\r\n```\r\n\r\n### Alternatives\r\nIn 1.15 we need to handle mode switches better.. ideally considering for each one exactly when we want to explicitly reinit the airspeed slewer or not.\r\n\r\n### Test coverage\r\n\r\nexample of takeoff force set slew value -- switches immediately (no slew) to takeoff speed:\r\n![image](https://github.com/PX4/PX4-Autopilot/assets/8026163/615e2901-0782-49cf-993f-6eed84ca0249)\r\n\r\nexample of position mode start -- starts at trim speed:\r\n![image](https://github.com/PX4/PX4-Autopilot/assets/8026163/c651ddbf-6522-4847-a21a-c9536264bf01)\r\n\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22077/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22077/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22074","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22074/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22074/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22074/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22074","id":1893963366,"node_id":"PR_kwDOAFDaZs5aNINE","number":22074,"title":"[BACKPORT] FW Pos Control: add in_takeoff_situation argument to adapt_airspeed_setpoint()","user":{"login":"tstastny","id":8026163,"node_id":"MDQ6VXNlcjgwMjYxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8026163?v=4","gravatar_id":"","url":"https://api.github.com/users/tstastny","html_url":"https://github.com/tstastny","followers_url":"https://api.github.com/users/tstastny/followers","following_url":"https://api.github.com/users/tstastny/following{/other_user}","gists_url":"https://api.github.com/users/tstastny/gists{/gist_id}","starred_url":"https://api.github.com/users/tstastny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tstastny/subscriptions","organizations_url":"https://api.github.com/users/tstastny/orgs","repos_url":"https://api.github.com/users/tstastny/repos","events_url":"https://api.github.com/users/tstastny/events{/privacy}","received_events_url":"https://api.github.com/users/tstastny/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":78699916,"node_id":"MDU6TGFiZWw3ODY5OTkxNg==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Fixed%20Wing%20%F0%9F%9B%A9%EF%B8%8F","name":"Fixed Wing 🛩️","color":"009800","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"tstastny","id":8026163,"node_id":"MDQ6VXNlcjgwMjYxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8026163?v=4","gravatar_id":"","url":"https://api.github.com/users/tstastny","html_url":"https://github.com/tstastny","followers_url":"https://api.github.com/users/tstastny/followers","following_url":"https://api.github.com/users/tstastny/following{/other_user}","gists_url":"https://api.github.com/users/tstastny/gists{/gist_id}","starred_url":"https://api.github.com/users/tstastny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tstastny/subscriptions","organizations_url":"https://api.github.com/users/tstastny/orgs","repos_url":"https://api.github.com/users/tstastny/repos","events_url":"https://api.github.com/users/tstastny/events{/privacy}","received_events_url":"https://api.github.com/users/tstastny/received_events","type":"User","site_admin":false},"assignees":[{"login":"tstastny","id":8026163,"node_id":"MDQ6VXNlcjgwMjYxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8026163?v=4","gravatar_id":"","url":"https://api.github.com/users/tstastny","html_url":"https://github.com/tstastny","followers_url":"https://api.github.com/users/tstastny/followers","following_url":"https://api.github.com/users/tstastny/following{/other_user}","gists_url":"https://api.github.com/users/tstastny/gists{/gist_id}","starred_url":"https://api.github.com/users/tstastny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tstastny/subscriptions","organizations_url":"https://api.github.com/users/tstastny/orgs","repos_url":"https://api.github.com/users/tstastny/repos","events_url":"https://api.github.com/users/tstastny/events{/privacy}","received_events_url":"https://api.github.com/users/tstastny/received_events","type":"User","site_admin":false}],"milestone":null,"comments":0,"created_at":"2023-09-13T07:57:10Z","updated_at":"2023-09-13T15:26:05Z","closed_at":"2023-09-13T15:26:04Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/22074","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22074","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/22074.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/22074.patch","merged_at":"2023-09-13T15:26:04Z"},"body":"Backport of https://github.com/PX4/PX4-Autopilot/pull/21581\r\n\r\n### Changelog Entry\r\nFor release notes:\r\n```\r\nBugfix: initialize fixed-wing takeoff airspeed at correct value, disable airspeed increments except load factor during takeoff\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22074/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22074/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22062","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22062/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22062/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22062/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22062","id":1887776528,"node_id":"PR_kwDOAFDaZs5Z4fzI","number":22062,"title":"[BACKPORT] FixedwingPositionControl: refine / refactor waypoint navigation methods","user":{"login":"tstastny","id":8026163,"node_id":"MDQ6VXNlcjgwMjYxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8026163?v=4","gravatar_id":"","url":"https://api.github.com/users/tstastny","html_url":"https://github.com/tstastny","followers_url":"https://api.github.com/users/tstastny/followers","following_url":"https://api.github.com/users/tstastny/following{/other_user}","gists_url":"https://api.github.com/users/tstastny/gists{/gist_id}","starred_url":"https://api.github.com/users/tstastny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tstastny/subscriptions","organizations_url":"https://api.github.com/users/tstastny/orgs","repos_url":"https://api.github.com/users/tstastny/repos","events_url":"https://api.github.com/users/tstastny/events{/privacy}","received_events_url":"https://api.github.com/users/tstastny/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":{"login":"tstastny","id":8026163,"node_id":"MDQ6VXNlcjgwMjYxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8026163?v=4","gravatar_id":"","url":"https://api.github.com/users/tstastny","html_url":"https://github.com/tstastny","followers_url":"https://api.github.com/users/tstastny/followers","following_url":"https://api.github.com/users/tstastny/following{/other_user}","gists_url":"https://api.github.com/users/tstastny/gists{/gist_id}","starred_url":"https://api.github.com/users/tstastny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tstastny/subscriptions","organizations_url":"https://api.github.com/users/tstastny/orgs","repos_url":"https://api.github.com/users/tstastny/repos","events_url":"https://api.github.com/users/tstastny/events{/privacy}","received_events_url":"https://api.github.com/users/tstastny/received_events","type":"User","site_admin":false},"assignees":[{"login":"tstastny","id":8026163,"node_id":"MDQ6VXNlcjgwMjYxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8026163?v=4","gravatar_id":"","url":"https://api.github.com/users/tstastny","html_url":"https://github.com/tstastny","followers_url":"https://api.github.com/users/tstastny/followers","following_url":"https://api.github.com/users/tstastny/following{/other_user}","gists_url":"https://api.github.com/users/tstastny/gists{/gist_id}","starred_url":"https://api.github.com/users/tstastny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tstastny/subscriptions","organizations_url":"https://api.github.com/users/tstastny/orgs","repos_url":"https://api.github.com/users/tstastny/repos","events_url":"https://api.github.com/users/tstastny/events{/privacy}","received_events_url":"https://api.github.com/users/tstastny/received_events","type":"User","site_admin":false}],"milestone":null,"comments":2,"created_at":"2023-09-08T14:16:55Z","updated_at":"2023-09-12T15:31:19Z","closed_at":"2023-09-12T15:22:23Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/22062","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22062","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/22062.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/22062.patch","merged_at":"2023-09-12T15:22:23Z"},"body":"Backport #21988\r\n\r\n### Changelog Entry\r\nFor release notes:\r\n```\r\nBugfix FixedwingPositionControl: Fixes landing regression where the vehicle could turn back towards the landing point after passing it.\r\nDocumentation: Should update docs.px4.io/ with waypoint logic description and perhaps the figure included above.\r\n```","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22062/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22062/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22060","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22060/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22060/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22060/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22060","id":1886762503,"node_id":"PR_kwDOAFDaZs5Z1DfJ","number":22060,"title":"6x: fix internal mag rotation","user":{"login":"julianoes","id":1419688,"node_id":"MDQ6VXNlcjE0MTk2ODg=","avatar_url":"https://avatars.githubusercontent.com/u/1419688?v=4","gravatar_id":"","url":"https://api.github.com/users/julianoes","html_url":"https://github.com/julianoes","followers_url":"https://api.github.com/users/julianoes/followers","following_url":"https://api.github.com/users/julianoes/following{/other_user}","gists_url":"https://api.github.com/users/julianoes/gists{/gist_id}","starred_url":"https://api.github.com/users/julianoes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/julianoes/subscriptions","organizations_url":"https://api.github.com/users/julianoes/orgs","repos_url":"https://api.github.com/users/julianoes/repos","events_url":"https://api.github.com/users/julianoes/events{/privacy}","received_events_url":"https://api.github.com/users/julianoes/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":5535857183,"node_id":"LA_kwDOAFDaZs8AAAABSfZ6Hw","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/v1.14","name":"v1.14","color":"F9E2EB","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2023-09-08T00:26:31Z","updated_at":"2023-09-11T03:03:34Z","closed_at":"2023-09-11T03:03:33Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/22060","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22060","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/22060.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/22060.patch","merged_at":"2023-09-11T03:03:33Z"},"body":"From looking at the history the BMM150 rotation was initially 0. Then, this was changed to 6 when the intent was to only change it for Skynode.\r\n\r\nA bit later, the rotation was changed back to 0, but only for Skynode.\r\n\r\nThis tells me that rotation 0 was correct for all 6X including Skynode all along.\r\n\r\nTested on my Holybro 6X and 6X mini.\r\n\r\nFixes #22004.\r\n\r\nNeeds backporting to v1.14.\r\n\r\nFYI @baumanta and @marcoraeth.","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22060/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22060/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22058","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22058/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22058/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22058/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22058","id":1886663730,"node_id":"PR_kwDOAFDaZs5Z0tE7","number":22058,"title":"dataman: explicitly check file existance to init","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2023-09-07T22:57:07Z","updated_at":"2023-09-08T14:16:26Z","closed_at":"2023-09-08T14:16:25Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/22058","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22058","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/22058.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/22058.patch","merged_at":"2023-09-08T14:16:25Z"},"body":"On NuttX if the SD card was just cleared (quick format) it's possible for the newly created dataman file to still have the same compatibility key. If the file was created we should always init.","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22058/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22058/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22043","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22043/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22043/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22043/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22043","id":1880972724,"node_id":"PR_kwDOAFDaZs5ZhZia","number":22043,"title":"stm32h7_can: fix filter memory initialization bug.","user":{"login":"duartecdias","id":16549290,"node_id":"MDQ6VXNlcjE2NTQ5Mjkw","avatar_url":"https://avatars.githubusercontent.com/u/16549290?v=4","gravatar_id":"","url":"https://api.github.com/users/duartecdias","html_url":"https://github.com/duartecdias","followers_url":"https://api.github.com/users/duartecdias/followers","following_url":"https://api.github.com/users/duartecdias/following{/other_user}","gists_url":"https://api.github.com/users/duartecdias/gists{/gist_id}","starred_url":"https://api.github.com/users/duartecdias/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/duartecdias/subscriptions","organizations_url":"https://api.github.com/users/duartecdias/orgs","repos_url":"https://api.github.com/users/duartecdias/repos","events_url":"https://api.github.com/users/duartecdias/events{/privacy}","received_events_url":"https://api.github.com/users/duartecdias/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":5535857183,"node_id":"LA_kwDOAFDaZs8AAAABSfZ6Hw","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/v1.14","name":"v1.14","color":"F9E2EB","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2023-09-04T23:56:16Z","updated_at":"2023-09-08T19:29:42Z","closed_at":"2023-09-08T19:29:42Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/22043","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22043","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/22043.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/22043.patch","merged_at":"2023-09-08T19:29:42Z"},"body":"While testing the reception of the feedback from KDECAN ESCs in the following public branch (https://github.com/duartecdias/PX4-Autopilot/tree/pr/uavcan/kdecanProtocol), it was noted that while using standard ids, some messages were not being received from the ESCs in a random fashion for different power cycles.\r\n\r\nProblem was tracked down to the initialization of the filters (probably they are being initialized randomly at each power cycle). After proper memset of the respective filter areas the problem went away.\r\n\r\nAlso adjusted the number of maximum filters for extended IDs to 64, according to the h7 chip datasheet.","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22043/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22043/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22009","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22009/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22009/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22009/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22009","id":1867833891,"node_id":"PR_kwDOAFDaZs5Y1kKm","number":22009,"title":"Fix BATTERY_STATUS voltage reporting","user":{"login":"julianoes","id":1419688,"node_id":"MDQ6VXNlcjE0MTk2ODg=","avatar_url":"https://avatars.githubusercontent.com/u/1419688?v=4","gravatar_id":"","url":"https://api.github.com/users/julianoes","html_url":"https://github.com/julianoes","followers_url":"https://api.github.com/users/julianoes/followers","following_url":"https://api.github.com/users/julianoes/following{/other_user}","gists_url":"https://api.github.com/users/julianoes/gists{/gist_id}","starred_url":"https://api.github.com/users/julianoes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/julianoes/subscriptions","organizations_url":"https://api.github.com/users/julianoes/orgs","repos_url":"https://api.github.com/users/julianoes/repos","events_url":"https://api.github.com/users/julianoes/events{/privacy}","received_events_url":"https://api.github.com/users/julianoes/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":5535857183,"node_id":"LA_kwDOAFDaZs8AAAABSfZ6Hw","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/v1.14","name":"v1.14","color":"F9E2EB","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2023-08-26T01:02:30Z","updated_at":"2023-09-11T03:16:37Z","closed_at":"2023-08-29T11:23:56Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/22009","html_url":"https://github.com/PX4/PX4-Autopilot/pull/22009","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/22009.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/22009.patch","merged_at":"2023-08-29T11:23:55Z"},"body":"This fixes two issues with voltage reporting in BATTERY_STATUS:\r\n\r\n1. The extension fields need to be 0 by default according to the MAVLink spec. This is because extensions are 0 by default and need to be 0 when unknown/unused for backwards compatibility.\r\n\r\n2. If the measured voltage is more than 65v we need to split the voltage over multiple cells in order to avoid overflowing the uint16. This is according to the MAVLink spec.\r\n\r\nNeeds backporting to v1.14.\r\n\r\nProbably best reviewed commit by commit.\r\n\r\nTested using a Pixhawk 6C with power module and playing with the voltage divider.\r\n\r\nThis was found by @reedev after https://github.com/mavlink/MAVSDK/pull/2114.","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22009/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/22009/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21994","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21994/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21994/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21994/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21994","id":1862749294,"node_id":"PR_kwDOAFDaZs5YkSmH","number":21994,"title":"Control Allocation: fixes in yaw saturation detection for vehicles with tilt-for-yaw","user":{"login":"sfuhrer","id":26798987,"node_id":"MDQ6VXNlcjI2Nzk4OTg3","avatar_url":"https://avatars.githubusercontent.com/u/26798987?v=4","gravatar_id":"","url":"https://api.github.com/users/sfuhrer","html_url":"https://github.com/sfuhrer","followers_url":"https://api.github.com/users/sfuhrer/followers","following_url":"https://api.github.com/users/sfuhrer/following{/other_user}","gists_url":"https://api.github.com/users/sfuhrer/gists{/gist_id}","starred_url":"https://api.github.com/users/sfuhrer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfuhrer/subscriptions","organizations_url":"https://api.github.com/users/sfuhrer/orgs","repos_url":"https://api.github.com/users/sfuhrer/repos","events_url":"https://api.github.com/users/sfuhrer/events{/privacy}","received_events_url":"https://api.github.com/users/sfuhrer/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2023-08-23T07:37:20Z","updated_at":"2023-08-24T11:59:00Z","closed_at":"2023-08-24T11:58:59Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/21994","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21994","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/21994.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/21994.patch","merged_at":"2023-08-24T11:58:59Z"},"body":"\r\n\r\n### Solved Problem\r\nVTOL Tiltrotors require a special yaw saturation detection. Simply looking at whether there is unallocated yaw torque leads to almost constant saturation reporting, as often one of the tilts is saturated (they usually can't tilt backwards). I patched this previously in https://github.com/PX4/PX4-Autopilot/pull/20518, where I simply declared the yaw saturated if the torque setpoint was saturated. Given that there is also a  collective tilt this assumption is quite rough. \r\n\r\nWhile flying a tricopter with sideways tiltable tail I further noticed that there the reported unallocated yaw was never 0, while the tilt servo clearly never reached saturation:\r\n![image](https://github.com/PX4/PX4-Autopilot/assets/26798987/df0456de-22ca-494c-81bd-56d21a6e2725)\r\nI didn't investigate further why the unallocated torque calculation is so wrong, but given that MC tilt vehicles would anyway have the same issues as VTOL tiltrotor if they have tilts that only tilt in one direction, it makes sense to me to customize the saturation handling anyway also for them.\r\n\r\n### Solution\r\nCustomize yaw saturation detection for VTOL tiltrotor and MC tilts. Taking the sign of the yaw effectiveness of the corresponding tilt into account, check if the tilt is at the min or max value and set the positive or negative saturation flag if all the tilts are saturated in this direction. \r\n\r\n### Changelog Entry\r\nFor release notes:\r\n```\r\nBugfix: fix yaw saturation logic for tilting motors (tiltrotor VTOL and MC with tilts)\r\n```\r\n\r\n### Alternatives\r\nExtend it to have it generic for all axis with tilt actuation. I wonder though if we also should first remove the tilts from the effectiveness matrix and do custom allocation of them (something similar to what is done in the Helicopter allocation).\r\n\r\n### Test coverage\r\nSITL tested (tiltrotor). \r\n\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21994/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21994/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21990","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21990/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21990/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21990/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21990","id":1861098347,"node_id":"PR_kwDOAFDaZs5YerL1","number":21990,"title":"TiltrotorEffectiveness: limit thrust axis tilt to z effectiveness scaling","user":{"login":"sfuhrer","id":26798987,"node_id":"MDQ6VXNlcjI2Nzk4OTg3","avatar_url":"https://avatars.githubusercontent.com/u/26798987?v=4","gravatar_id":"","url":"https://api.github.com/users/sfuhrer","html_url":"https://github.com/sfuhrer","followers_url":"https://api.github.com/users/sfuhrer/followers","following_url":"https://api.github.com/users/sfuhrer/following{/other_user}","gists_url":"https://api.github.com/users/sfuhrer/gists{/gist_id}","starred_url":"https://api.github.com/users/sfuhrer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfuhrer/subscriptions","organizations_url":"https://api.github.com/users/sfuhrer/orgs","repos_url":"https://api.github.com/users/sfuhrer/repos","events_url":"https://api.github.com/users/sfuhrer/events{/privacy}","received_events_url":"https://api.github.com/users/sfuhrer/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":249514594,"node_id":"MDU6TGFiZWwyNDk1MTQ1OTQ=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Hybrid%20VTOL%20%F0%9F%9B%A9%EF%B8%8F%F0%9F%9A%81","name":"Hybrid VTOL 🛩️🚁","color":"bfe5bf","default":false,"description":"Multirotor + Fixedwing!"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2023-08-22T09:56:44Z","updated_at":"2023-08-25T12:45:16Z","closed_at":"2023-08-25T12:45:15Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/21990","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21990","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/21990.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/21990.patch","merged_at":"2023-08-25T12:45:15Z"},"body":"\r\n### Solved Problem\r\nTwo related issues and fixes:\r\n- During transition to FW, only allow update thrust axis up to 45° as with a high tilt angle the effectiveness of the thrust axis in z is approaching 0, and by that is increasing the motor output to max. As the vehicle picks up airspeed during the transition and with that the wings start to generate lift, it is not required to produce the same about of vertical thrust as in pure hover.\r\n- Transition to HF: disable thrust axis tilting, and assume motors are vertical. This is to avoid a thrust spike when the transition is initiated (as then the tilt is fully forward). \r\n\r\nBefore this PR (notice the thrust spikes when the vehicle is still in transition phases with the collective tilt being almost at horizontal):\r\n![image](https://github.com/PX4/PX4-Autopilot/assets/26798987/1822cee0-eca4-4874-b85a-d2a72aaf423b)\r\n\r\nAfter this PR (note how the thrust spikes during front transition are reduced, and completely gone during the backtransition):\r\n![image](https://github.com/PX4/PX4-Autopilot/assets/26798987/e4247e5e-fede-4bd7-82a9-cfd8cb2f215c)\r\n\r\n### Changelog Entry\r\nFor release notes:\r\n```\r\nBugfix: VTOL tiltrotor: limit the thrust compensation due to non-vertical motors in transition phases.\r\n```\r\n\r\n\r\n### Test coverage\r\nFlight tested.\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21990/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21990/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21988","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21988/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21988/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21988/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21988","id":1860025090,"node_id":"PR_kwDOAFDaZs5Ya_C4","number":21988,"title":"FixedwingPositionControl: refine / refactor waypoint navigation methods","user":{"login":"tstastny","id":8026163,"node_id":"MDQ6VXNlcjgwMjYxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8026163?v=4","gravatar_id":"","url":"https://api.github.com/users/tstastny","html_url":"https://github.com/tstastny","followers_url":"https://api.github.com/users/tstastny/followers","following_url":"https://api.github.com/users/tstastny/following{/other_user}","gists_url":"https://api.github.com/users/tstastny/gists{/gist_id}","starred_url":"https://api.github.com/users/tstastny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tstastny/subscriptions","organizations_url":"https://api.github.com/users/tstastny/orgs","repos_url":"https://api.github.com/users/tstastny/repos","events_url":"https://api.github.com/users/tstastny/events{/privacy}","received_events_url":"https://api.github.com/users/tstastny/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":78699916,"node_id":"MDU6TGFiZWw3ODY5OTkxNg==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Fixed%20Wing%20%F0%9F%9B%A9%EF%B8%8F","name":"Fixed Wing 🛩️","color":"009800","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"tstastny","id":8026163,"node_id":"MDQ6VXNlcjgwMjYxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8026163?v=4","gravatar_id":"","url":"https://api.github.com/users/tstastny","html_url":"https://github.com/tstastny","followers_url":"https://api.github.com/users/tstastny/followers","following_url":"https://api.github.com/users/tstastny/following{/other_user}","gists_url":"https://api.github.com/users/tstastny/gists{/gist_id}","starred_url":"https://api.github.com/users/tstastny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tstastny/subscriptions","organizations_url":"https://api.github.com/users/tstastny/orgs","repos_url":"https://api.github.com/users/tstastny/repos","events_url":"https://api.github.com/users/tstastny/events{/privacy}","received_events_url":"https://api.github.com/users/tstastny/received_events","type":"User","site_admin":false},"assignees":[{"login":"tstastny","id":8026163,"node_id":"MDQ6VXNlcjgwMjYxNjM=","avatar_url":"https://avatars.githubusercontent.com/u/8026163?v=4","gravatar_id":"","url":"https://api.github.com/users/tstastny","html_url":"https://github.com/tstastny","followers_url":"https://api.github.com/users/tstastny/followers","following_url":"https://api.github.com/users/tstastny/following{/other_user}","gists_url":"https://api.github.com/users/tstastny/gists{/gist_id}","starred_url":"https://api.github.com/users/tstastny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tstastny/subscriptions","organizations_url":"https://api.github.com/users/tstastny/orgs","repos_url":"https://api.github.com/users/tstastny/repos","events_url":"https://api.github.com/users/tstastny/events{/privacy}","received_events_url":"https://api.github.com/users/tstastny/received_events","type":"User","site_admin":false}],"milestone":null,"comments":5,"created_at":"2023-08-21T19:42:34Z","updated_at":"2023-09-28T12:02:58Z","closed_at":"2023-09-08T14:08:39Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/21988","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21988","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/21988.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/21988.patch","merged_at":"2023-09-08T14:08:39Z"},"body":"<!--\r\n\r\nThank you for your contribution!\r\n\r\nGet early feedback through\r\n- Dronecode Discord: https://discord.gg/dronecode\r\n- PX4 Discuss: http://discuss.px4.io/\r\n- opening a draft pr and sharing the link\r\n\r\n-->\r\n\r\n### Solved Problem\r\nhttps://github.com/PX4/PX4-Autopilot/issues/21358#issuecomment-1683501042 (from #21358) reported turn around behavior after passing the land point during a fixed-wing autolanding. Sure enough - the vehicle was indeed hard turning just past the land point. this is dangerous behavior, and should not happen.\r\n\r\nTurns out to be a regression made after merging #21635. The intent of #21635 was to safe guard waypoint navigation logic from vehicle runaways once past the target waypoint (caused in rare cases by race conditions with the Navigator module). The solution was to add logic to turn back to the target waypoint once past, with the nominal behavior being that this condition is never entered due to acceptance radius based switching logic triggering in the Navigator before the condition was ever reached.\r\n\r\nWhat was missed, however, is that the `navigateWaypoints()` method was also used in auto takeoff and landing modes.\r\n\r\nFurther, both the logged value and input argument to npfg of the instantaneous position setpoint calculated in the `navigateWaypoints()` method also had an error here when `desired_path` was set to the vector from vehicle to waypoint (the direct fly-to case), leading to erroneous guidance commands:\r\nhttps://github.com/PX4/PX4-Autopilot/blob/22e613a24ab142876d69fbd068768f596fbd933d/src/modules/fw_pos_control/FixedwingPositionControl.cpp#L2879C56-L2882\r\n```cpp\r\nVector2f unit_path_tangent{desired_path.normalized()};\r\n_target_bearing = atan2f(unit_path_tangent(1), unit_path_tangent(0));\r\n_closest_point_on_path = waypoint_A + vector_A_to_vehicle.dot(unit_path_tangent) * unit_path_tangent;\r\n_npfg.guideToPath(vehicle_pos, ground_vel, wind_vel, unit_path_tangent, waypoint_A, 0.0f);\r\n```\r\n\r\nThe result in the \"past the waypoint\" case of the logged instantaneous position setpoint can be seen below:\r\n![image](https://github.com/PX4/PX4-Autopilot/assets/8026163/ca90f9fd-192e-4da9-80f1-fb4bc23f8d8e)\r\n\r\nIt was additionally found during the investigation that the `signed_track_error` from NPFG was not getting logged due to a mistaken removal of this internal variable during a refactor.\r\n\r\n### Solution\r\nBreak `navigateWaypoints()` into `navigateLine()` and `navigateWaypoint()`.\r\n\r\n`navigateLine()` follows an infinite line defined by either two points on the path, or a point on the path and bearing of the path (two method overloads). This method is used for auto takeoff and landing logic.\r\n\r\n`navigateWaypoint()` specifically handles the case where there is a single waypoint to fly-to. If no higher level state machine makes a switch before the vehicle reaches the waypoint, it will result in \"flowering\" behavior.\r\n\r\n`navigateWaypoints()` is now only used where the entry and exit behaviors to a line segment described by two waypoints are desired, such as in nominal waypoint navigation. The figure below details each region and the corresponding approach vector that is generated according to the logic in the method.\r\n![waypoint_logic (1)](https://github.com/PX4/PX4-Autopilot/assets/8026163/9f3f2486-3133-47e7-9fe2-399f544e2ebc)\r\n\r\nThe methods have also been refined and more explicitly interfaced / documented. Further, the `controlAutoPosition()` and `controlAutoTakeoff()` methods have benefited from some clean up, to make things slightly easier to follow.\r\n\r\nFunction briefs were also noticed out of date, and updated.\r\n\r\n### Changelog Entry\r\nFor release notes:\r\n```\r\nBugfix FixedwingPositionControl: Fixes landing regression where the vehicle could turn back towards the landing point after passing it.\r\nDocumentation: Should update docs.px4.io/ with waypoint logic description and perhaps the figure included above.\r\n```\r\n\r\n### Test coverage\r\nSee in a SITL simulation that the waypoint switching behaves in the nominal manner, the logged instantaneous position setpoint corresponds to the correct targets, and when the vehicle is past the land point, it continues to follow the infinite line.\r\n![past_land_point](https://github.com/PX4/PX4-Autopilot/assets/8026163/391195ff-cc6a-4f08-a401-dc399cdd8cab)\r\n\r\n### Backport needed?\r\nyes. to v1.14.\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21988/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21988/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21966","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21966/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21966/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21966/events","html_url":"https://github.com/PX4/PX4-Autopilot/issues/21966","id":1851427873,"node_id":"I_kwDOAFDaZs5uWowh","number":21966,"title":"[MASSIVE REGRESSION] Support for DO_SET_ACUTUATOR and DO_SET_SERVO MAVLink commands","user":{"login":"junwoo091400","id":23277211,"node_id":"MDQ6VXNlcjIzMjc3MjEx","avatar_url":"https://avatars.githubusercontent.com/u/23277211?v=4","gravatar_id":"","url":"https://api.github.com/users/junwoo091400","html_url":"https://github.com/junwoo091400","followers_url":"https://api.github.com/users/junwoo091400/followers","following_url":"https://api.github.com/users/junwoo091400/following{/other_user}","gists_url":"https://api.github.com/users/junwoo091400/gists{/gist_id}","starred_url":"https://api.github.com/users/junwoo091400/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/junwoo091400/subscriptions","organizations_url":"https://api.github.com/users/junwoo091400/orgs","repos_url":"https://api.github.com/users/junwoo091400/repos","events_url":"https://api.github.com/users/junwoo091400/events{/privacy}","received_events_url":"https://api.github.com/users/junwoo091400/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":4147335155,"node_id":"LA_kwDOAFDaZs73M0_z","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/feature-request","name":"feature-request","color":"CC35AC","default":false,"description":""}],"state":"open","locked":false,"assignee":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"assignees":[{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},{"login":"Jaeyoung-Lim","id":5248102,"node_id":"MDQ6VXNlcjUyNDgxMDI=","avatar_url":"https://avatars.githubusercontent.com/u/5248102?v=4","gravatar_id":"","url":"https://api.github.com/users/Jaeyoung-Lim","html_url":"https://github.com/Jaeyoung-Lim","followers_url":"https://api.github.com/users/Jaeyoung-Lim/followers","following_url":"https://api.github.com/users/Jaeyoung-Lim/following{/other_user}","gists_url":"https://api.github.com/users/Jaeyoung-Lim/gists{/gist_id}","starred_url":"https://api.github.com/users/Jaeyoung-Lim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Jaeyoung-Lim/subscriptions","organizations_url":"https://api.github.com/users/Jaeyoung-Lim/orgs","repos_url":"https://api.github.com/users/Jaeyoung-Lim/repos","events_url":"https://api.github.com/users/Jaeyoung-Lim/events{/privacy}","received_events_url":"https://api.github.com/users/Jaeyoung-Lim/received_events","type":"User","site_admin":false}],"milestone":null,"comments":9,"created_at":"2023-08-15T13:16:36Z","updated_at":"2023-11-14T17:41:49Z","closed_at":null,"author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"### Describe problem solved by the proposed feature\n\nI have noted that a lot of users (e.g. https://discuss.px4.io/t/using-do-set-actuator-to-releasing-the-payload/28686) were asking for ways to control the servo, or an actuator via the DO_SET_ACTUATOR/SERVO messages coming from an external entity (e.g. onboard computer).\r\n\r\nThis definitely sounds like a basic feature that we should support, as it can be used for all kinds of applications that controls *any sort of actuator onboard the drone,\r\n\r\nAs we now have the `Actuators` and `Servos` concept in place with control allocation, it should be pretty straightforward to implement, I think.\n\n### Describe your preferred solution\n\nAdd the logic in `mavlink_receiver.cpp` like was done in v1.13:\r\n\r\nhttps://github.com/PX4/PX4-Autopilot/blob/1c8ab2a0d7db2d14a6f320ebd8766b5ffaea28fa/src/modules/mavlink/mavlink_receiver.cpp#L554-L586\n\n### Describe possible alternatives\n\nNone\n\n### Additional context\n\nI have posted a bit of history behind the support for these commands here: https://discuss.px4.io/t/using-do-set-actuator-to-releasing-the-payload/28686/3, however, to summarize:\r\n\r\n1. This feature was supported in v1.13 ([related comment](https://github.com/PX4/PX4-Autopilot/pull/18265#issuecomment-923681920)), and was utilizing control groups convention (which was removed after complete switch to control allocation in v1.14)\r\n2. It was then removed when purging old mixer system (using control groups, etc): https://github.com/PX4/PX4-Autopilot/commit/13f9eabd70de2038330e89ab46d5cb3f1cde38ec\r\n\r\nTherefore, I would say this was an accidental deletion and the feature should be put back in place.","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21966/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21966/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21781","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21781/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21781/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21781/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21781","id":1782248416,"node_id":"PR_kwDOAFDaZs5UURVY","number":21781,"title":"Do not handle yaw stick multiple times in Altitude and Position mode","user":{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":78699954,"node_id":"MDU6TGFiZWw3ODY5OTk1NA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Multirotor%20%F0%9F%9B%B8","name":"Multirotor 🛸","color":"0052cc","default":false,"description":""},{"id":803319897,"node_id":"MDU6TGFiZWw4MDMzMTk4OTc=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/cleanup%20(housekeeping)%20%F0%9F%A7%B9","name":"cleanup (housekeeping) 🧹","color":"aefcbd","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false},"assignees":[{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false}],"milestone":null,"comments":0,"created_at":"2023-06-30T09:58:01Z","updated_at":"2023-07-03T07:58:14Z","closed_at":"2023-07-03T07:52:47Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/21781","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21781","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/21781.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/21781.patch","merged_at":"2023-07-03T07:52:47Z"},"body":"### Solved Problem\r\nWhen helping @marcinolokk with a new slower Position mode input feature I realized that there is quite some duplication in yaw handling over `FlightTaskManualAltitude` and `FlightTaskManualAcceleration`.\r\n\r\nI had unified the handling in the `StickYaw` class in https://github.com/PX4/PX4-Autopilot/pull/21192 but apparently did not follow through and only use it once for all cases.\r\n\r\n### Solution\r\n- Remove forgotten parameter metadata trailing zeroes from https://github.com/PX4/PX4-Autopilot/pull/21729 (FYI @sfuhrer)\r\n- Remove duplicate instantiation and call to the `StickYaw` class in `FlightTaskManaulAcceleration`. It inherits the instance from `FlightTaskManualAltitude` and also calls the update by running `FlightTaskManualAltitude`'s update already.\r\n- Remove all the legacy yaw handling from `FlightTaskManualAltitude` which was replaced by the unified `StickYaw` class.\r\n\r\n### Changelog Entry\r\nThe user should not notice a difference although this is a bug.\r\n```\r\nCleanup: Do not handle yaw stick multiple times in Altitude and Position mode.\r\n```\r\n\r\n### Test coverage\r\n- Simulation testing: I went through all the Altitude and Position mode variants with the `MPC_POS_MODE` settings and verified the yaw stick input still works. Now it must always be using the `StickYaw` class in `FlightTaskManualAltitude` only.","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21781/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21781/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21775","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21775/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21775/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21775/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21775","id":1780750806,"node_id":"PR_kwDOAFDaZs5UPPHf","number":21775,"title":"Navigator: Loiter: always establish new Loiter with center at current position","user":{"login":"sfuhrer","id":26798987,"node_id":"MDQ6VXNlcjI2Nzk4OTg3","avatar_url":"https://avatars.githubusercontent.com/u/26798987?v=4","gravatar_id":"","url":"https://api.github.com/users/sfuhrer","html_url":"https://github.com/sfuhrer","followers_url":"https://api.github.com/users/sfuhrer/followers","following_url":"https://api.github.com/users/sfuhrer/following{/other_user}","gists_url":"https://api.github.com/users/sfuhrer/gists{/gist_id}","starred_url":"https://api.github.com/users/sfuhrer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfuhrer/subscriptions","organizations_url":"https://api.github.com/users/sfuhrer/orgs","repos_url":"https://api.github.com/users/sfuhrer/repos","events_url":"https://api.github.com/users/sfuhrer/events{/privacy}","received_events_url":"https://api.github.com/users/sfuhrer/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":78699916,"node_id":"MDU6TGFiZWw3ODY5OTkxNg==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Fixed%20Wing%20%F0%9F%9B%A9%EF%B8%8F","name":"Fixed Wing 🛩️","color":"009800","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2023-06-29T12:43:22Z","updated_at":"2023-07-04T07:35:42Z","closed_at":"2023-07-04T07:35:41Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/21775","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21775","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/21775.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/21775.patch","merged_at":"2023-07-04T07:35:41Z"},"body":"### Solved Problem\r\nhttps://github.com/PX4/PX4-Autopilot/issues/21702\r\n\r\nVehicle keeps flying towards Loiter waypoint if Hold mode is selected. In the past we within Navigator set the type to POSITION when far away from a Loiter waypoint, and then only to LOITER when really on established loiter, but this distinction is now no longer part of Navigator and the FW position controller handles it.\r\n\r\n### Solution\r\nWhen switching into Hold mode establish a Loiter around current position, even if we were before already loitering (eg in Mission mode). This results in the same behavior when switching into Hold/Loiter mode directly (either through RC switch or in the flight mode selection in QGC) or through the \"Hold\" button in QGC (which sends a DO_REPOSITION with the fields at the current position). \r\n\r\nIn this screen recording you see the behavior prior and after this PR.\r\nhttps://github.com/PX4/PX4-Autopilot/assets/26798987/9079b575-77fc-40a2-be54-b3c11816cca3\r\n\r\n### Changelog Entry\r\nFor release notes:\r\n```\r\nBugfix: Fixed-wing: Always establish loiter around current position when switching into Hold mode\r\n```\r\n\r\n\r\n### Alternatives\r\nFix detection on whether we're currently on an established loiter, and in that case don't loiter around current position but keep established loiter. Personally I though prefer to stick to Hold = Loiter around current position always. Imagine being on a huge loiter. If the vehicle then keeps following it it's hardly anymore \"Holding position\". \r\n\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21775/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21775/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21690","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21690/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21690/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21690/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21690","id":1743917793,"node_id":"PR_kwDOAFDaZs5STwYR","number":21690,"title":"Motor output ramp consistent for higher than minimum initial motor command","user":{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false},"assignees":[{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false}],"milestone":null,"comments":0,"created_at":"2023-06-06T13:48:40Z","updated_at":"2023-06-10T06:48:43Z","closed_at":"2023-06-10T01:15:08Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/21690","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21690","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/21690.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/21690.patch","merged_at":"2023-06-10T01:15:08Z"},"body":"### Solved Problem\r\nWhen integrating a product with PWM ESCs I found that the current PWM ramp is suboptimal:\r\n\r\nExcpected: When the mixed motor command is exactly the minimum during the ramp time it ramps from the disarmed PWM value to the minimum PWM value.\r\n\r\nUnexpected: When the mixed motor command is even just slightly higher than the minimum the ramp jumps up to a higher value than the disarmed PWM value and then ramps from there to the commanded throttle scaled between minimum PWM and maximum PWM. Additionally the first time a vehicle is armed after boot there is a 50 millisecond delay until the ramp actually starts.\r\n<img width=\"1598\" alt=\"ramp before\" src=\"https://github.com/PX4/PX4-Autopilot/assets/4668506/b6493c74-3447-4296-9678-94bd505715ce\">\r\n\r\n### Solution\r\n- Replace the complicated ramp calculation with a simpler one that fades the current motor command in with a scale ramping from 0 to 1.\r\n- Remove the ancient init state of the ramp state machine that was introduced in https://github.com/PX4/PX4-Autopilot/commit/cc452834c0dabd2689f5f102ce1cbbe714f056dd#diff-53cf9e4cbf5fe3dc0c623b0be8c562859b714628e061dcfb548c4690311b18d3R186-R195 presumably as a workaround for some specific timing problem in the very very early days. And possibly just produced confusion later on at least for me.\r\n\r\nAs a result the ramp always starts immediately after arming from the disarmed PWM value and ends at the commanded throttle scaled between minimum PWM and maximum PWM. If the commanded throttle changes during the ramp then the scale and hence also end value of the ramp changes.\r\n<img width=\"1605\" alt=\"ramp after\" src=\"https://github.com/PX4/PX4-Autopilot/assets/4668506/9c0f2b96-4117-4db0-a1b7-dd8a1ad08372\">\r\n\r\n### Changelog Entry\r\nFor release notes:\r\n```\r\nBugfix: Make arming motor output ramp consistent for higher than minimum initial motor command\r\n```\r\n\r\n### Alternatives\r\nI'm thinking about removing the output ramp on arming completely but this will come as a separate pr and requires more testing.\r\n\r\n### Test coverage\r\n- [x] Check if the disarmed value can ever be not set. I saw that we rely on the disarmed value everywhere in the mixer_module and also the PWM drivers set it correctly even if there's just a default disarmed value for all channels.\r\n- [x] Check functionality when the disarmed value is higher than the minimum value. It then ramps down instead of up but still works.\r\n- [x] Check functionality with a reversed output. It ramps from the disarmed value (default 900) up to the reversed throttle value (close to 2000). If the disarmed value is customized to e.g. 2100 then it ramps down so even if I've never seen this case that works. My guess from reading the previous implementation is that this never worked despite extra case handling.\r\n- I bench-tested this solution on two vehicles with PWM ESCs.\r\n\r\n### Context\r\nSince https://github.com/PX4/PX4-Autopilot/pull/20031 the throttle even with no roll and pitch torques is not necessarily zero when arming but directly starts at the configured minimum throttle in multicopter modes that have manual throttle control. Also https://github.com/PX4/PX4-Autopilot/pull/21010 can add additional non-zero motor commands while arming.\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21690/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21690/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21635","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21635/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21635/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21635/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21635","id":1723966913,"node_id":"PR_kwDOAFDaZs5RPy4o","number":21635,"title":"FW Position Controller: navigateWaypoint(): fix corner case of vehicle not turning back to waypoint","user":{"login":"sfuhrer","id":26798987,"node_id":"MDQ6VXNlcjI2Nzk4OTg3","avatar_url":"https://avatars.githubusercontent.com/u/26798987?v=4","gravatar_id":"","url":"https://api.github.com/users/sfuhrer","html_url":"https://github.com/sfuhrer","followers_url":"https://api.github.com/users/sfuhrer/followers","following_url":"https://api.github.com/users/sfuhrer/following{/other_user}","gists_url":"https://api.github.com/users/sfuhrer/gists{/gist_id}","starred_url":"https://api.github.com/users/sfuhrer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfuhrer/subscriptions","organizations_url":"https://api.github.com/users/sfuhrer/orgs","repos_url":"https://api.github.com/users/sfuhrer/repos","events_url":"https://api.github.com/users/sfuhrer/events{/privacy}","received_events_url":"https://api.github.com/users/sfuhrer/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":78699916,"node_id":"MDU6TGFiZWw3ODY5OTkxNg==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Fixed%20Wing%20%F0%9F%9B%A9%EF%B8%8F","name":"Fixed Wing 🛩️","color":"009800","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2023-05-24T13:13:35Z","updated_at":"2023-05-26T13:12:44Z","closed_at":"2023-05-26T13:12:43Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/21635","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21635","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/21635.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/21635.patch","merged_at":"2023-05-26T13:12:43Z"},"body":"### Solved Problem\r\n\r\nFixes https://github.com/PX4/PX4-Autopilot/issues/21327\r\n\r\nVehicle fly away when the currently active WP is the current vehicle position, relative to the line from previous to next waypoint. That happens e.g. when the vehicle loitered to achieve altitude and is then \"passed\" the current WP when the altitude is accepted. \r\n![image](https://github.com/PX4/PX4-Autopilot/assets/26798987/443a40e0-aad1-4d51-a0e5-3ec680cff222)\r\n\r\n\r\n### Solution\r\nThere was already logic in place that handled the case of the vehicle being behind the previous WP, but no one where the vehicle is ahead of the current WP. I added that now. The logic changes the guidance from tracking a path between two WP to fly directly to the active WP.\r\n\r\n~Further, in the second commit I removed the check for \"if further than acceptance from waypoint\" to apply the special handling. It seems dangerous to me to keep it, what happens if Navigator doesn't accept the WP once within this acceptance radius? In my eyes we should always fly straight to the waypoint instead of doing path following in this case.~ EDIT: removed this change again.\r\n\r\n### Changelog Entry\r\nFor release notes:\r\n```\r\nBugfix FW Position Controller: navigateWaypoint(): fix corner case of vehicle not turning back to waypoint\r\n```\r\n\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21635/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21635/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21634","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21634/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21634/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21634/events","html_url":"https://github.com/PX4/PX4-Autopilot/issues/21634","id":1723521708,"node_id":"I_kwDOAFDaZs5mutqs","number":21634,"title":"[WIP] PWM calibration problem","user":{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false},"assignees":[{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false}],"milestone":null,"comments":3,"created_at":"2023-05-24T09:09:31Z","updated_at":"2023-06-16T10:05:49Z","closed_at":"2023-06-16T10:05:49Z","author_association":"MEMBER","active_lock_reason":null,"body":"## Describe the bug\r\nPWM calibration has to work and calibrate between 1000 and 2000us for the 1.14 release. This together with the new actuator configuration, control allocation and https://github.com/PX4/PX4-Autopilot/pull/21513 will give a much better user experience. If it's not all available for the release then people switching to the release and reconfiguring their actuators with the new mixing will have to go through recalibrating and reconfiguring their actuators again.\r\n\r\n## Expected behavior\r\n1. Press PWM calibration button or call corresponding command in shell\r\n2. Warning to remove props and instructions to unplug battery (accessible option to abort)\r\n3. After user confirms output exactly 2000us PWM for all motors only\r\n4. Instructions for the user to plug battery/power ESCs (without props!) (accessible option to immediately continue)\r\n5. After user confirms output exactly 1000us PWM for all motors\r\n6. Wait 4 seconds\r\n7. Go back to configured disarmed PWM output\r\n8. Inform the user about the finished process\r\n\r\n## To Reproduce\r\nI tested PWM calibration on a pixhwak 4 mini and found multiple issues:\r\n1. The PWM outputs go high immediately after pressing the calibration button even with the battery connected and there is no way to abort again. If I'd have any props on ☠️ \r\n2. I can't possibly complete the procedure without having an auto-detected battery.\r\n3. Upon ESC calibration timeout the PWM output stays on the high value until I reboot PX4\r\n    - Not debugged yet\r\n4. The highest and lowest value of the PWM calibration corresponds to the configured minimum and maximum PWM value that is used in flight so the idle PWM and the PWM value from which the motor doesn't accelerate anymore instead of 1000 and 2000us.\r\n    - We need to use the consistent, well-defined limits for the calibration case.\r\n5. The battery getting connected is not recognized even though I have a power module that worked in this exact hardware configuration before and its voltage goes above the threshold when I plug the battery but for some reason the board reports zero \"valid bricks\".\r\n    - Connected stays false because `is_valid()` is false for both ADCs of which the first one would report the correct battery voltage (the second ADC reports 9.5 volts): https://github.com/PX4/PX4-Autopilot/blob/822d7843359bd400494bdf2684df91c75866d712/src/modules/battery_status/analog_battery.cpp#L79-L80\r\n    - \"valid bricks\" is zero/false for both of the two ADCs because this apparently results in 0 for both lines: https://github.com/PX4/PX4-Autopilot/blob/822d7843359bd400494bdf2684df91c75866d712/boards/px4/fmu-v5/src/board_config.h#L390-L391\r\n    - I quickly checked on a pixracer and on a pixhawk 4 board with main from two weeks ago and they properly detect the battery with an ADC power module while I remember my pixhawk 4 mini had issues with the battery not showing up in the UI already then. So it must be board specific.","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21634/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21634/timeline","performed_via_github_app":null,"state_reason":"completed"},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21608","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21608/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21608/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21608/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21608","id":1716417943,"node_id":"PR_kwDOAFDaZs5Q2UTS","number":21608,"title":"mavlink: allow UDP client to reconnect","user":{"login":"julianoes","id":1419688,"node_id":"MDQ6VXNlcjE0MTk2ODg=","avatar_url":"https://avatars.githubusercontent.com/u/1419688?v=4","gravatar_id":"","url":"https://api.github.com/users/julianoes","html_url":"https://github.com/julianoes","followers_url":"https://api.github.com/users/julianoes/followers","following_url":"https://api.github.com/users/julianoes/following{/other_user}","gists_url":"https://api.github.com/users/julianoes/gists{/gist_id}","starred_url":"https://api.github.com/users/julianoes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/julianoes/subscriptions","organizations_url":"https://api.github.com/users/julianoes/orgs","repos_url":"https://api.github.com/users/julianoes/repos","events_url":"https://api.github.com/users/julianoes/events{/privacy}","received_events_url":"https://api.github.com/users/julianoes/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":1450324872,"node_id":"MDU6TGFiZWwxNDUwMzI0ODcy","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Communication%20(MAVLink)%20%F0%9F%93%A1","name":"Communication (MAVLink) 📡","color":"f66608","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2023-05-18T23:58:07Z","updated_at":"2023-11-18T18:58:07Z","closed_at":"2023-11-18T18:58:03Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":true,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/21608","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21608","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/21608.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/21608.patch","merged_at":null},"body":"This handles the case where a UDP client disappears and then comes back with a different source address.\r\n\r\nIt's a bit of a weird pattern to connect to PX4 directly to the local address (e.g. 18570) instead of listening on 14550 or 14540, however, it can make connections in certain use cases easier, e.g. through docker.\r\n\r\nThe change is not very pretty and I'm not sure about the side effects for other UDP setups. It might warrant a broader change.\r\n\r\nThis came up in https://discuss.px4.io/t/mavsdk-server-udp-connection-requires-px4-restart/32228/13.","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21608/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21608/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21590","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21590/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21590/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21590/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21590","id":1709644459,"node_id":"PR_kwDOAFDaZs5QfWh-","number":21590,"title":"TECS: init _velocity_control_traj_generator properly","user":{"login":"sfuhrer","id":26798987,"node_id":"MDQ6VXNlcjI2Nzk4OTg3","avatar_url":"https://avatars.githubusercontent.com/u/26798987?v=4","gravatar_id":"","url":"https://api.github.com/users/sfuhrer","html_url":"https://github.com/sfuhrer","followers_url":"https://api.github.com/users/sfuhrer/followers","following_url":"https://api.github.com/users/sfuhrer/following{/other_user}","gists_url":"https://api.github.com/users/sfuhrer/gists{/gist_id}","starred_url":"https://api.github.com/users/sfuhrer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfuhrer/subscriptions","organizations_url":"https://api.github.com/users/sfuhrer/orgs","repos_url":"https://api.github.com/users/sfuhrer/repos","events_url":"https://api.github.com/users/sfuhrer/events{/privacy}","received_events_url":"https://api.github.com/users/sfuhrer/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":78699916,"node_id":"MDU6TGFiZWw3ODY5OTkxNg==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Fixed%20Wing%20%F0%9F%9B%A9%EF%B8%8F","name":"Fixed Wing 🛩️","color":"009800","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2023-05-15T09:03:48Z","updated_at":"2023-05-15T11:53:34Z","closed_at":"2023-05-15T11:53:33Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/21590","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21590","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/21590.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/21590.patch","merged_at":"2023-05-15T11:53:33Z"},"body":"### Solved Problem\r\nThe manual trajectory generator was never initialized, and then if you did a VTOL transition in Altitude or Position mode, it's position was at 0 instead of the current altitude, resulting in a big height rate down setpoint. \r\nIt was then correctly reset once the sticks are moved ([here](https://github.com/PX4/PX4-Autopilot/blob/cf74d5ff5aa6b0461bb209a845a9f4f75c0d238b/src/lib/tecs/TECS.cpp#L172)), but if you never moved your sticks the vehicle would have crashed.  \r\n\r\n### Solution\r\nReset _velocity_control_traj_generator when also _alt_control_traj_generator is reset. \r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21590/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21590/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21571","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21571/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21571/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21571/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21571","id":1703420960,"node_id":"PR_kwDOAFDaZs5QKqBg","number":21571,"title":"FW Position Controller: use FW_TKO_PITCH_MIN to not dive into ground","user":{"login":"sfuhrer","id":26798987,"node_id":"MDQ6VXNlcjI2Nzk4OTg3","avatar_url":"https://avatars.githubusercontent.com/u/26798987?v=4","gravatar_id":"","url":"https://api.github.com/users/sfuhrer","html_url":"https://github.com/sfuhrer","followers_url":"https://api.github.com/users/sfuhrer/followers","following_url":"https://api.github.com/users/sfuhrer/following{/other_user}","gists_url":"https://api.github.com/users/sfuhrer/gists{/gist_id}","starred_url":"https://api.github.com/users/sfuhrer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfuhrer/subscriptions","organizations_url":"https://api.github.com/users/sfuhrer/orgs","repos_url":"https://api.github.com/users/sfuhrer/repos","events_url":"https://api.github.com/users/sfuhrer/events{/privacy}","received_events_url":"https://api.github.com/users/sfuhrer/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":78699916,"node_id":"MDU6TGFiZWw3ODY5OTkxNg==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Fixed%20Wing%20%F0%9F%9B%A9%EF%B8%8F","name":"Fixed Wing 🛩️","color":"009800","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2023-05-10T08:51:22Z","updated_at":"2023-05-11T11:31:51Z","closed_at":"2023-05-10T12:23:13Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/21571","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21571","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/21571.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/21571.patch","merged_at":"2023-05-10T12:23:13Z"},"body":"### Solved Problem\r\n\r\nFixes https://github.com/PX4/PX4-Autopilot/issues/21567\r\n\r\n### Solution\r\nUse FW_TKO_PITCH_MIN in takeoff phase instead of global min pitch. That prevents the system from diving after the throw to gain airspeed. \r\n\r\nFurther we could filter the airspeed in TECS less, eg by increasing FW_T_SPD_DEV_STD (as we anyway fix the airspeed rate input into TECS to 0 currently, see https://github.com/PX4/PX4-Autopilot/pull/21317).\r\n\r\nI also fixed the simulation along the way (see attached screen recording).\r\n\r\n### Changelog Entry\r\nFor release notes:\r\n```\r\nBugfix Plane catapult use FW_TKO_PITCH_MIN\r\n```\r\n\r\n\r\n\r\n### Test coverage\r\nWould be cool!\r\n\r\n### Context\r\nHow to simulate:\r\n`make px4_sitl_default gazebo_plane_catapult`\r\nPlan mission with takeoff, arm vehicle.\r\nhttps://github.com/PX4/PX4-Autopilot/assets/26798987/1b953c42-07d6-4110-b222-3f5543d949da\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21571/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21571/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21565","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21565/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21565/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21565/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21565","id":1701669863,"node_id":"PR_kwDOAFDaZs5QEzfX","number":21565,"title":"FW Rate Controller: fix manual tailsitter (only transform to body frame once)","user":{"login":"sfuhrer","id":26798987,"node_id":"MDQ6VXNlcjI2Nzk4OTg3","avatar_url":"https://avatars.githubusercontent.com/u/26798987?v=4","gravatar_id":"","url":"https://api.github.com/users/sfuhrer","html_url":"https://github.com/sfuhrer","followers_url":"https://api.github.com/users/sfuhrer/followers","following_url":"https://api.github.com/users/sfuhrer/following{/other_user}","gists_url":"https://api.github.com/users/sfuhrer/gists{/gist_id}","starred_url":"https://api.github.com/users/sfuhrer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfuhrer/subscriptions","organizations_url":"https://api.github.com/users/sfuhrer/orgs","repos_url":"https://api.github.com/users/sfuhrer/repos","events_url":"https://api.github.com/users/sfuhrer/events{/privacy}","received_events_url":"https://api.github.com/users/sfuhrer/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":249514594,"node_id":"MDU6TGFiZWwyNDk1MTQ1OTQ=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Hybrid%20VTOL%20%F0%9F%9B%A9%EF%B8%8F%F0%9F%9A%81","name":"Hybrid VTOL 🛩️🚁","color":"bfe5bf","default":false,"description":"Multirotor + Fixedwing!"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2023-05-09T09:08:29Z","updated_at":"2023-05-10T12:03:32Z","closed_at":"2023-05-10T07:29:02Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/21565","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21565","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/21565.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/21565.patch","merged_at":"2023-05-10T07:29:02Z"},"body":"\r\n### Solved Problem\r\nTailsitter manual fixed-wing flight broken. Raised [here](https://discord.com/channels/1022170275984457759/1103802569500938340/1103802588161392720).\r\n\r\n### Solution\r\nWhen filling the torque setpoints from the manual control inputs, do not fill in body but in airspeed (FW-) frame, as it is then later transformed to to the body frame in https://github.com/PX4/PX4-Autopilot/blob/4cd078409dac042d5547031ba6fa4bb6dbaa7496/src/modules/fw_rate_control/FixedwingRateControl.cpp#L404.\r\n\r\n### Changelog Entry\r\nFor release notes:\r\n```\r\nBugfix Tailsitter VTOL manual fixed-wing flight\r\n```\r\n\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21565/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21565/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21562","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21562/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21562/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21562/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21562","id":1700216123,"node_id":"PR_kwDOAFDaZs5P_5Et","number":21562,"title":"AirspeedValidator: disable innovation checks if lpos invalid","user":{"login":"sfuhrer","id":26798987,"node_id":"MDQ6VXNlcjI2Nzk4OTg3","avatar_url":"https://avatars.githubusercontent.com/u/26798987?v=4","gravatar_id":"","url":"https://api.github.com/users/sfuhrer","html_url":"https://github.com/sfuhrer","followers_url":"https://api.github.com/users/sfuhrer/followers","following_url":"https://api.github.com/users/sfuhrer/following{/other_user}","gists_url":"https://api.github.com/users/sfuhrer/gists{/gist_id}","starred_url":"https://api.github.com/users/sfuhrer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfuhrer/subscriptions","organizations_url":"https://api.github.com/users/sfuhrer/orgs","repos_url":"https://api.github.com/users/sfuhrer/repos","events_url":"https://api.github.com/users/sfuhrer/events{/privacy}","received_events_url":"https://api.github.com/users/sfuhrer/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2023-05-08T13:03:10Z","updated_at":"2023-05-09T01:46:47Z","closed_at":"2023-05-09T01:46:46Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/21562","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21562","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/21562.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/21562.patch","merged_at":"2023-05-09T01:46:46Z"},"body":"\r\n### Solved Problem\r\nThe airspeed innovation checks were also run when the local position was invalidated, as we so far only checked for the estimator velocity test ratio < 1 to run it. And the test ratio with a invalid position estimate seems to be NAN.\r\n\r\nCan be reproduced by simulating a VTOL, then faking a GPS failure (failure gps off), then transition to hover, then switching to Altitude, then transitioning again --> airspeed gets invalidated. \r\n\r\n### Solution\r\nAdd additional check for lpos validity. \r\n\r\n### Changelog Entry\r\nFor release notes:\r\n```\r\nBugfix AirspeedValidator in GPS-denied environment\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21562/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21562/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21520","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21520/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21520/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21520/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21520","id":1686351747,"node_id":"PR_kwDOAFDaZs5PRUFD","number":21520,"title":"Standard: fill att_sp.thrust[0] with _pusher_thr value during transit…","user":{"login":"sfuhrer","id":26798987,"node_id":"MDQ6VXNlcjI2Nzk4OTg3","avatar_url":"https://avatars.githubusercontent.com/u/26798987?v=4","gravatar_id":"","url":"https://api.github.com/users/sfuhrer","html_url":"https://github.com/sfuhrer","followers_url":"https://api.github.com/users/sfuhrer/followers","following_url":"https://api.github.com/users/sfuhrer/following{/other_user}","gists_url":"https://api.github.com/users/sfuhrer/gists{/gist_id}","starred_url":"https://api.github.com/users/sfuhrer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfuhrer/subscriptions","organizations_url":"https://api.github.com/users/sfuhrer/orgs","repos_url":"https://api.github.com/users/sfuhrer/repos","events_url":"https://api.github.com/users/sfuhrer/events{/privacy}","received_events_url":"https://api.github.com/users/sfuhrer/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":249514594,"node_id":"MDU6TGFiZWwyNDk1MTQ1OTQ=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Hybrid%20VTOL%20%F0%9F%9B%A9%EF%B8%8F%F0%9F%9A%81","name":"Hybrid VTOL 🛩️🚁","color":"bfe5bf","default":false,"description":"Multirotor + Fixedwing!"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2023-04-27T08:15:33Z","updated_at":"2023-04-27T15:30:38Z","closed_at":"2023-04-27T15:30:37Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/21520","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21520","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/21520.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/21520.patch","merged_at":"2023-04-27T15:30:37Z"},"body":"\r\n### Solved Problem\r\nPusher/Puller command drops to 0 briefly after front transition is completed. \r\n![image](https://user-images.githubusercontent.com/26798987/234799423-fda051c7-2551-40cd-bb51-461321effb9d.png)\r\nOnly visible in some logs as it's depending on the timing. Also most ESCs don't seem to react with a complete switch off, while others do.\r\n\r\n### Solution\r\nOnce passed the transition and in FW mode, it takes some ms until the FW att sp is updated by the FW att controller. During this time the last published attitude sp is kept being used, which is the one that was published during transition. So let's fill the thrust[0] of it with _pusher_throttle.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21520/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21520/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21492","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21492/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21492/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21492/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21492","id":1674477234,"node_id":"PR_kwDOAFDaZs5Opl--","number":21492,"title":"mission: only run update_mission() if mission is updated, not when reset due to landing","user":{"login":"sfuhrer","id":26798987,"node_id":"MDQ6VXNlcjI2Nzk4OTg3","avatar_url":"https://avatars.githubusercontent.com/u/26798987?v=4","gravatar_id":"","url":"https://api.github.com/users/sfuhrer","html_url":"https://github.com/sfuhrer","followers_url":"https://api.github.com/users/sfuhrer/followers","following_url":"https://api.github.com/users/sfuhrer/following{/other_user}","gists_url":"https://api.github.com/users/sfuhrer/gists{/gist_id}","starred_url":"https://api.github.com/users/sfuhrer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfuhrer/subscriptions","organizations_url":"https://api.github.com/users/sfuhrer/orgs","repos_url":"https://api.github.com/users/sfuhrer/repos","events_url":"https://api.github.com/users/sfuhrer/events{/privacy}","received_events_url":"https://api.github.com/users/sfuhrer/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2023-04-19T08:56:56Z","updated_at":"2023-04-21T05:47:59Z","closed_at":"2023-04-21T05:47:58Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/21492","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21492","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/21492.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/21492.patch","merged_at":"2023-04-21T05:47:58Z"},"body":"\r\n### Solved Problem\r\nWhen landing with a mission stored on the vehicle, that has not been updated since power cycling, these errors appear:\r\n```\r\nERROR [navigator] mission update failed\r\nWARN  [mavlink] ERROR: wp index out of bounds\r\n```\r\n\r\n### Solution\r\nThe errors come from the fact that when the mission is not updated, the [_mission_sub.copy(_mission) ](https://github.com/PX4/PX4-Autopilot/blob/202e2770da50caff0ed00c06a574e3c39933df52/src/modules/navigator/mission.cpp#L524)returns false, and thus the code below is not run, which would [reset _current_mission_index to 0 over current_seq](https://github.com/PX4/PX4-Autopilot/blob/202e2770da50caff0ed00c06a574e3c39933df52/src/modules/navigator/mission.cpp#L527), that was previously set to 0 in reset_mission. \r\nI thus here propose to only run `update_mission()` when the mission was actually updated, and otherwise, when we need to reset the mission on landing, only reset `_current_mission_index` to 0. \r\n\r\nWhat I'm not very sure yet: do we want to run the mission feasibility checks also on the reset? \r\n\r\n### Changelog Entry\r\nNot relevant.\r\n\r\n### Alternatives\r\nRemove the whole auto-reset logic on landing? It's not given that a mission should always start from 0. Though then the option in QGC should be there to reset the mission on landing/on vehicle boot.\r\n\r\n### Test coverage\r\nSITL tested. \r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21492/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21492/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21461","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21461/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21461/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21461/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21461","id":1663001101,"node_id":"PR_kwDOAFDaZs5ODSFE","number":21461,"title":"drivers/ins/vectornav: fix attitude (quaternion) and GPS packet extract","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2023-04-11T18:20:52Z","updated_at":"2023-04-17T15:18:03Z","closed_at":"2023-04-17T15:18:01Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/21461","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21461","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/21461.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/21461.patch","merged_at":"2023-04-17T15:18:01Z"},"body":null,"reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21461/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21461/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21460","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21460/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21460/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21460/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21460","id":1662948163,"node_id":"PR_kwDOAFDaZs5ODGtN","number":21460,"title":"gimbal: output RC fix actuator_controls_2 -> gimbal_controls regression","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2023-04-11T17:38:15Z","updated_at":"2023-04-11T20:03:44Z","closed_at":"2023-04-11T20:03:43Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/21460","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21460","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/21460.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/21460.patch","merged_at":"2023-04-11T20:03:43Z"},"body":" - small typo introduced in https://github.com/PX4/PX4-Autopilot/pull/20837\r\n\r\nFYI @sfuhrer ","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21460/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21460/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21458","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21458/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21458/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21458/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21458","id":1662355876,"node_id":"PR_kwDOAFDaZs5OBFiA","number":21458,"title":"Add descend task to failsafe fallback to avoid \"Failsafe task activated\"","user":{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":78699954,"node_id":"MDU6TGFiZWw3ODY5OTk1NA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Multirotor%20%F0%9F%9B%B8","name":"Multirotor 🛸","color":"0052cc","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false},"assignees":[{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false}],"milestone":null,"comments":5,"created_at":"2023-04-11T12:14:37Z","updated_at":"2023-04-15T14:45:33Z","closed_at":"2023-04-15T14:45:32Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/21458","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21458","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/21458.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/21458.patch","merged_at":"2023-04-15T14:45:32Z"},"body":"<!--\r\n\r\nThank you for your contribution!\r\n\r\nGet early feedback through\r\n- Dronecode Discord: https://discord.gg/dronecode\r\n- PX4 Discuss: http://discuss.px4.io/\r\n- opening a draft pr and sharing the link\r\n\r\n-->\r\n\r\n### Solved Problem\r\nWhen starting SITL e.g. using `make px4_sitl sihsim_quadx` and don't have any ground station that immediately sends joystick data there's an error message `ERROR [flight_mode_manager] Failsafe task activated`\r\n\r\n![image](https://user-images.githubusercontent.com/4668506/231154013-b49eb445-bb15-4171-8c9f-dd1cea6f70dd.png)\r\n\r\nThis translates to the real vehicle boot without position estimate and RC signal.\r\n\r\nFixes #21370\r\n\r\n### Solution\r\nMy suggestion for 1.14 is to add the descend task to the flight mode manager fallback which I did in this pr. It's a minimal change that solves the problem like it was after merging #20172 before making the checks to run all stick dependent tasks including altitude more strict in https://github.com/PX4/PX4-Autopilot/commit/da4644c20adce8aeedd5be432fc88b1b115d7eb9#diff-a65eff8fc6362bb2a8c4c7495f56778e1896809f6251a9403e57ff18f754076aR66\r\n\r\n### Alternatives\r\nI would like to rework this logic. We still don't have a dedicated way for mode execution to report a problem to the state machine but generally the task starting logic is too complicated and double covers things commander does. The important thing is to clearly define what is running while not armed. Currently I'm in favor of running or trying to run the thing that should be there in air but mute unnecessary errors.\r\n\r\n### Test coverage\r\nI tried the start and verified that it switches to the descend task at the expected moment.\r\n\r\n### Context\r\nRelated links, screenshot before/after, video\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21458/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21458/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21444","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21444/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21444/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21444/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21444","id":1657703035,"node_id":"PR_kwDOAFDaZs5NyIc_","number":21444,"title":"tecs: fix throttle prediction","user":{"login":"sfuhrer","id":26798987,"node_id":"MDQ6VXNlcjI2Nzk4OTg3","avatar_url":"https://avatars.githubusercontent.com/u/26798987?v=4","gravatar_id":"","url":"https://api.github.com/users/sfuhrer","html_url":"https://github.com/sfuhrer","followers_url":"https://api.github.com/users/sfuhrer/followers","following_url":"https://api.github.com/users/sfuhrer/following{/other_user}","gists_url":"https://api.github.com/users/sfuhrer/gists{/gist_id}","starred_url":"https://api.github.com/users/sfuhrer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfuhrer/subscriptions","organizations_url":"https://api.github.com/users/sfuhrer/orgs","repos_url":"https://api.github.com/users/sfuhrer/repos","events_url":"https://api.github.com/users/sfuhrer/events{/privacy}","received_events_url":"https://api.github.com/users/sfuhrer/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2023-04-06T16:12:58Z","updated_at":"2023-04-06T18:13:34Z","closed_at":"2023-04-06T18:13:33Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/21444","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21444","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/21444.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/21444.patch","merged_at":"2023-04-06T18:13:32Z"},"body":"Fixes regression that slipped in with https://github.com/PX4/PX4-Autopilot/pull/21345.\r\nThe throttle prediction was completely off.","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21444/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21444/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21390","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21390/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21390/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21390/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21390","id":1645315444,"node_id":"PR_kwDOAFDaZs5NI_IU","number":21390,"title":"Navigator: fix logic around when to switch to mission landing for RTL","user":{"login":"sfuhrer","id":26798987,"node_id":"MDQ6VXNlcjI2Nzk4OTg3","avatar_url":"https://avatars.githubusercontent.com/u/26798987?v=4","gravatar_id":"","url":"https://api.github.com/users/sfuhrer","html_url":"https://github.com/sfuhrer","followers_url":"https://api.github.com/users/sfuhrer/followers","following_url":"https://api.github.com/users/sfuhrer/following{/other_user}","gists_url":"https://api.github.com/users/sfuhrer/gists{/gist_id}","starred_url":"https://api.github.com/users/sfuhrer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfuhrer/subscriptions","organizations_url":"https://api.github.com/users/sfuhrer/orgs","repos_url":"https://api.github.com/users/sfuhrer/repos","events_url":"https://api.github.com/users/sfuhrer/events{/privacy}","received_events_url":"https://api.github.com/users/sfuhrer/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2023-03-29T08:50:15Z","updated_at":"2023-04-05T08:11:16Z","closed_at":"2023-04-05T08:11:15Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/21390","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21390","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/21390.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/21390.patch","merged_at":"2023-04-05T08:11:15Z"},"body":"### Solved Problem\r\nVehicle climbs and follows RTL sequence when already on mission landing (on loiter down).\r\n\r\n### Solution\r\nImprove function` Mission::landing() `--> To find out if we're currently on a mission landing, check if we either are past the land start marker OR currently land start marker is current WP ~and vehicle is already in LOITER mode.~, type is LOITER_TO_ALT and vehicle is inside loiter circle. Then it seems to me like we don't need to additional function `Navigator::getMissionLandingInProgress() `anymore, so I removed that. \r\n\r\n### Alternatives\r\nhttps://github.com/PX4/PX4-Autopilot/pull/20903 will hopefully help us to once and for all make the RTL behavior deterministic and predictable. \r\n\r\n### Test coverage\r\nTested triggering RTL on a VTOL in SITL in all flight phases of the Mission, and it now only does the whole RTL sequence when outside of the loiter down.\r\n\r\n### Context\r\nThe previous logic was introduced with https://github.com/PX4/PX4-Autopilot/pull/16377/commits/9677e8486555184b19465d46a08e250dcbdcb814. I didn't find the specifc commit that broke it, maybe it was https://github.com/PX4/PX4-Autopilot/pull/21154.\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21390/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21390/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21380","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21380/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21380/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21380/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21380","id":1644119292,"node_id":"PR_kwDOAFDaZs5NE_yO","number":21380,"title":"MC_Pos_Control: takeoff bug constrain hover_thrust_estimate","user":{"login":"hendjoshsr71","id":69225461,"node_id":"MDQ6VXNlcjY5MjI1NDYx","avatar_url":"https://avatars.githubusercontent.com/u/69225461?v=4","gravatar_id":"","url":"https://api.github.com/users/hendjoshsr71","html_url":"https://github.com/hendjoshsr71","followers_url":"https://api.github.com/users/hendjoshsr71/followers","following_url":"https://api.github.com/users/hendjoshsr71/following{/other_user}","gists_url":"https://api.github.com/users/hendjoshsr71/gists{/gist_id}","starred_url":"https://api.github.com/users/hendjoshsr71/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hendjoshsr71/subscriptions","organizations_url":"https://api.github.com/users/hendjoshsr71/orgs","repos_url":"https://api.github.com/users/hendjoshsr71/repos","events_url":"https://api.github.com/users/hendjoshsr71/events{/privacy}","received_events_url":"https://api.github.com/users/hendjoshsr71/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":78699954,"node_id":"MDU6TGFiZWw3ODY5OTk1NA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Multirotor%20%F0%9F%9B%B8","name":"Multirotor 🛸","color":"0052cc","default":false,"description":""},{"id":174161208,"node_id":"MDU6TGFiZWwxNzQxNjEyMDg=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/priority-critical","name":"priority-critical","color":"e11d21","default":false,"description":null},{"id":5100420534,"node_id":"LA_kwDOAFDaZs8AAAABMAI9tg","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/release%20blocker%20%E2%9D%97%EF%B8%8F","name":"release blocker ❗️","color":"74C1F8","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2023-03-28T14:48:32Z","updated_at":"2023-04-26T09:00:55Z","closed_at":"2023-04-26T08:59:52Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/21380","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21380","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/21380.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/21380.patch","merged_at":null},"body":"This is the version of [PR](https://github.com/PX4/PX4-Autopilot/pull/21372)  that points to main instead of 1.13","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21380/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21380/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21372","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21372/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21372/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21372/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21372","id":1642183483,"node_id":"PR_kwDOAFDaZs5M-eUT","number":21372,"title":"MC_Pos_Control: takeoff bug constrain hover_thrust_estimate consistently","user":{"login":"hendjoshsr71","id":69225461,"node_id":"MDQ6VXNlcjY5MjI1NDYx","avatar_url":"https://avatars.githubusercontent.com/u/69225461?v=4","gravatar_id":"","url":"https://api.github.com/users/hendjoshsr71","html_url":"https://github.com/hendjoshsr71","followers_url":"https://api.github.com/users/hendjoshsr71/followers","following_url":"https://api.github.com/users/hendjoshsr71/following{/other_user}","gists_url":"https://api.github.com/users/hendjoshsr71/gists{/gist_id}","starred_url":"https://api.github.com/users/hendjoshsr71/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hendjoshsr71/subscriptions","organizations_url":"https://api.github.com/users/hendjoshsr71/orgs","repos_url":"https://api.github.com/users/hendjoshsr71/repos","events_url":"https://api.github.com/users/hendjoshsr71/events{/privacy}","received_events_url":"https://api.github.com/users/hendjoshsr71/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":78699954,"node_id":"MDU6TGFiZWw3ODY5OTk1NA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Multirotor%20%F0%9F%9B%B8","name":"Multirotor 🛸","color":"0052cc","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2023-03-27T14:17:43Z","updated_at":"2023-06-20T17:04:41Z","closed_at":"2023-06-20T17:04:41Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/21372","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21372","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/21372.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/21372.patch","merged_at":null},"body":"Fixes #20275\r\n\r\nThis in response to a shoot to the sky event we had that we could reproduce quite readily. I was also able to reproduce it in gazebo. See comment  https://github.com/PX4/PX4-Autopilot/issues/20275#issuecomment-1474465513\r\n\r\n### Issue\r\n\r\nThe branch is on a custom 1.13 with last merged in commits from main (6823cbc4140e29568f00e1211ae60e057adb1a1f) and no changes to PosControl.\r\n(Note of all my vehicles with this same firmware only one exhibits it to the extreme of shooting to the sky. Though you can audibly hear what may be this issue on others.)\r\n\r\n![Screenshot from 2023-03-17 17-05-33](https://user-images.githubusercontent.com/69225461/226062543-2b2dcb42-03fd-4ad8-9c70-9b3dccf81c31.png)\r\n\r\n### Likely Cause\r\n\r\nIn `PositionControl::updateHoverThrust(const float hover_thrust)`, `_hover_thrust_new` is not constrained by the same amount as  the stored `_hover thrust` because we are pulling down  on throttle and keeping ourselves stuck to the ground the estimate for hover thrust is much smaller than the 0.1 default constraint. \r\n\r\nThis then leads to a build up [here](https://github.com/PX4/PX4-Autopilot/blob/1c8ab2a0d7db2d14a6f320ebd8766b5ffaea28fa/src/modules/mc_pos_control/PositionControl/PositionControl.cpp#L144)\r\n\r\nI threw in the other constraint as well to `_vel_int(2)` here just be more consistent as there are a lot of steps that use it before it eventually gets constrained here [link](https://github.com/PX4/PX4-Autopilot/blob/1c8ab2a0d7db2d14a6f320ebd8766b5ffaea28fa/src/modules/mc_pos_control/PositionControl/PositionControl.cpp#L194)\r\n\r\n### Future Items\r\n\r\nReally what \"i think\" should be done is some sort of smoothing on the acceleration or jerk in the poscontrol file. Partly as some \"defensive\" coding and partly so that these changes are less abrupt when `hover_estimate.valid is true`\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21372/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21372/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21329","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21329/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21329/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21329/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21329","id":1629612930,"node_id":"PR_kwDOAFDaZs5MUoM5","number":21329,"title":"VTOL: make sure that all virtual topics are updated","user":{"login":"sfuhrer","id":26798987,"node_id":"MDQ6VXNlcjI2Nzk4OTg3","avatar_url":"https://avatars.githubusercontent.com/u/26798987?v=4","gravatar_id":"","url":"https://api.github.com/users/sfuhrer","html_url":"https://github.com/sfuhrer","followers_url":"https://api.github.com/users/sfuhrer/followers","following_url":"https://api.github.com/users/sfuhrer/following{/other_user}","gists_url":"https://api.github.com/users/sfuhrer/gists{/gist_id}","starred_url":"https://api.github.com/users/sfuhrer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfuhrer/subscriptions","organizations_url":"https://api.github.com/users/sfuhrer/orgs","repos_url":"https://api.github.com/users/sfuhrer/repos","events_url":"https://api.github.com/users/sfuhrer/events{/privacy}","received_events_url":"https://api.github.com/users/sfuhrer/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":249514594,"node_id":"MDU6TGFiZWwyNDk1MTQ1OTQ=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Hybrid%20VTOL%20%F0%9F%9B%A9%EF%B8%8F%F0%9F%9A%81","name":"Hybrid VTOL 🛩️🚁","color":"bfe5bf","default":false,"description":"Multirotor + Fixedwing!"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2023-03-17T16:37:34Z","updated_at":"2023-03-17T18:43:03Z","closed_at":"2023-03-17T18:43:01Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/21329","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21329","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/21329.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/21329.patch","merged_at":"2023-03-17T18:43:01Z"},"body":"The update of virtual thrust setpoint would not happen if the torque one already was updated. \r\n\r\nThat slipped in with https://github.com/PX4/PX4-Autopilot/pull/20837 and interestingly wasn't noticeable in SITL.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21329/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21329/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21328","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21328/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21328/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21328/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21328","id":1629522806,"node_id":"PR_kwDOAFDaZs5MUUo0","number":21328,"title":"ekf: add option to rotate the sideslip fusion direction","user":{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false},"assignees":[{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false}],"milestone":null,"comments":1,"created_at":"2023-03-17T15:37:14Z","updated_at":"2023-03-21T16:58:09Z","closed_at":"2023-03-21T16:58:05Z","author_association":"MEMBER","active_lock_reason":null,"draft":true,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/21328","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21328","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/21328.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/21328.patch","merged_at":null},"body":"This is required for tailsitters flying with -90deg pitch in fixed-wing flight\r\n\r\ncontext: https://github.com/PX4/PX4-Autopilot/pull/21319\r\n\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21328/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21328/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21309","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21309/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21309/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21309/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21309","id":1623636201,"node_id":"PR_kwDOAFDaZs5MAcEK","number":21309,"title":"ekf2: GNSS yaw only reset test ratio for new samples","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":666022583,"node_id":"MDU6TGFiZWw2NjYwMjI1ODM=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/EKF2","name":"EKF2","color":"1d76db","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2023-03-14T14:46:47Z","updated_at":"2023-03-15T01:49:25Z","closed_at":"2023-03-15T01:49:24Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/21309","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21309","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/21309.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/21309.patch","merged_at":"2023-03-15T01:49:24Z"},"body":" - otherwise external test ratio monitoring could trigger a false positive","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21309/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21309/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21287","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21287/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21287/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21287/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21287","id":1619047486,"node_id":"PR_kwDOAFDaZs5LxVhm","number":21287,"title":"ekf: fix GNSS yaw fusion wrapping","user":{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":666022583,"node_id":"MDU6TGFiZWw2NjYwMjI1ODM=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/EKF2","name":"EKF2","color":"1d76db","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false},"assignees":[{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false}],"milestone":null,"comments":2,"created_at":"2023-03-10T14:12:47Z","updated_at":"2023-03-14T14:56:25Z","closed_at":"2023-03-13T09:46:34Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/21287","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21287","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/21287.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/21287.patch","merged_at":"2023-03-13T09:46:34Z"},"body":"<!--\r\n\r\nThank you for your contribution!\r\n\r\nGet early feedback through\r\n- Dronecode Discord: https://discord.gg/dronecode\r\n- PX4 Discuss: http://discuss.px4.io/\r\n- opening a draft pr and sharing the link\r\n\r\n-->\r\n\r\n### Solved Problem\r\nAngle wrapping was missing when computing the innovation\r\n\r\n### Solution\r\nMove the innovation computation outside of the autogenerated code and add `wrap_pi`\r\n\r\n### Test coverage\r\n- unit tests\r\n\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21287/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21287/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21268","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21268/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21268/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21268/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21268","id":1615848477,"node_id":"PR_kwDOAFDaZs5LmfbO","number":21268,"title":"flight_mode_manager: StickAccelerationXY protect from NAN velocity reset","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":78699954,"node_id":"MDU6TGFiZWw3ODY5OTk1NA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Multirotor%20%F0%9F%9B%B8","name":"Multirotor 🛸","color":"0052cc","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2023-03-08T20:03:23Z","updated_at":"2023-03-10T13:17:23Z","closed_at":"2023-03-10T13:17:21Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/21268","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21268","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/21268.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/21268.patch","merged_at":"2023-03-10T13:17:21Z"},"body":"There's a race condition where NAN velocity reset can slip into the FlightTaskManualAcceleration _velocity_setpoint and you'll be stuck with it until leaving the mode and reactivating.\r\n\r\nhttps://github.com/PX4/PX4-Autopilot/blob/ea20217c1bf809554311ca5348d1c9c4e1a28ba3/src/modules/flight_mode_manager/tasks/FlightTask/FlightTask.cpp#L106\r\n\r\nFor now I've added a StickAccelerationXY protection, but perhaps we'd like to solve this more generally?","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21268/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21268/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21223","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21223/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21223/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21223/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21223","id":1605227773,"node_id":"PR_kwDOAFDaZs5LC56h","number":21223,"title":"ekf2: gps control use adjusted velocity and position for reset","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":666022583,"node_id":"MDU6TGFiZWw2NjYwMjI1ODM=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/EKF2","name":"EKF2","color":"1d76db","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2023-03-01T15:54:07Z","updated_at":"2023-03-06T14:03:41Z","closed_at":"2023-03-06T14:03:40Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/21223","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21223","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/21223.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/21223.patch","merged_at":"2023-03-06T14:03:40Z"},"body":null,"reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21223/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21223/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21208","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21208/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21208/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21208/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21208","id":1603535402,"node_id":"PR_kwDOAFDaZs5K9KxR","number":21208,"title":"RTL: only do calculations in is-inactive if global position is recent","user":{"login":"sfuhrer","id":26798987,"node_id":"MDQ6VXNlcjI2Nzk4OTg3","avatar_url":"https://avatars.githubusercontent.com/u/26798987?v=4","gravatar_id":"","url":"https://api.github.com/users/sfuhrer","html_url":"https://github.com/sfuhrer","followers_url":"https://api.github.com/users/sfuhrer/followers","following_url":"https://api.github.com/users/sfuhrer/following{/other_user}","gists_url":"https://api.github.com/users/sfuhrer/gists{/gist_id}","starred_url":"https://api.github.com/users/sfuhrer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfuhrer/subscriptions","organizations_url":"https://api.github.com/users/sfuhrer/orgs","repos_url":"https://api.github.com/users/sfuhrer/repos","events_url":"https://api.github.com/users/sfuhrer/events{/privacy}","received_events_url":"https://api.github.com/users/sfuhrer/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2023-02-28T17:51:56Z","updated_at":"2023-03-02T12:22:28Z","closed_at":"2023-03-02T10:09:33Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/21208","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21208","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/21208.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/21208.patch","merged_at":"2023-03-02T10:09:33Z"},"body":"### Solved Problem\r\nWrong RTL time calculation when global position is invalid (never published) but home position is set.\r\n![image](https://user-images.githubusercontent.com/26798987/221924674-dd18bc0c-4294-4ca3-871d-f41fb26cd082.png)\r\n\r\nHome position can also be set with the raw gps lat/lon before EKF publishes a global_position estimate.\r\n![image](https://user-images.githubusercontent.com/26798987/221929147-de13e868-6346-4412-ac4e-d06f80c0bc50.png)\r\n\r\n\r\n### Solution\r\nCheck if global_position estimate has been updated recently (<10s) before running the functions in `rtl::on_inactive()` (`calc_and_pub_rtl_time_estimate` and `find_RTL_destination()`). \r\nRunning `find_RTL_destination()` even without valid global position didn't show any problems but I included it here as it seems correct to me.\r\n\r\n### Alternatives\r\nUse some other flag for global_position validity?\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21208/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21208/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21197","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21197/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21197/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21197/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21197","id":1599188537,"node_id":"PR_kwDOAFDaZs5KuuO4","number":21197,"title":"ekf2: fix controlEvYawFusion() yaw reset","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":666022583,"node_id":"MDU6TGFiZWw2NjYwMjI1ODM=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/EKF2","name":"EKF2","color":"1d76db","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2023-02-24T19:40:55Z","updated_at":"2023-02-24T22:00:01Z","closed_at":"2023-02-24T21:59:59Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/21197","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21197","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/21197.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/21197.patch","merged_at":"2023-02-24T21:59:59Z"},"body":"This was a clear typo.","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21197/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21197/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21155","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21155/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21155/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21155/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21155","id":1589571361,"node_id":"PR_kwDOAFDaZs5KOtbz","number":21155,"title":"tests: empty parentheses were disambiguated as a function declaration","user":{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false},"assignees":[{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false}],"milestone":null,"comments":0,"created_at":"2023-02-17T15:55:23Z","updated_at":"2023-02-18T02:10:45Z","closed_at":"2023-02-18T02:10:44Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/21155","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21155","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/21155.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/21155.patch","merged_at":"2023-02-18T02:10:44Z"},"body":"<!--\r\n\r\nThank you for your contribution!\r\n\r\nGet early feedback through\r\n- Dronecode Discord: https://discord.gg/dronecode\r\n- PX4 Discuss: http://discuss.px4.io/\r\n- opening a draft pr and sharing the link\r\n\r\n-->\r\n\r\n### Solved Problem\r\nCompiler not happy\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21155/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21155/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21154","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21154/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21154/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21154/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21154","id":1589472249,"node_id":"PR_kwDOAFDaZs5KOYPO","number":21154,"title":"Navigator: set _land_start_index to first item with a position after the marker","user":{"login":"sfuhrer","id":26798987,"node_id":"MDQ6VXNlcjI2Nzk4OTg3","avatar_url":"https://avatars.githubusercontent.com/u/26798987?v=4","gravatar_id":"","url":"https://api.github.com/users/sfuhrer","html_url":"https://github.com/sfuhrer","followers_url":"https://api.github.com/users/sfuhrer/followers","following_url":"https://api.github.com/users/sfuhrer/following{/other_user}","gists_url":"https://api.github.com/users/sfuhrer/gists{/gist_id}","starred_url":"https://api.github.com/users/sfuhrer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfuhrer/subscriptions","organizations_url":"https://api.github.com/users/sfuhrer/orgs","repos_url":"https://api.github.com/users/sfuhrer/repos","events_url":"https://api.github.com/users/sfuhrer/events{/privacy}","received_events_url":"https://api.github.com/users/sfuhrer/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2023-02-17T14:43:22Z","updated_at":"2023-02-20T05:50:55Z","closed_at":"2023-02-20T05:50:54Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/21154","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21154","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/21154.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/21154.patch","merged_at":"2023-02-20T05:50:54Z"},"body":"\r\n### Solved Problem\r\nAt the start of a RTL using a mission landing, `position setpoint.type` is IDLE, and valid=false, thus FW position controller switch to `FW_POSCTRL_MODE_OTHER` which sets `_tecs.reset_state()`;\r\n![image](https://user-images.githubusercontent.com/26798987/219685222-daee32dc-527b-4af0-b9ff-ea68767bc969.png)\r\n\r\n\r\n### Solution\r\n_land_start_index is used to to start the mission from this item index, and to avoid to publish a triplet.current.type=IDLE, we need to fill it with the actual position setpoint that the vehicle should go to at the start of a mission landing.\r\n\r\n\r\nThis was like this ever, but it only surfaced not because previously we didn't do a TECS reset on receiving IDLE setpoints in the FW Position Controller.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21154/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21154/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21145","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21145/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21145/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21145/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21145","id":1589020817,"node_id":"PR_kwDOAFDaZs5KM19P","number":21145,"title":"Navigator: accept yaw immedietaly if the flag heading_good_for_contro…","user":{"login":"sfuhrer","id":26798987,"node_id":"MDQ6VXNlcjI2Nzk4OTg3","avatar_url":"https://avatars.githubusercontent.com/u/26798987?v=4","gravatar_id":"","url":"https://api.github.com/users/sfuhrer","html_url":"https://github.com/sfuhrer","followers_url":"https://api.github.com/users/sfuhrer/followers","following_url":"https://api.github.com/users/sfuhrer/following{/other_user}","gists_url":"https://api.github.com/users/sfuhrer/gists{/gist_id}","starred_url":"https://api.github.com/users/sfuhrer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfuhrer/subscriptions","organizations_url":"https://api.github.com/users/sfuhrer/orgs","repos_url":"https://api.github.com/users/sfuhrer/repos","events_url":"https://api.github.com/users/sfuhrer/events{/privacy}","received_events_url":"https://api.github.com/users/sfuhrer/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2023-02-17T09:19:52Z","updated_at":"2023-02-17T13:22:42Z","closed_at":"2023-02-17T12:34:30Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/21145","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21145","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/21145.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/21145.patch","merged_at":"2023-02-17T12:34:30Z"},"body":"\r\n### Solved Problem\r\nVehicle is stuck at a mission item (eg during RTL) when `local_position.heading_good_for_control` is set to false. MPC in that case sets the vehicle heading setpoint to NAN, which then gets set to current yaw in turn (as NaN would blow up the quaternion). Navigator doesn't know about that, and thus assumes the position not reached until the current yaw is close to the mission_item yaw.\r\n\r\n### Solution\r\nSet `_waypoint_yaw_reached` to true immediately if `local_position.heading_good_for_control` is set to false.\r\n ","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21145/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21145/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21073","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21073/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21073/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21073/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21073","id":1572834913,"node_id":"PR_kwDOAFDaZs5JWnfI","number":21073,"title":"lib/sensor_calibration: BiasCorrectedSensorOffset() don't incorporate thermal offsets","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":174161208,"node_id":"MDU6TGFiZWwxNzQxNjEyMDg=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/priority-critical","name":"priority-critical","color":"e11d21","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2023-02-06T15:58:43Z","updated_at":"2023-02-06T20:09:09Z","closed_at":"2023-02-06T20:09:08Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/21073","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21073","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/21073.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/21073.patch","merged_at":"2023-02-06T20:09:07Z"},"body":" - the thermal offsets are an optional correction applied to the raw data, so when updating an existing calibration offset with new learned bias we don't want this incorporated\r\n\r\nOnly a problem if you're using factory temperature calibration (majority of users aren't) and `SENS_IMU_AUTOCAL = 1`.\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21073/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21073/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21051","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21051/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21051/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21051/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21051","id":1568240765,"node_id":"PR_kwDOAFDaZs5JHrkL","number":21051,"title":"ekf2: mag control reset mag_lpf on first sample","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":666022583,"node_id":"MDU6TGFiZWw2NjYwMjI1ODM=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/EKF2","name":"EKF2","color":"1d76db","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2023-02-02T15:15:13Z","updated_at":"2023-02-02T21:12:12Z","closed_at":"2023-02-02T21:12:10Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/21051","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21051","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/21051.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/21051.patch","merged_at":"2023-02-02T21:12:10Z"},"body":null,"reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21051/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21051/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21045","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21045/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21045/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21045/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21045","id":1567378995,"node_id":"PR_kwDOAFDaZs5JExkz","number":21045,"title":"fix device type duplicate definition","user":{"login":"ShiauweiZhao","id":9687758,"node_id":"MDQ6VXNlcjk2ODc3NTg=","avatar_url":"https://avatars.githubusercontent.com/u/9687758?v=4","gravatar_id":"","url":"https://api.github.com/users/ShiauweiZhao","html_url":"https://github.com/ShiauweiZhao","followers_url":"https://api.github.com/users/ShiauweiZhao/followers","following_url":"https://api.github.com/users/ShiauweiZhao/following{/other_user}","gists_url":"https://api.github.com/users/ShiauweiZhao/gists{/gist_id}","starred_url":"https://api.github.com/users/ShiauweiZhao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ShiauweiZhao/subscriptions","organizations_url":"https://api.github.com/users/ShiauweiZhao/orgs","repos_url":"https://api.github.com/users/ShiauweiZhao/repos","events_url":"https://api.github.com/users/ShiauweiZhao/events{/privacy}","received_events_url":"https://api.github.com/users/ShiauweiZhao/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2023-02-02T06:04:32Z","updated_at":"2023-02-07T01:25:54Z","closed_at":"2023-02-02T14:54:47Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/21045","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21045","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/21045.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/21045.patch","merged_at":"2023-02-02T14:54:47Z"},"body":"\r\nwe have doule device type is 0x4c","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21045/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21045/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21036","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21036/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21036/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21036/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21036","id":1566304020,"node_id":"PR_kwDOAFDaZs5JBLvl","number":21036,"title":"FW: support Land command outside of a mission","user":{"login":"sfuhrer","id":26798987,"node_id":"MDQ6VXNlcjI2Nzk4OTg3","avatar_url":"https://avatars.githubusercontent.com/u/26798987?v=4","gravatar_id":"","url":"https://api.github.com/users/sfuhrer","html_url":"https://github.com/sfuhrer","followers_url":"https://api.github.com/users/sfuhrer/followers","following_url":"https://api.github.com/users/sfuhrer/following{/other_user}","gists_url":"https://api.github.com/users/sfuhrer/gists{/gist_id}","starred_url":"https://api.github.com/users/sfuhrer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfuhrer/subscriptions","organizations_url":"https://api.github.com/users/sfuhrer/orgs","repos_url":"https://api.github.com/users/sfuhrer/repos","events_url":"https://api.github.com/users/sfuhrer/events{/privacy}","received_events_url":"https://api.github.com/users/sfuhrer/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":78699916,"node_id":"MDU6TGFiZWw3ODY5OTkxNg==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Fixed%20Wing%20%F0%9F%9B%A9%EF%B8%8F","name":"Fixed Wing 🛩️","color":"009800","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":8,"created_at":"2023-02-01T15:17:04Z","updated_at":"2023-08-30T09:23:07Z","closed_at":"2023-02-20T16:04:40Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/21036","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21036","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/21036.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/21036.patch","merged_at":"2023-02-20T16:04:40Z"},"body":"### Solved Problem\r\nWhen triggering a land outside of a mission (e.g. by switching to Land mode, sending DO_LAND command or typing `commander land` in shell), vehicle does a fly away. Instead if should come down at current location and \"land\" more or less smoothly. \r\n\r\n### Solution\r\n- rename existing landing method `control_auto_landing` to `control_auto_landing_straight()`\r\n- add new landing method `control_auto_landing_circular()`\r\n--> `control_auto_landing_circular()` is used if `_position_setpoint_previous_valid=false`, which is the case for landings outside of missions. At some point we could add a flag to [CMD_NAV_LAND](https://mavlink.io/en/messages/common.html#MAV_CMD_NAV_LAND) to be able to distinguish straight and circular landings this way (there may be valid use cases where circular mission landings are preferred over straight ones, eg when planning multiple mission landings as rally points)\r\n- in `control_auto_landing_circular()`, keep loitering down at a fixed descend speed (based on FW_LND_ANG) in landing configuration (landing airspeed, flaps in landing config etc) until flaring altitude is breached, then flare (flaring is unchanged from straight landing)\r\n- don't allow any nudging, only keep wheel control when flaring\r\n- enable landing abort (both automatic and user triggered) --> establish loiter at current position and altitude (without climbing!)\r\n- I had to make one change that potentially also affect MC - could you check @MaEtUgR that it's fine? To me it sounds like the right thing to do anyway. https://github.com/PX4/PX4-Autopilot/pull/21036/commits/eafb281732ca4e846176e37af361a4f9c4555b55\r\n\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21036/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21036/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21013","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21013/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21013/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21013/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21013","id":1558540348,"node_id":"PR_kwDOAFDaZs5InLRf","number":21013,"title":"symforce codegen remove reserved identifier naming","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2023-01-26T17:56:08Z","updated_at":"2023-01-30T14:24:35Z","closed_at":"2023-01-30T14:24:33Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/21013","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21013","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/21013.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/21013.patch","merged_at":"2023-01-30T14:24:33Z"},"body":" - from the C standard, \"All identifiers that begin with an underscore and either an uppercase letter or another underscore are always reserved for any use\"\r\n\r\nUsing these identifiers can get you in trouble and cause strange looking build failures seemingly randomly if you get unlucky with certain header inclusions. https://github.com/PX4/PX4-Autopilot/actions/runs/4012285171/jobs/6890606891\r\n\r\n\r\n![Screenshot from 2023-01-26 12-50-18](https://user-images.githubusercontent.com/84712/214911104-ecdd0d06-90b1-44c0-b7cf-9b0cd87ff767.png)\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21013/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21013/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21005","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21005/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21005/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21005/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21005","id":1556853772,"node_id":"PR_kwDOAFDaZs5IhiD9","number":21005,"title":"ekf2: OF control logic fixes","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":666022583,"node_id":"MDU6TGFiZWw2NjYwMjI1ODM=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/EKF2","name":"EKF2","color":"1d76db","default":false,"description":""},{"id":1714303614,"node_id":"MDU6TGFiZWwxNzE0MzAzNjE0","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Optical%20flow%20%F0%9F%91%81%EF%B8%8F%E2%80%8D%F0%9F%97%A8%EF%B8%8F","name":"Optical flow 👁️‍🗨️","color":"41d374","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2023-01-25T15:34:26Z","updated_at":"2023-11-15T16:01:33Z","closed_at":"2023-11-15T16:01:32Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/21005","html_url":"https://github.com/PX4/PX4-Autopilot/pull/21005","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/21005.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/21005.patch","merged_at":null},"body":" - always compute innovation variance and test ratios (updateOptFlow())\r\n - if horizontal aiding active require good test ratio before starting OF\r\n - strict on ground (not flying) optical flow fusion workaround to when vehicle is also at rest (much more conservative)\r\n - add additional OF reset terrain validity and OF quality check\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21005/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/21005/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20988","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20988/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20988/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20988/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20988","id":1554753606,"node_id":"PR_kwDOAFDaZs5IafOF","number":20988,"title":"FW Position Control: remove unused climbout flags and fix controller status publishing","user":{"login":"sfuhrer","id":26798987,"node_id":"MDQ6VXNlcjI2Nzk4OTg3","avatar_url":"https://avatars.githubusercontent.com/u/26798987?v=4","gravatar_id":"","url":"https://api.github.com/users/sfuhrer","html_url":"https://github.com/sfuhrer","followers_url":"https://api.github.com/users/sfuhrer/followers","following_url":"https://api.github.com/users/sfuhrer/following{/other_user}","gists_url":"https://api.github.com/users/sfuhrer/gists{/gist_id}","starred_url":"https://api.github.com/users/sfuhrer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfuhrer/subscriptions","organizations_url":"https://api.github.com/users/sfuhrer/orgs","repos_url":"https://api.github.com/users/sfuhrer/repos","events_url":"https://api.github.com/users/sfuhrer/events{/privacy}","received_events_url":"https://api.github.com/users/sfuhrer/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":78699916,"node_id":"MDU6TGFiZWw3ODY5OTkxNg==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Fixed%20Wing%20%F0%9F%9B%A9%EF%B8%8F","name":"Fixed Wing 🛩️","color":"009800","default":false,"description":""},{"id":803319897,"node_id":"MDU6TGFiZWw4MDMzMTk4OTc=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/cleanup%20(housekeeping)%20%F0%9F%A7%B9","name":"cleanup (housekeeping) 🧹","color":"aefcbd","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"sfuhrer","id":26798987,"node_id":"MDQ6VXNlcjI2Nzk4OTg3","avatar_url":"https://avatars.githubusercontent.com/u/26798987?v=4","gravatar_id":"","url":"https://api.github.com/users/sfuhrer","html_url":"https://github.com/sfuhrer","followers_url":"https://api.github.com/users/sfuhrer/followers","following_url":"https://api.github.com/users/sfuhrer/following{/other_user}","gists_url":"https://api.github.com/users/sfuhrer/gists{/gist_id}","starred_url":"https://api.github.com/users/sfuhrer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfuhrer/subscriptions","organizations_url":"https://api.github.com/users/sfuhrer/orgs","repos_url":"https://api.github.com/users/sfuhrer/repos","events_url":"https://api.github.com/users/sfuhrer/events{/privacy}","received_events_url":"https://api.github.com/users/sfuhrer/received_events","type":"User","site_admin":false},"assignees":[{"login":"sfuhrer","id":26798987,"node_id":"MDQ6VXNlcjI2Nzk4OTg3","avatar_url":"https://avatars.githubusercontent.com/u/26798987?v=4","gravatar_id":"","url":"https://api.github.com/users/sfuhrer","html_url":"https://github.com/sfuhrer","followers_url":"https://api.github.com/users/sfuhrer/followers","following_url":"https://api.github.com/users/sfuhrer/following{/other_user}","gists_url":"https://api.github.com/users/sfuhrer/gists{/gist_id}","starred_url":"https://api.github.com/users/sfuhrer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfuhrer/subscriptions","organizations_url":"https://api.github.com/users/sfuhrer/orgs","repos_url":"https://api.github.com/users/sfuhrer/repos","events_url":"https://api.github.com/users/sfuhrer/events{/privacy}","received_events_url":"https://api.github.com/users/sfuhrer/received_events","type":"User","site_admin":false}],"milestone":null,"comments":0,"created_at":"2023-01-24T10:57:32Z","updated_at":"2023-01-26T16:04:45Z","closed_at":"2023-01-26T16:04:44Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20988","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20988","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20988.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20988.patch","merged_at":"2023-01-26T16:04:44Z"},"body":"\r\n### Solved Problem\r\nThe tecs_status.altitude_filtered field is filled with the reference altitude setpoint from tecs. This is fine, as with https://github.com/PX4/PX4-Autopilot/pull/20443 there is no more altitude input filtering happening inside TECS, and thus global_position.alt contains this information now. But then the field has to be renamed.\r\n\r\n\r\n### Solution\r\nRename field. This also required me to change how the [mavlink message](https://mavlink.io/en/messages/common.html#NAV_CONTROLLER_OUTPUT) get's it's alt_error field populated. \r\n\r\nAlong the way I did some clean up:\r\n- removed unused climbout flags (no loger necessary with the latest rework we did for FW takeoff)\r\n- add comments in .msg files\r\n- log tecs_status.pitch_integ in degrees instead of SEB_rate, as it that way is easier to make sense of\r\n\r\n### Context\r\nWe should move TECS to local position (control local_position.z instead of global_position.alt).\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20988/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20988/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20961","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20961/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20961/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20961/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20961","id":1548426314,"node_id":"PR_kwDOAFDaZs5IFf2m","number":20961,"title":"commander: avoid timestamp implicit float conversions","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2023-01-19T02:32:22Z","updated_at":"2023-01-19T22:48:42Z","closed_at":"2023-01-19T22:48:41Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20961","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20961","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20961.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20961.patch","merged_at":"2023-01-19T22:48:40Z"},"body":" - 64 bit time in microseconds stored in a 32 bit float quickly becomes problematic\r\n - fixes https://github.com/PX4/PX4-Autopilot/issues/20944\r\n\r\n@ecmnet","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20961/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20961/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20947","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20947/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20947/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20947/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20947","id":1535219529,"node_id":"PR_kwDOAFDaZs5He0fQ","number":20947,"title":"ekf2: PreFlightChecker fix vel_ne_innov_lpf index","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":666022583,"node_id":"MDU6TGFiZWw2NjYwMjI1ODM=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/EKF2","name":"EKF2","color":"1d76db","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2023-01-16T16:41:48Z","updated_at":"2023-01-17T18:03:40Z","closed_at":"2023-01-17T18:03:39Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20947","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20947","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20947.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20947.patch","merged_at":"2023-01-17T18:03:39Z"},"body":null,"reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20947/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20947/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20945","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20945/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20945/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20945/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20945","id":1535062115,"node_id":"PR_kwDOAFDaZs5HeSjY","number":20945,"title":"UAVCAN: Delay transmission until other nodes have booted","user":{"login":"niklaut","id":121870655,"node_id":"U_kgDOB0OZPw","avatar_url":"https://avatars.githubusercontent.com/u/121870655?v=4","gravatar_id":"","url":"https://api.github.com/users/niklaut","html_url":"https://github.com/niklaut","followers_url":"https://api.github.com/users/niklaut/followers","following_url":"https://api.github.com/users/niklaut/following{/other_user}","gists_url":"https://api.github.com/users/niklaut/gists{/gist_id}","starred_url":"https://api.github.com/users/niklaut/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/niklaut/subscriptions","organizations_url":"https://api.github.com/users/niklaut/orgs","repos_url":"https://api.github.com/users/niklaut/repos","events_url":"https://api.github.com/users/niklaut/events{/privacy}","received_events_url":"https://api.github.com/users/niklaut/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":581916348,"node_id":"MDU6TGFiZWw1ODE5MTYzNDg=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/uavcan","name":"uavcan","color":"2201AE","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":20,"created_at":"2023-01-16T14:47:49Z","updated_at":"2023-02-12T21:00:58Z","closed_at":"2023-02-12T21:00:57Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":true,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20945","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20945","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20945.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20945.patch","merged_at":null},"body":"\r\n<!--\r\n\r\nThank you for your contribution!\r\n\r\nGet early feedback through\r\n- Dronecode Discord: https://discord.gg/dronecode\r\n- PX4 Discuss: http://discuss.px4.io/\r\n- opening a draft pr and sharing the link\r\n\r\n-->\r\n\r\n### Solved Problem\r\n\r\nWhen powering the FMUv6x on with one or multiple ProfiCNC CANflow v4 nodes attached, enumeration fails. If the CANflow nodes are hot plugged, enumeration works fine. On the FMUv5x, enumeration works in both cases. Adding another UAVCAN node onto the bus (a NEO V2 pro), enumerates that node on the v6x too.\r\n\r\nAttaching a logic analyzer shows that both the FMU v6x/v5x flood the CAN bus with unacknowledged messages when the uavcan service starts, since the CANflow nodes are not yet configured and thus the unacked messages are automatically retransmitted by the CAN peripheral of the FMU.\r\nDisabling automatic retransmits breaks the UAVCAN protocol, since transmission failures are no longer reported (the peripheral turns off the error flags).\r\n\r\n![FMU flooding the bus with unacked messages](https://user-images.githubusercontent.com/121870655/212704672-acc76996-b0e2-4ba5-a009-890bc847956c.png)\r\n\r\nThe theory is that the FMUv6x boots faster than the FMUv5x and is therefore able to send more unacked messages to the CANflow node (running a STM32F3), which overflows the receive error counter (see RM0365 p982ff) and places the CANflow CAN peripheral into ERROR PASSIVE mode, perhaps even into BUS OFF state, if its transmit error counter overflows.\r\n\r\n![CAN error states](https://user-images.githubusercontent.com/121870655/212699223-30aaae48-12b6-4fda-9359-689d53781c09.png)\r\n\r\nI did not find any open source code for the CANflow node, so I cannot confirm it, however, simply delaying the transmission on the CAN bus prevents this situation by giving the CANflow node enough time to setup it's CAN peripheral without unacked message reception.\r\n\r\n### Solution\r\n\r\nI currently check that the uptime is at least 3 seconds after power up (determined experimentally) before allowing any transmissions on the bus.\r\nThis is a bit crude and should probably be done in another way, like sleeping in the thread that runs the UAVCAN node, but I don't understand the code fully yet.\r\n\r\n### Alternatives\r\n\r\nI think that the FMU should not flood the bus with unacked messages, however, adding some kind of bus probing mechanism that checks if the bus is even connected (ie. there is another node that can ACK) to prevent a NACK storm, seemed to complex for me to implement.\r\n\r\n### Test coverage\r\n\r\nTested in hardware with logging and one or two CANflow node on FMU v5x and v6x.\r\n\r\n### Context\r\n\r\n- STM32F3 Reference Manual Chapter 31 [RM0365](https://www.st.com/resource/en/reference_manual/rm0365-stm32f302xbcde-and-stm32f302x68-advanced-armbased-32bit-mcus-stmicroelectronics.pdf)\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20945/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20945/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20913","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20913/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20913/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20913/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20913","id":1530385408,"node_id":"PR_kwDOAFDaZs5HOox2","number":20913,"title":"VTOL Quad-chute: reset failure state once operator triggeres transition to FW again","user":{"login":"sfuhrer","id":26798987,"node_id":"MDQ6VXNlcjI2Nzk4OTg3","avatar_url":"https://avatars.githubusercontent.com/u/26798987?v=4","gravatar_id":"","url":"https://api.github.com/users/sfuhrer","html_url":"https://github.com/sfuhrer","followers_url":"https://api.github.com/users/sfuhrer/followers","following_url":"https://api.github.com/users/sfuhrer/following{/other_user}","gists_url":"https://api.github.com/users/sfuhrer/gists{/gist_id}","starred_url":"https://api.github.com/users/sfuhrer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfuhrer/subscriptions","organizations_url":"https://api.github.com/users/sfuhrer/orgs","repos_url":"https://api.github.com/users/sfuhrer/repos","events_url":"https://api.github.com/users/sfuhrer/events{/privacy}","received_events_url":"https://api.github.com/users/sfuhrer/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":249514594,"node_id":"MDU6TGFiZWwyNDk1MTQ1OTQ=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Hybrid%20VTOL%20%F0%9F%9B%A9%EF%B8%8F%F0%9F%9A%81","name":"Hybrid VTOL 🛩️🚁","color":"bfe5bf","default":false,"description":"Multirotor + Fixedwing!"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2023-01-12T09:28:58Z","updated_at":"2023-01-13T16:02:23Z","closed_at":"2023-01-13T16:02:22Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20913","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20913","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20913.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20913.patch","merged_at":"2023-01-13T16:02:22Z"},"body":"### Solved Problem\r\nMany people complained that it is not possible for them to transition back to FW after a quad-chute. Depending on how far away from Home the QC happened, transitioning to FW is the only way to get the vehicle back home and land it safely. As the trigger of a quad-chute is not a reliable source to determine the system health (is real hardware failure or did a large external disturbance cause the QC?), I find it better to give the operator the responsibility to judge the situation and trigger a transition to FW if deemed safe.\r\n\r\n### Solution\r\nReset the failure flag (`fixed_wing_system_failure`) on re-triggering of transition to FW, which then in turn allows the transition to happen int he first place. Before was only possible to reset it with a commanded transition to MC, which many ground station interfaces didn't allow as the system, after a quad-chute, already was in MC mode.\r\n\r\nWhile on it found that the newly introduced max altitude for quad-chute wrongly disabled QC completely when set to 0 (default). Fixed that in the 2nd commit.\r\n\r\nBeside that changed some variable names (fixed_wing_system_failure is more precise than transition_failure) and improved the meta data of some QC parameters.\r\n\r\n### Test coverage\r\nSITL tested.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20913/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20913/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20906","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20906/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20906/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20906/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20906","id":1529229555,"node_id":"PR_kwDOAFDaZs5HKtIR","number":20906,"title":"ekf2: fix global_pos alt_reset_counter publish","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":666022583,"node_id":"MDU6TGFiZWw2NjYwMjI1ODM=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/EKF2","name":"EKF2","color":"1d76db","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2023-01-11T15:13:26Z","updated_at":"2023-01-11T19:15:10Z","closed_at":"2023-01-11T19:15:08Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20906","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20906","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20906.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20906.patch","merged_at":"2023-01-11T19:15:08Z"},"body":" - fixes #20900","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20906/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20906/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20904","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20904/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20904/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20904/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20904","id":1529094253,"node_id":"PR_kwDOAFDaZs5HKPdF","number":20904,"title":"FW Att and Rate Controller, Tailsitter: fix tailsitter frame transformations","user":{"login":"sfuhrer","id":26798987,"node_id":"MDQ6VXNlcjI2Nzk4OTg3","avatar_url":"https://avatars.githubusercontent.com/u/26798987?v=4","gravatar_id":"","url":"https://api.github.com/users/sfuhrer","html_url":"https://github.com/sfuhrer","followers_url":"https://api.github.com/users/sfuhrer/followers","following_url":"https://api.github.com/users/sfuhrer/following{/other_user}","gists_url":"https://api.github.com/users/sfuhrer/gists{/gist_id}","starred_url":"https://api.github.com/users/sfuhrer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfuhrer/subscriptions","organizations_url":"https://api.github.com/users/sfuhrer/orgs","repos_url":"https://api.github.com/users/sfuhrer/repos","events_url":"https://api.github.com/users/sfuhrer/events{/privacy}","received_events_url":"https://api.github.com/users/sfuhrer/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":249514594,"node_id":"MDU6TGFiZWwyNDk1MTQ1OTQ=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Hybrid%20VTOL%20%F0%9F%9B%A9%EF%B8%8F%F0%9F%9A%81","name":"Hybrid VTOL 🛩️🚁","color":"bfe5bf","default":false,"description":"Multirotor + Fixedwing!"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2023-01-11T13:56:25Z","updated_at":"2023-01-13T17:18:13Z","closed_at":"2023-01-13T17:18:12Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20904","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20904","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20904.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20904.patch","merged_at":"2023-01-13T17:18:12Z"},"body":"### Solved Problem\r\nTailsitters that require control surfaces are currently broken on main since https://github.com/PX4/PX4-Autopilot/pull/20237, as we there forgot to do a couple of required tailsitter axes transformations. We didn't notice in SITL testing because the model there has 4 motors that it uses for hover control, without the need of control surfaces and thus the FW rate controller. \r\n\r\nProblem found by @Jaeyoung-Lim while working on https://github.com/PX4/PX4-Autopilot/pull/20859.\r\n\r\n### Solution\r\nStrictly follow the following convention for tailsitter: FW Attitude and FW rate controller always operate in the FW frame, meaning that roll is roll in FW, which for tailsitter means around the yaw axis in the body frame. The interfaces between modules is though always in body frame.\r\n\r\nThat enables us to do the axis transformations for tailsitter, that are currently distributed all over the controller (attitude, rate, vtol module), only at the input and output data of modules.\r\n\r\nSide effect is that the FW rate control tuning gains meanings change: while before the roll gains where meant for the body axis, they are now always applied for the FW roll axis (also in hover). So the naming now is correct for FW, while before it was for Hover.\r\n\r\n### Test coverage\r\nSITL tested for all modes and in both hover and aerodynamic flight, and hover tested on real platform.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20904/reactions","total_count":2,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":2,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20904/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20884","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20884/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20884/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20884/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20884","id":1523921193,"node_id":"PR_kwDOAFDaZs5G49Ug","number":20884,"title":"Kconfig: fix missing SERIAL_EXT2 (fmu-v5x/v6x)","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2023-01-07T15:35:16Z","updated_at":"2023-01-07T17:10:53Z","closed_at":"2023-01-07T17:10:52Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20884","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20884","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20884.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20884.patch","merged_at":"2023-01-07T17:10:52Z"},"body":"CONFIG_BOARD_SERIAL_EXT2 was being stripped out of fmu-v5x and fmu-v6x when updating all the configs (https://github.com/PX4/PX4-Autopilot/pull/20869).\r\n\r\nFYI @baumanta @bkueng ","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20884/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20884/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20873","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20873/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20873/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20873/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20873","id":1521611110,"node_id":"PR_kwDOAFDaZs5GxIq4","number":20873,"title":"sensors: fix overlapping ifdef","user":{"login":"julianoes","id":1419688,"node_id":"MDQ6VXNlcjE0MTk2ODg=","avatar_url":"https://avatars.githubusercontent.com/u/1419688?v=4","gravatar_id":"","url":"https://api.github.com/users/julianoes","html_url":"https://github.com/julianoes","followers_url":"https://api.github.com/users/julianoes/followers","following_url":"https://api.github.com/users/julianoes/following{/other_user}","gists_url":"https://api.github.com/users/julianoes/gists{/gist_id}","starred_url":"https://api.github.com/users/julianoes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/julianoes/subscriptions","organizations_url":"https://api.github.com/users/julianoes/orgs","repos_url":"https://api.github.com/users/julianoes/repos","events_url":"https://api.github.com/users/julianoes/events{/privacy}","received_events_url":"https://api.github.com/users/julianoes/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2023-01-05T23:25:54Z","updated_at":"2023-01-06T02:09:15Z","closed_at":"2023-01-06T02:09:14Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20873","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20873","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20873.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20873.patch","merged_at":"2023-01-06T02:09:14Z"},"body":"This fixes the case where vehicle_angular_rate is no longer started when airspeed is not enabled.\r\n\r\nSigned-off-by: Julian Oes <julian@oes.ch>\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20873/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20873/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20866","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20866/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20866/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20866/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20866","id":1519596975,"node_id":"PR_kwDOAFDaZs5GqKZO","number":20866,"title":"px4-rc.simulator shellcheck fixes","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2023-01-04T21:30:43Z","updated_at":"2023-01-04T22:35:42Z","closed_at":"2023-01-04T22:35:41Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20866","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20866","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20866.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20866.patch","merged_at":"2023-01-04T22:35:41Z"},"body":"![Screenshot from 2023-01-04 16-27-27](https://user-images.githubusercontent.com/84712/210653569-e3f2d593-1f3d-48e8-b137-b4aee38f96f0.png)\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20866/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20866/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20865","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20865/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20865/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20865/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20865","id":1519477809,"node_id":"PR_kwDOAFDaZs5GpwXU","number":20865,"title":"fix replay msg ids larger than 128","user":{"login":"dayjaby","id":164396,"node_id":"MDQ6VXNlcjE2NDM5Ng==","avatar_url":"https://avatars.githubusercontent.com/u/164396?v=4","gravatar_id":"","url":"https://api.github.com/users/dayjaby","html_url":"https://github.com/dayjaby","followers_url":"https://api.github.com/users/dayjaby/followers","following_url":"https://api.github.com/users/dayjaby/following{/other_user}","gists_url":"https://api.github.com/users/dayjaby/gists{/gist_id}","starred_url":"https://api.github.com/users/dayjaby/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dayjaby/subscriptions","organizations_url":"https://api.github.com/users/dayjaby/orgs","repos_url":"https://api.github.com/users/dayjaby/repos","events_url":"https://api.github.com/users/dayjaby/events{/privacy}","received_events_url":"https://api.github.com/users/dayjaby/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2023-01-04T19:35:35Z","updated_at":"2023-01-11T14:13:54Z","closed_at":"2023-01-11T14:13:54Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20865","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20865","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20865.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20865.patch","merged_at":"2023-01-11T14:13:54Z"},"body":"### Solved Problem\r\n@dagar When using replays, I found that several topics were not published at all. Digging deep I found that this happened for all uORB topics with a msg_id larger than 128. The old formula behaved weird when casting (signed) char to unsigned int16, so I made the calculation a bit more straightforward.\r\n\r\nBefore:\r\n\r\n```\r\nINFO  [replay] Topic estimator_optical_flow_vel got msg id 125\r\nERROR [replay] estimator_optical_flow_vel nextDataMessage 96242\r\nINFO  [replay] Topic estimator_optical_flow_vel got msg id 126\r\nERROR [replay] estimator_optical_flow_vel nextDataMessage 96274\r\nINFO  [replay] Topic estimator_optical_flow_vel got msg id 127\r\nERROR [replay] estimator_optical_flow_vel nextDataMessage 96306\r\nINFO  [replay] Topic estimator_optical_flow_vel got msg id 65408\r\nERROR [replay] estimator_optical_flow_vel nextDataMessage 96338\r\nINFO  [replay] Topic estimator_optical_flow_vel got msg id 65409\r\n```\r\nAfter:\r\n\r\n```\r\nINFO  [replay] Topic estimator_optical_flow_vel got msg id 125\r\nERROR [replay] estimator_optical_flow_vel nextDataMessage 96242\r\nINFO  [replay] Topic estimator_optical_flow_vel got msg id 126\r\nERROR [replay] estimator_optical_flow_vel nextDataMessage 96274\r\nINFO  [replay] Topic estimator_optical_flow_vel got msg id 127\r\nERROR [replay] estimator_optical_flow_vel nextDataMessage 96306\r\nINFO  [replay] Topic estimator_optical_flow_vel got msg id 128\r\nERROR [replay] estimator_optical_flow_vel nextDataMessage 96338\r\nINFO  [replay] Topic estimator_optical_flow_vel got msg id 129\r\n```\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20865/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20865/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20855","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20855/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20855/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20855/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20855","id":1517086651,"node_id":"PR_kwDOAFDaZs5Ghlf1","number":20855,"title":"SIH: start GPS driver (fmu-v5)","user":{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false},"assignees":[{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false}],"milestone":null,"comments":2,"created_at":"2023-01-03T08:46:31Z","updated_at":"2023-01-05T08:56:53Z","closed_at":"2023-01-04T21:26:16Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20855","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20855","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20855.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20855.patch","merged_at":"2023-01-04T21:26:16Z"},"body":"### Solved Problem\r\nFixes https://github.com/PX4/PX4-Autopilot/issues/20783\r\n\r\n### Solution\r\n`sensor_gps_sim` wasn't started for fmu-v5\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20855/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20855/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20840","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20840/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20840/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20840/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20840","id":1513886569,"node_id":"PR_kwDOAFDaZs5GWzwU","number":20840,"title":"EKF2: Only fuse fake yaw when really needed","user":{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":666022583,"node_id":"MDU6TGFiZWw2NjYwMjI1ODM=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/EKF2","name":"EKF2","color":"1d76db","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false},"assignees":[{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false}],"milestone":null,"comments":0,"created_at":"2022-12-29T16:35:05Z","updated_at":"2022-12-29T17:56:38Z","closed_at":"2022-12-29T17:56:37Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20840","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20840","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20840.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20840.patch","merged_at":"2022-12-29T17:56:37Z"},"body":"<!--\r\n\r\nThank you for your contribution!\r\n\r\nGet early feedback through\r\n- Dronecode Discord: https://discord.gg/dronecode\r\n- PX4 Discuss: http://discuss.px4.io/\r\n- opening a draft pr and sharing the link\r\n\r\n-->\r\n\r\n### Solved Problem\r\nWhen not using a mag (e.g.: after yaw emergency or mag type \"none\"), a yaw error isn't properly corrected even in presence of a large acceleration an a GNSS observation.\r\n\r\n### Solution\r\nConstantly fusing a zero yaw innovation makes the filter too confident about its yaw estimate and doesn't correct itself anymore. The proposed solution is to only fuse a fake yaw measurement when the yaw variance of the estimator is too large (i.e.: larger than its initialization value).\r\n\r\nOther changes:\r\n- do not run the mag selection/reset/fusion logic when the mag is inhibited\r\n- stop the mag fusion when the mag is constantly inhibited, this prevents having the mag fusion flag set while the fusion is not occurring for a long time.\r\n\r\n### Test coverage\r\nSITL test: mag type none, takeoff in alt mode, move to init yaw. After a couple of seconds, change the gyro bias to 0.1 rad/s\r\n\r\nbefore:\r\nThe gyro bias takes time to estimate and during that time, the drone makes a violent toilet bowl spiral. It ends up stopping navigation and falls back to alt mode after 2 yaw resets.\r\nhttps://logs.px4.io/plot_app?log=9619a774-677a-43e3-96c7-6dc710d1828e\r\n![DeepinScreenshot_select-area_20221229172559](https://user-images.githubusercontent.com/14822839/209981336-b4934b10-fb4b-41fa-97a1-82944e3819eb.png)\r\n\r\nthis PR:\r\nhttps://logs.px4.io/plot_app?log=e8694d1e-8798-4734-89fb-fd7e663bdfd5\r\nThe gyro bias is learned rapidly and a slight toilet bowl is enough to correct the yaw estimate properly.\r\n![DeepinScreenshot_select-area_20221229170529](https://user-images.githubusercontent.com/14822839/209981905-c5c5cdc0-7109-42d3-aaf9-4b54d37d02a0.png)\r\n\r\n\r\n- unit tests for the mag inhibition\r\n\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20840/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20840/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20835","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20835/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20835/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20835/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20835","id":1513197165,"node_id":"PR_kwDOAFDaZs5GUfjq","number":20835,"title":"platforms/nuttx: FATAL error if NSH enabled and SET disabled","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":581805812,"node_id":"MDU6TGFiZWw1ODE4MDU4MTI=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/NuttX%20(OS)","name":"NuttX (OS)","color":"3C33E3","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-12-28T22:00:40Z","updated_at":"2022-12-29T17:50:39Z","closed_at":"2022-12-29T17:50:38Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20835","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20835","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20835.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20835.patch","merged_at":"2022-12-29T17:50:38Z"},"body":"@PetervdPerk-NXP here's a quick idea to catch the problem more generally. https://github.com/PX4/PX4-Autopilot/pull/20812","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20835/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20835/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20826","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20826/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20826/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20826/events","html_url":"https://github.com/PX4/PX4-Autopilot/issues/20826","id":1508978607,"node_id":"I_kwDOAFDaZs5Z8S-v","number":20826,"title":"Cannot take off with x500 in (ignition) gazebo fortress","user":{"login":"Jaeyoung-Lim","id":5248102,"node_id":"MDQ6VXNlcjUyNDgxMDI=","avatar_url":"https://avatars.githubusercontent.com/u/5248102?v=4","gravatar_id":"","url":"https://api.github.com/users/Jaeyoung-Lim","html_url":"https://github.com/Jaeyoung-Lim","followers_url":"https://api.github.com/users/Jaeyoung-Lim/followers","following_url":"https://api.github.com/users/Jaeyoung-Lim/following{/other_user}","gists_url":"https://api.github.com/users/Jaeyoung-Lim/gists{/gist_id}","starred_url":"https://api.github.com/users/Jaeyoung-Lim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Jaeyoung-Lim/subscriptions","organizations_url":"https://api.github.com/users/Jaeyoung-Lim/orgs","repos_url":"https://api.github.com/users/Jaeyoung-Lim/repos","events_url":"https://api.github.com/users/Jaeyoung-Lim/events{/privacy}","received_events_url":"https://api.github.com/users/Jaeyoung-Lim/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":5143672048,"node_id":"LA_kwDOAFDaZs8AAAABMpY08A","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/gazebo","name":"gazebo","color":"F1DEAE","default":false,"description":"Gazebo simulator (gz)"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":10,"created_at":"2022-12-23T07:04:40Z","updated_at":"2023-03-28T09:46:13Z","closed_at":"2022-12-24T06:50:13Z","author_association":"MEMBER","active_lock_reason":null,"body":"## Describe the bug\r\nI tried to run SITL with ignition gazebo fortress on the current main, but the vehicle does not take off\r\n\r\n\r\n## To Reproduce\r\nSteps to reproduce the behavior:\r\n1. Run the following command as written in https://docs.px4.io/main/en/simulation/ignition_gazebo.html#running-the-simulation\r\n```\r\nmake px4_sitl gz_x500\r\n```\r\n2. In QGC, command a takeoff\r\n3. Vehicle does not take off from the ground\r\n\r\n## Expected behavior\r\nThe vehicle takes off and goes into hold mode\r\n\r\n## Log Files and Screenshots\r\n![image](https://user-images.githubusercontent.com/5248102/209289865-ee191150-c317-426b-9e14-58662653e23f.png)\r\n\r\n\r\n## Additional context\r\n@bperseghetti @dagar am I missing some context here? or is it expected to be broken?","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20826/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20826/timeline","performed_via_github_app":null,"state_reason":"completed"},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20824","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20824/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20824/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20824/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20824","id":1508798945,"node_id":"PR_kwDOAFDaZs5GF2IH","number":20824,"title":"mavlink_shell: fix stall on CubeOrange","user":{"login":"julianoes","id":1419688,"node_id":"MDQ6VXNlcjE0MTk2ODg=","avatar_url":"https://avatars.githubusercontent.com/u/1419688?v=4","gravatar_id":"","url":"https://api.github.com/users/julianoes","html_url":"https://github.com/julianoes","followers_url":"https://api.github.com/users/julianoes/followers","following_url":"https://api.github.com/users/julianoes/following{/other_user}","gists_url":"https://api.github.com/users/julianoes/gists{/gist_id}","starred_url":"https://api.github.com/users/julianoes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/julianoes/subscriptions","organizations_url":"https://api.github.com/users/julianoes/orgs","repos_url":"https://api.github.com/users/julianoes/repos","events_url":"https://api.github.com/users/julianoes/events{/privacy}","received_events_url":"https://api.github.com/users/julianoes/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2022-12-23T02:34:26Z","updated_at":"2023-01-05T00:12:20Z","closed_at":"2022-12-23T16:00:21Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20824","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20824","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20824.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20824.patch","merged_at":"2022-12-23T16:00:21Z"},"body":"On CubeOrange where no console is configured by default, starting MAVLink shell just stalls, and doesn't work.\r\n\r\nAlso, logfile download has been reported not to work, and again, seems to work with this change.\r\n\r\n@bkueng does this make any sense to you? Why are the `fflush`s required? \r\n\r\nRelated to #19831.","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20824/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20824/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20819","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20819/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20819/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20819/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20819","id":1507074372,"node_id":"PR_kwDOAFDaZs5F_5ig","number":20819,"title":"ekf2: push preflight filtered innovation checks into backend","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":10884840,"node_id":"MDU6TGFiZWwxMDg4NDg0MA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/enhancement%20(improvement)%20%F0%9F%92%A1","name":"enhancement (improvement) 💡","color":"84b6eb","default":false,"description":""},{"id":666022583,"node_id":"MDU6TGFiZWw2NjYwMjI1ODM=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/EKF2","name":"EKF2","color":"1d76db","default":false,"description":""}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-12-22T00:19:18Z","updated_at":"2023-01-15T23:04:47Z","closed_at":null,"author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20819","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20819","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20819.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20819.patch","merged_at":null},"body":" - move flags to EstimatorStatusFlags and update commander HealthAndArmingChecks usage\r\n - fixes bug with preflight vel failing if GPS or EV vet is available, but not active\r\n - fixes vel_n bug (vel_e typo) https://github.com/PX4/PX4-Autopilot/blob/03c0808ae674d5cc3f06f4a7ff5c4ce7f5e9e8fe/src/modules/ekf2/Utility/PreFlightChecker.cpp#L81\r\n - each filtered is updated with each new sample rather than at the rate of the ekf2 frontend\r\n - rejected innovations are excluded\r\n - duplicated control flag logic isn't required outside of the backend","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20819/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20819/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20818","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20818/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20818/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20818/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20818","id":1506973713,"node_id":"PR_kwDOAFDaZs5F_j_U","number":20818,"title":"ekf2: reinit baro height on sensor or calibration change","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":10884840,"node_id":"MDU6TGFiZWwxMDg4NDg0MA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/enhancement%20(improvement)%20%F0%9F%92%A1","name":"enhancement (improvement) 💡","color":"84b6eb","default":false,"description":""},{"id":666022583,"node_id":"MDU6TGFiZWw2NjYwMjI1ODM=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/EKF2","name":"EKF2","color":"1d76db","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2022-12-21T22:11:05Z","updated_at":"2022-12-29T21:37:35Z","closed_at":"2022-12-29T21:37:34Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20818","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20818","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20818.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20818.patch","merged_at":"2022-12-29T21:37:34Z"},"body":" - handle reset on delayed time horizon\r\n - avoid unnecessary preflight failures due to initial primary baro change (eg external DroneCAN barometer starting later than internal)\r\n\r\nhttps://review.px4.io/plot_app?log=0afe68b4-721d-4827-bf18-57c8f267592d\r\n![Screenshot from 2022-12-21 17-19-25](https://user-images.githubusercontent.com/84712/209013340-60b324c5-f6e1-4b36-8bc8-920140f2d747.png)\r\n\r\n![Screenshot from 2022-12-21 17-20-40](https://user-images.githubusercontent.com/84712/209013494-fd681f7d-af88-458f-927c-49dd50fc9ac7.png)\r\n\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20818/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20818/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20815","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20815/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20815/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20815/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20815","id":1506674992,"node_id":"PR_kwDOAFDaZs5F-i4R","number":20815,"title":" Auxiliary flight control actuator handling rework Take2","user":{"login":"sfuhrer","id":26798987,"node_id":"MDQ6VXNlcjI2Nzk4OTg3","avatar_url":"https://avatars.githubusercontent.com/u/26798987?v=4","gravatar_id":"","url":"https://api.github.com/users/sfuhrer","html_url":"https://github.com/sfuhrer","followers_url":"https://api.github.com/users/sfuhrer/followers","following_url":"https://api.github.com/users/sfuhrer/following{/other_user}","gists_url":"https://api.github.com/users/sfuhrer/gists{/gist_id}","starred_url":"https://api.github.com/users/sfuhrer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfuhrer/subscriptions","organizations_url":"https://api.github.com/users/sfuhrer/orgs","repos_url":"https://api.github.com/users/sfuhrer/repos","events_url":"https://api.github.com/users/sfuhrer/events{/privacy}","received_events_url":"https://api.github.com/users/sfuhrer/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":803319897,"node_id":"MDU6TGFiZWw4MDMzMTk4OTc=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/cleanup%20(housekeeping)%20%F0%9F%A7%B9","name":"cleanup (housekeeping) 🧹","color":"aefcbd","default":false,"description":""},{"id":5100420534,"node_id":"LA_kwDOAFDaZs8AAAABMAI9tg","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/release%20blocker%20%E2%9D%97%EF%B8%8F","name":"release blocker ❗️","color":"74C1F8","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":15,"created_at":"2022-12-21T17:31:53Z","updated_at":"2023-03-07T00:24:54Z","closed_at":"2023-03-06T21:43:42Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20815","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20815","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20815.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20815.patch","merged_at":"2023-03-06T21:43:42Z"},"body":"Alternative to https://github.com/PX4/PX4-Autopilot/pull/20724, based on https://github.com/PX4/PX4-Autopilot/pull/20237\r\n\r\nNew features:\r\n\r\n- enable flaperons (deflect ailerons down to act as flaps) and spoilerons (deflect ailerons up to act as spoilers) with control allocation (Fixes Control Allocator - Can't tie ailerons up (crow) to flap deployment #20694)\r\n- add option to map manual spoiler setpoint to Aux1 or the flaps channel (for linked deployment of flaps+spoiler with single knob/button)\r\n- enables landing gear logic for FW in Auto flight (retract after takeoff, deploy before landing)\r\n\r\nClean up:\r\n- removes collective tilt, landing gear, flaps, spoilers and airbrakes from actuator_controls --> enables us to get rid of actuator_controls\r\n- removes flaps/spoiler related fields from vehicle_attitdue_setpoint\r\n- remove `FW_DTRIM_P_SPOIL`, `FW_DTRIM_P_FLAPS` from the rate controller as the trimming can now be configured in the allocator\r\n\r\nHow it works:\r\n- add three new topics that replace current fields of actuator_controls, that are used to pass controller output to the allocation:\r\n```\r\ntiltrotor_extra_controls.msg\r\nflaps_setpoint.msg\r\nspoilers_setpoint.msg\r\n```\r\n![image](https://user-images.githubusercontent.com/26798987/213479994-a12de527-91c0-46ba-8416-301876128603.png)\r\n\r\n- allow several modules to publish same topic, and control through flags e.g. spoiler_setpoint from FWAttitudeController if `!flag_control_auto_enabled`, or FWPositionController if flag_control_auto_enabled and in FW flight, or VTOLAttitudeController if in Auto hover and VTOL.\r\n- manual flaps and spoiler control is done in FixedwingAttitudeController, in Auto flight in FixedwingPositionController \r\n- Control allocation side: same as in https://github.com/PX4/PX4-Autopilot/pull/20724, so: \r\n![image](https://user-images.githubusercontent.com/26798987/206231120-4b1612c1-0d36-4e98-9b8c-72af3b5bcadd.png)\r\n\r\n[Link to video benchtesting flaps/spoilers](https://discord.com/channels/1022170275984457759/1022186266957201480/1050083696075620443)\r\n\r\nComparison to https://github.com/PX4/PX4-Autopilot/pull/20724:\r\n+uses less custom topics\r\n+no additional module needed\r\n\r\n-multiple places to publish same topic instead of having a central place, with having to rely on flaps to turn on/off the publishing in the different controllers --> makes it more prone to errors and race conditions\r\n-manual flaps and spoiler control is done in FixedwingAttitudeController, which is a bit of a misuse of an \"attitude controller\", and is inconsistent with the callback of the attitude controller (which is attitude estimate, which isn't necessary for controlling flaps/spoilers in full Manual mode)\r\n\r\nArguably this can be done nicer once we have clear distinct flight modes, though it then would ofc mean that we will have to copy some of the logic into several modes (e.g. landing gear should be handles the same for all Manual modes).","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20815/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20815/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20793","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20793/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20793/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20793/events","html_url":"https://github.com/PX4/PX4-Autopilot/issues/20793","id":1502922608,"node_id":"I_kwDOAFDaZs5ZlMdw","number":20793,"title":"mRo Control Zero H7 support broken by 2cb4ef0629","user":{"login":"Ecuashungo","id":20953583,"node_id":"MDQ6VXNlcjIwOTUzNTgz","avatar_url":"https://avatars.githubusercontent.com/u/20953583?v=4","gravatar_id":"","url":"https://api.github.com/users/Ecuashungo","html_url":"https://github.com/Ecuashungo","followers_url":"https://api.github.com/users/Ecuashungo/followers","following_url":"https://api.github.com/users/Ecuashungo/following{/other_user}","gists_url":"https://api.github.com/users/Ecuashungo/gists{/gist_id}","starred_url":"https://api.github.com/users/Ecuashungo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Ecuashungo/subscriptions","organizations_url":"https://api.github.com/users/Ecuashungo/orgs","repos_url":"https://api.github.com/users/Ecuashungo/repos","events_url":"https://api.github.com/users/Ecuashungo/events{/privacy}","received_events_url":"https://api.github.com/users/Ecuashungo/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":4147343828,"node_id":"LA_kwDOAFDaZs73M3HU","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug-report","name":"bug-report","color":"376B2E","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"assignees":[{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},{"login":"davids5","id":1945821,"node_id":"MDQ6VXNlcjE5NDU4MjE=","avatar_url":"https://avatars.githubusercontent.com/u/1945821?v=4","gravatar_id":"","url":"https://api.github.com/users/davids5","html_url":"https://github.com/davids5","followers_url":"https://api.github.com/users/davids5/followers","following_url":"https://api.github.com/users/davids5/following{/other_user}","gists_url":"https://api.github.com/users/davids5/gists{/gist_id}","starred_url":"https://api.github.com/users/davids5/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davids5/subscriptions","organizations_url":"https://api.github.com/users/davids5/orgs","repos_url":"https://api.github.com/users/davids5/repos","events_url":"https://api.github.com/users/davids5/events{/privacy}","received_events_url":"https://api.github.com/users/davids5/received_events","type":"User","site_admin":false}],"milestone":null,"comments":5,"created_at":"2022-12-19T13:08:08Z","updated_at":"2022-12-28T22:01:00Z","closed_at":"2022-12-28T22:01:00Z","author_association":"NONE","active_lock_reason":null,"body":"## Describe the bug\r\nCommit 2cb4ef0629 breaks support for the control zero h7 board by mrobotics. Its parent commit (45b390b0bf) still works fine.\r\n\r\nYou get the following error in QGC: \r\n![image](https://user-images.githubusercontent.com/20953583/208430783-67134409-fc2a-4abf-8db6-b427b3d01ac9.png)\r\nand in the nutt-shell the `dmesg` command only returns `NuttShell (NSH) NuttX-11.0.0`.\r\n\r\n## To Reproduce\r\n1. Flash 2cb4ef0629 onto the control zero h7: `make mro_ctrl-zero-h7 upload`\r\n2. Open QGC and try to do the setup. I was not able to select an airframe.\r\n\r\n## Expected behavior\r\nI expect everything to work normally.\r\n\r\n## Drone (please complete the following information):\r\n- MRobotics Control Zero H7 with the aforementioned PX4-Autopilot software versions.\r\n\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20793/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20793/timeline","performed_via_github_app":null,"state_reason":"completed"},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20786","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20786/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20786/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20786/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20786","id":1499657851,"node_id":"PR_kwDOAFDaZs5FnHgG","number":20786,"title":"Fixed transition timer not being reset","user":{"login":"RomanBapst","id":7610489,"node_id":"MDQ6VXNlcjc2MTA0ODk=","avatar_url":"https://avatars.githubusercontent.com/u/7610489?v=4","gravatar_id":"","url":"https://api.github.com/users/RomanBapst","html_url":"https://github.com/RomanBapst","followers_url":"https://api.github.com/users/RomanBapst/followers","following_url":"https://api.github.com/users/RomanBapst/following{/other_user}","gists_url":"https://api.github.com/users/RomanBapst/gists{/gist_id}","starred_url":"https://api.github.com/users/RomanBapst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RomanBapst/subscriptions","organizations_url":"https://api.github.com/users/RomanBapst/orgs","repos_url":"https://api.github.com/users/RomanBapst/repos","events_url":"https://api.github.com/users/RomanBapst/events{/privacy}","received_events_url":"https://api.github.com/users/RomanBapst/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":249514594,"node_id":"MDU6TGFiZWwyNDk1MTQ1OTQ=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Hybrid%20VTOL%20%F0%9F%9B%A9%EF%B8%8F%F0%9F%9A%81","name":"Hybrid VTOL 🛩️🚁","color":"bfe5bf","default":false,"description":"Multirotor + Fixedwing!"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2022-12-16T06:09:45Z","updated_at":"2022-12-16T08:36:02Z","closed_at":"2022-12-16T08:36:01Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20786","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20786","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20786.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20786.patch","merged_at":"2022-12-16T08:36:01Z"},"body":"The transition timer state was only updated in the `VtolType::update_vtol_state` method. However, the timer value was being used in methods which were called prior to that. Thus it could happen that a backtransition was accepted immediately  due to the timer not having been reset.","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20786/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20786/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20774","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20774/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20774/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20774/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20774","id":1497121688,"node_id":"PR_kwDOAFDaZs5FeeRb","number":20774,"title":"icm42688p: fix register bank selection","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":1442874742,"node_id":"MDU6TGFiZWwxNDQyODc0NzQy","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Drivers%20%F0%9F%94%A7","name":"Drivers 🔧","color":"5d3ebc","default":false,"description":"Sensors, Actuators, etc"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2022-12-14T17:51:57Z","updated_at":"2023-01-18T16:08:05Z","closed_at":"2023-01-18T16:08:04Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20774","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20774","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20774.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20774.patch","merged_at":"2023-01-18T16:08:04Z"},"body":"Looks like we got away with this because the defaults for registers in bank 1 and bank 2 were mostly acceptable.\r\n\r\n![Screenshot from 2022-12-14 12-51-12](https://user-images.githubusercontent.com/84712/207670017-1bc92d24-8ba8-468f-8ae9-063e7d9a0ae4.png)\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20774/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20774/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20750","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20750/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20750/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20750/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20750","id":1492374525,"node_id":"PR_kwDOAFDaZs5FOBDR","number":20750,"title":"Revert \"Refactor quadchute logic (#20704)\"","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":249514594,"node_id":"MDU6TGFiZWwyNDk1MTQ1OTQ=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Hybrid%20VTOL%20%F0%9F%9B%A9%EF%B8%8F%F0%9F%9A%81","name":"Hybrid VTOL 🛩️🚁","color":"bfe5bf","default":false,"description":"Multirotor + Fixedwing!"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2022-12-12T17:19:44Z","updated_at":"2022-12-13T14:05:44Z","closed_at":"2022-12-13T09:45:52Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20750","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20750","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20750.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20750.patch","merged_at":null},"body":"The MAVSDK SITL tailsitter test started failing after https://github.com/PX4/PX4-Autopilot/pull/20704 merged, possibly due to tailsitter not transitioning leading to the mission test timing out.\r\n\r\nIt starts passing if the change is reverted.\r\n\r\nThis reverts commit cfb670fbb37b18e1d145d86caa9244cfa7373869.\r\n\r\n@RomanBapst @sfuhrer have time to investigate a proper fix or should we temporarily revert?","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20750/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20750/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20703","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20703/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20703/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20703/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20703","id":1476808369,"node_id":"PR_kwDOAFDaZs5EW0Dx","number":20703,"title":"DataValidator: fix unexpected fail-over","user":{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":1442627275,"node_id":"MDU6TGFiZWwxNDQyNjI3Mjc1","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Sensors","name":"Sensors","color":"48c13e","default":false,"description":"All the sensors!"}],"state":"closed","locked":false,"assignee":{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false},"assignees":[{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false}],"milestone":null,"comments":1,"created_at":"2022-12-05T15:22:30Z","updated_at":"2022-12-06T07:16:25Z","closed_at":"2022-12-06T07:16:23Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20703","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20703","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20703.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20703.patch","merged_at":"2022-12-06T07:16:23Z"},"body":"### Solved Problem\r\nA single error makes the selector switch from the primary mag to a secondary one because it is on instance 1 while the internal one is on instance 0.\r\nThis is because currently, the the best instance is selected but it is harder for an instance with a higher number to be selected because they need to be strictly better than the instance with a lower number.\r\nIMO, the initial intent was to keep the currently selected instance until a problem is detected or if a good instance with a higher priority is available.\r\n\r\n### Solution\r\nInstead of always starting with instance 0 (potentially an internal mag), first take the current sensor as reference to\r\ncompare the other ones against it.\r\n\r\n### Test coverage\r\ntested on v5 by hacking a change of confidence when a sensor is disconnected instead of triggering a timeout\r\n\r\nFYI: @bkueng ","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20703/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20703/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20695","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20695/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20695/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20695/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20695","id":1471679688,"node_id":"PR_kwDOAFDaZs5EFEyE","number":20695,"title":"Manual control mode requirement for manual modes","user":{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false},"assignees":[{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false}],"milestone":null,"comments":1,"created_at":"2022-12-01T17:21:17Z","updated_at":"2023-03-08T08:36:28Z","closed_at":"2023-03-08T08:32:57Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20695","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20695","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20695.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20695.patch","merged_at":"2023-03-08T08:32:56Z"},"body":"### Solved Problem\r\nWhen switching to a manual mode (Manual, Acro, Stabilized, Altitude, Position) without a stick input source it is currently possible to arm and stay in the mode.\r\n\r\nFixes https://github.com/PX4/PX4-Autopilot/pull/20172#discussion_r988214569\r\n\r\n### Solution\r\n#### Requirements\r\n1. **[untouched]** Stick input disabled and not required -> Nothing\r\n2. **[untouched]** Stick input present but lost in flight -> Failsafe NAV_RCL_ACT (tested with RTL only!)\r\n3. **[mandatory]** Manual mode (Manual, Acro, Stabilized, Altitude, Position) and disabled or unavailable stick input -> Error\r\n4. **[nice to have]** Stick input enabled but not present when not required -> Warning\r\n\r\n|  | RC required | RC not required |\r\n|---|---|---|\r\n| RC disabled | Error 3. | OK 1. |\r\n| RC enabled not present | Error 3. | Warn 4. |\r\n| RC enabled and present | OK | OK |\r\n\r\n#### Steps/commits\r\n- Establish manual control as mode requirement for manual modes working towards 3.\r\n- Make sure the manual control availability flag `manual_control_signal_lost` gets updated also when manual control is disabled and remove the existing manual control check to establish 3.\r\n- Minor reorder\r\n- ~Add back a revised second manual control check for 4.~\r\n- ~Suggestion to allow a check to just publish a warning (no failure) but only for certain modes. Originally that's only possible for all modes see https://github.com/PX4/PX4-Autopilot/blob/c5dc1221b68352725630cbda5c04bc0f5c3c1617/src/modules/commander/HealthAndArmingChecks/Common.hpp#L239 https://github.com/PX4/PX4-Autopilot/blob/c5dc1221b68352725630cbda5c04bc0f5c3c1617/src/modules/commander/HealthAndArmingChecks/Common.cpp#L92-L95. Alternatively the condition outside the check could look at the mode and requirement mask but that's in my eyes worse. Not sure if you have a better idea to achieve 3. and 4. without having a duplicate event with RC enabled and required but not present:~\r\n- **EDIT:** I now replaced my above suggestion with the discussed solution of only publishing one event for \"No manual control input\" but making the severity and mode mask dependent on if stick input is enabled or not. It's much simpler 👍  The only downside to this is that if RC is enabled the severity for it being not available is always a warning (details text in orange). Still, it doesn't allow arming in manual modes (top bar red) and switching to manual modes in the air. I think that's worth it.\r\n<img width=\"177\" alt=\"warning and requirement\" src=\"https://user-images.githubusercontent.com/4668506/223662822-2a13a7ae-37b6-4f94-b602-af1b91df74a2.png\">\r\n\r\n### ~Alternatives~\r\n- ~We can move on with just the first 3 commits and move 4. to a different pr.~\r\n- ~We can move on with just the first 4 commits but then there's a duplicate event in the 4. case:\r\n  <img width=\"177\" alt=\"warning and requirement\" src=\"https://user-images.githubusercontent.com/4668506/205116148-30f40268-4654-432e-86fa-292399602add.png\">~\r\n\r\n### Test coverage\r\nI successfully tested the entire case table above in SITL with a joystick using:\r\n- RC disabled: `COM_RC_IN_MODE` Disabled\r\n- RC enabled not present: `COM_RC_IN_MODE` set to RC only\r\n- RC enabled and present: `COM_RC_IN_MODE` set to Joystick only","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20695/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20695/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20679","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20679/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20679/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20679/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20679","id":1468301347,"node_id":"PR_kwDOAFDaZs5D5osq","number":20679,"title":"ekf2: don't add invalid GNSS samples to the buffer","user":{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false},"assignees":[{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false}],"milestone":null,"comments":2,"created_at":"2022-11-29T15:57:25Z","updated_at":"2022-11-30T08:33:03Z","closed_at":"2022-11-30T05:22:15Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20679","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20679","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20679.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20679.patch","merged_at":"2022-11-30T05:22:15Z"},"body":"### Solved Problem\r\nEKF2 never gives up on fusing GNSS data once the fusion started if there is no other horizontal aiding source available. The issue is that even if the receiver reports an invalid fix, the data is still used and the vehicle never goes into failsafe.\r\n\r\n### Solution\r\nDo not add an invalid GNSS sample to the buffer.\r\n\r\n### Alternatives\r\nStore this flag in the buffer and add it to the mandatory conditions in GPS_control\r\n\r\n### Context\r\nIn SIH, when the GNSS fails, the eph and epv are increased, and the `vel_ned_valid` flag is set to `false` but the drone continues to fly in position or auto mode and drifts away.\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20679/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20679/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20676","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20676/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20676/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20676/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20676","id":1467292254,"node_id":"PR_kwDOAFDaZs5D2QNh","number":20676,"title":"create Welford mean Vector with covariance and improve precision with Kahan summation","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":10884840,"node_id":"MDU6TGFiZWwxMDg4NDg0MA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/enhancement%20(improvement)%20%F0%9F%92%A1","name":"enhancement (improvement) 💡","color":"84b6eb","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2022-11-29T01:01:13Z","updated_at":"2022-11-30T19:50:15Z","closed_at":"2022-11-30T19:50:14Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20676","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20676","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20676.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20676.patch","merged_at":"2022-11-30T19:50:14Z"},"body":" - WelfordMeanVector now computes covariance\r\n - use Kahan summation for Welford mean (but continue using float32 for actual mean, etc)\r\n - WelfordMean and WelfordMeanVector handle initial value and count roll over\r\n - Welford mean count rollover at 16 bit max to prevent numerical issues and shift weight to newer samples\r\n - sensors/vehicle_imu: update Welford mean usage (now simplified with resets removed)\r\n    - fix vehicle_imu_status accel var, now properly rotated with full covariance matrix\r\n - gyro_calibration: update Welford mean usage\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20676/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":1,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20676/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20669","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20669/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20669/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20669/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20669","id":1463577936,"node_id":"PR_kwDOAFDaZs5DqKXi","number":20669,"title":"Fix invalid offboard setpoints for fw pos control","user":{"login":"Jaeyoung-Lim","id":5248102,"node_id":"MDQ6VXNlcjUyNDgxMDI=","avatar_url":"https://avatars.githubusercontent.com/u/5248102?v=4","gravatar_id":"","url":"https://api.github.com/users/Jaeyoung-Lim","html_url":"https://github.com/Jaeyoung-Lim","followers_url":"https://api.github.com/users/Jaeyoung-Lim/followers","following_url":"https://api.github.com/users/Jaeyoung-Lim/following{/other_user}","gists_url":"https://api.github.com/users/Jaeyoung-Lim/gists{/gist_id}","starred_url":"https://api.github.com/users/Jaeyoung-Lim/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Jaeyoung-Lim/subscriptions","organizations_url":"https://api.github.com/users/Jaeyoung-Lim/orgs","repos_url":"https://api.github.com/users/Jaeyoung-Lim/repos","events_url":"https://api.github.com/users/Jaeyoung-Lim/events{/privacy}","received_events_url":"https://api.github.com/users/Jaeyoung-Lim/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":78699916,"node_id":"MDU6TGFiZWw3ODY5OTkxNg==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Fixed%20Wing%20%F0%9F%9B%A9%EF%B8%8F","name":"Fixed Wing 🛩️","color":"009800","default":false,"description":""},{"id":1442618266,"node_id":"MDU6TGFiZWwxNDQyNjE4MjY2","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Offboard","name":"Offboard","color":"d8954e","default":false,"description":"Offboard mode control"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-11-24T16:24:43Z","updated_at":"2022-11-30T08:14:59Z","closed_at":"2022-11-30T08:14:58Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20669","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20669","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20669.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20669.patch","merged_at":"2022-11-30T08:14:58Z"},"body":"### Solved Problem\r\nThis commit fixes a regression that caused problems when trying to use offboard control with fixedwings (or VTOLs in fixedwing mode)\r\n\r\nThe problem was that all offboard setpoints were considered invalid in offboard mode:\r\n![image](https://user-images.githubusercontent.com/5248102/203829851-55e1195d-9498-44be-aa6e-1e67db5f7ae5.png)\r\n![image](https://user-images.githubusercontent.com/5248102/203829872-ccfb20a0-c004-4592-bbfe-f7160d51c7bd.png)\r\n\r\n### Solution\r\nThis was a regression introduced by https://github.com/PX4/PX4-Autopilot/pull/19942, where the valid flag in position_setpoint_triplet was no longer being used and the offboard logic was left out.\r\n\r\n### Test coverage\r\nTested in SITL Gazebo and publishing offboard setpoints\r\n- Flight logs before PR: https://review.px4.io/plot_app?log=b46b490c-69f8-4fe1-a47f-b16fc6ab8b54\r\n- Flight logs after PR: https://review.px4.io/plot_app?log=ced912ac-1b8d-427e-8829-90337d208482\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20669/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20669/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20661","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20661/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20661/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20661/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20661","id":1462102913,"node_id":"PR_kwDOAFDaZs5DlKDJ","number":20661,"title":"[RELEASE/1.13] GyroCalibration: consider updated temperature compensation offset","user":{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false},"assignees":[{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false}],"milestone":null,"comments":0,"created_at":"2022-11-23T17:00:12Z","updated_at":"2022-11-23T19:25:32Z","closed_at":"2022-11-23T19:25:31Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20661","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20661","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20661.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20661.patch","merged_at":"2022-11-23T19:25:31Z"},"body":"backport of https://github.com/PX4/PX4-Autopilot/pull/20660","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20661/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20661/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20660","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20660/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20660/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20660/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20660","id":1462079960,"node_id":"PR_kwDOAFDaZs5DlE-4","number":20660,"title":"GyroCalibration: consider updated temperature compensation offset","user":{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false},"assignees":[{"login":"bresch","id":14822839,"node_id":"MDQ6VXNlcjE0ODIyODM5","avatar_url":"https://avatars.githubusercontent.com/u/14822839?v=4","gravatar_id":"","url":"https://api.github.com/users/bresch","html_url":"https://github.com/bresch","followers_url":"https://api.github.com/users/bresch/followers","following_url":"https://api.github.com/users/bresch/following{/other_user}","gists_url":"https://api.github.com/users/bresch/gists{/gist_id}","starred_url":"https://api.github.com/users/bresch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bresch/subscriptions","organizations_url":"https://api.github.com/users/bresch/orgs","repos_url":"https://api.github.com/users/bresch/repos","events_url":"https://api.github.com/users/bresch/events{/privacy}","received_events_url":"https://api.github.com/users/bresch/received_events","type":"User","site_admin":false}],"milestone":null,"comments":0,"created_at":"2022-11-23T16:44:03Z","updated_at":"2022-11-23T18:24:44Z","closed_at":"2022-11-23T18:24:43Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20660","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20660","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20660.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20660.patch","merged_at":"2022-11-23T18:24:43Z"},"body":"### Solved Problem\r\nWhen temperature compensation is active, it happened that the sensor offset was compensated twice because the `GyroCalibration` \"auto-calibration\" was not considering the new thermal offset when updating the calibration.\r\n\r\nAlso reset the offset and scale parameters as the thermal calibration does not consider those values when gathering data.\r\n\r\n### Test coverage\r\nbench tests on Pixhawk5","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20660/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20660/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20651","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20651/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20651/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20651/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20651","id":1459639990,"node_id":"PR_kwDOAFDaZs5Dcp1B","number":20651,"title":"fix pwm_out, px4io: prevent disarm and rate param updates during boot ","user":{"login":"bkueng","id":281593,"node_id":"MDQ6VXNlcjI4MTU5Mw==","avatar_url":"https://avatars.githubusercontent.com/u/281593?v=4","gravatar_id":"","url":"https://api.github.com/users/bkueng","html_url":"https://github.com/bkueng","followers_url":"https://api.github.com/users/bkueng/followers","following_url":"https://api.github.com/users/bkueng/following{/other_user}","gists_url":"https://api.github.com/users/bkueng/gists{/gist_id}","starred_url":"https://api.github.com/users/bkueng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bkueng/subscriptions","organizations_url":"https://api.github.com/users/bkueng/orgs","repos_url":"https://api.github.com/users/bkueng/repos","events_url":"https://api.github.com/users/bkueng/events{/privacy}","received_events_url":"https://api.github.com/users/bkueng/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2022-11-22T11:01:44Z","updated_at":"2022-11-22T18:41:17Z","closed_at":"2022-11-22T18:41:16Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20651","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20651","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20651.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20651.patch","merged_at":"2022-11-22T18:41:16Z"},"body":"Before, the logic to update disarm and rate values also triggered during\r\nbootup on the px4io, because the output functions are only set in\r\nupdateSubscriptions().\r\nTherefore change the check to prevent updating during the first cycle.\r\n\r\n@sfuhrer @ryanjAA ","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20651/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20651/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20638","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20638/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20638/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20638/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20638","id":1455326560,"node_id":"PR_kwDOAFDaZs5DOG3l","number":20638,"title":"FW Attidue Controller: use FW_AIRSPD_MIN for DTRIM instead of STALL","user":{"login":"sfuhrer","id":26798987,"node_id":"MDQ6VXNlcjI2Nzk4OTg3","avatar_url":"https://avatars.githubusercontent.com/u/26798987?v=4","gravatar_id":"","url":"https://api.github.com/users/sfuhrer","html_url":"https://github.com/sfuhrer","followers_url":"https://api.github.com/users/sfuhrer/followers","following_url":"https://api.github.com/users/sfuhrer/following{/other_user}","gists_url":"https://api.github.com/users/sfuhrer/gists{/gist_id}","starred_url":"https://api.github.com/users/sfuhrer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfuhrer/subscriptions","organizations_url":"https://api.github.com/users/sfuhrer/orgs","repos_url":"https://api.github.com/users/sfuhrer/repos","events_url":"https://api.github.com/users/sfuhrer/events{/privacy}","received_events_url":"https://api.github.com/users/sfuhrer/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":78699916,"node_id":"MDU6TGFiZWw3ODY5OTkxNg==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Fixed%20Wing%20%F0%9F%9B%A9%EF%B8%8F","name":"Fixed Wing 🛩️","color":"009800","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-11-18T15:26:05Z","updated_at":"2022-11-18T16:25:11Z","closed_at":"2022-11-18T16:25:10Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20638","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20638","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20638.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20638.patch","merged_at":"2022-11-18T16:25:10Z"},"body":"This is to make it again in line with the parameter description and docs\r\n\r\n\r\n","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20638/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20638/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20621","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20621/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20621/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20621/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20621","id":1452107309,"node_id":"PR_kwDOAFDaZs5DDRuI","number":20621,"title":"Fix CANNODE_SUB_MBD typo and broken GPS_UBX_MODE param. Update GPS Submodule. Increase allowed RTK injections.","user":{"login":"AlexKlimaj","id":2019539,"node_id":"MDQ6VXNlcjIwMTk1Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/2019539?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexKlimaj","html_url":"https://github.com/AlexKlimaj","followers_url":"https://api.github.com/users/AlexKlimaj/followers","following_url":"https://api.github.com/users/AlexKlimaj/following{/other_user}","gists_url":"https://api.github.com/users/AlexKlimaj/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexKlimaj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexKlimaj/subscriptions","organizations_url":"https://api.github.com/users/AlexKlimaj/orgs","repos_url":"https://api.github.com/users/AlexKlimaj/repos","events_url":"https://api.github.com/users/AlexKlimaj/events{/privacy}","received_events_url":"https://api.github.com/users/AlexKlimaj/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2022-11-16T18:49:30Z","updated_at":"2022-11-18T16:08:10Z","closed_at":"2022-11-18T16:04:18Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20621","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20621","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20621.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20621.patch","merged_at":"2022-11-18T16:04:18Z"},"body":"Fixes a typo in my last PR for CANNODE_SUB_MBD. Increase the allowed RTK injections to match the uorb queue depth. Update GPS submodule with fixed UBX_MODE enum. ","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20621/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20621/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20605","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20605/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20605/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20605/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20605","id":1448489691,"node_id":"PR_kwDOAFDaZs5C3H0L","number":20605,"title":"Avoid invalid setpoint message when switching to altitude controlled mode","user":{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":78699954,"node_id":"MDU6TGFiZWw3ODY5OTk1NA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/Multirotor%20%F0%9F%9B%B8","name":"Multirotor 🛸","color":"0052cc","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false},"assignees":[{"login":"MaEtUgR","id":4668506,"node_id":"MDQ6VXNlcjQ2Njg1MDY=","avatar_url":"https://avatars.githubusercontent.com/u/4668506?v=4","gravatar_id":"","url":"https://api.github.com/users/MaEtUgR","html_url":"https://github.com/MaEtUgR","followers_url":"https://api.github.com/users/MaEtUgR/followers","following_url":"https://api.github.com/users/MaEtUgR/following{/other_user}","gists_url":"https://api.github.com/users/MaEtUgR/gists{/gist_id}","starred_url":"https://api.github.com/users/MaEtUgR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaEtUgR/subscriptions","organizations_url":"https://api.github.com/users/MaEtUgR/orgs","repos_url":"https://api.github.com/users/MaEtUgR/repos","events_url":"https://api.github.com/users/MaEtUgR/events{/privacy}","received_events_url":"https://api.github.com/users/MaEtUgR/received_events","type":"User","site_admin":false}],"milestone":null,"comments":4,"created_at":"2022-11-14T17:50:56Z","updated_at":"2022-11-22T15:03:42Z","closed_at":"2022-11-22T15:03:41Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20605","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20605","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20605.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20605.patch","merged_at":"2022-11-22T15:03:41Z"},"body":"## Describe problem solved by this pull request\r\nRight now on main there's a high chance that if you switch from a non altitude controlled mode e.g. stabilized to an altitude controlled one e.g. altitude that you get a message for invalid setpoint. This is because https://github.com/PX4/PX4-Autopilot/pull/19162 solved the issue where no valid setpoint is present yet by just generating a failsafe setpoint. And I think originally it was supposed to not show the message but now it does.\r\n\r\n## Describe your solution\r\nI just don't show the message when the failsafe setpoint is generated to bridge the mode switch.\r\n\r\n## Describe possible alternatives\r\nI plan to change the logic as part of simplifying the entire wrapping logic for takeoff and landing but in the meantime we need a fix for the user experience on main.\r\n\r\n## Test data / coverage\r\nI tested this in SITL. The message doesn't show up anymore.","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20605/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20605/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20597","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20597/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20597/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20597/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20597","id":1446057207,"node_id":"PR_kwDOAFDaZs5Cu-lb","number":20597,"title":"Move uavcan start to end of rcS to prevent sd card read lock","user":{"login":"AlexKlimaj","id":2019539,"node_id":"MDQ6VXNlcjIwMTk1Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/2019539?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexKlimaj","html_url":"https://github.com/AlexKlimaj","followers_url":"https://api.github.com/users/AlexKlimaj/followers","following_url":"https://api.github.com/users/AlexKlimaj/following{/other_user}","gists_url":"https://api.github.com/users/AlexKlimaj/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexKlimaj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexKlimaj/subscriptions","organizations_url":"https://api.github.com/users/AlexKlimaj/orgs","repos_url":"https://api.github.com/users/AlexKlimaj/repos","events_url":"https://api.github.com/users/AlexKlimaj/events{/privacy}","received_events_url":"https://api.github.com/users/AlexKlimaj/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":581916348,"node_id":"MDU6TGFiZWw1ODE5MTYzNDg=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/uavcan","name":"uavcan","color":"2201AE","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2022-11-11T22:23:41Z","updated_at":"2023-05-30T16:08:45Z","closed_at":"2022-11-14T14:32:11Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20597","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20597","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20597.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20597.patch","merged_at":"2022-11-14T14:32:11Z"},"body":"This PR moves the uavcan startup to the end of the rcS script. I have been seeing an issue on and off on different autopilots where when on battery power, uavcannodes sometimes won't boot. It looks like it is caused by the uavcan firmware server spinning on the sd card firmware read. When this occurs, no other task can read the SD.\r\n\r\nMoving the uavcan start call to the end of the rcS script appears to solve the problem. Could be related to logger start timing.","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20597/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20597/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20596","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20596/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20596/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20596/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20596","id":1445804680,"node_id":"PR_kwDOAFDaZs5CuHcZ","number":20596,"title":"Revert \"Update MAVLink so common includes standard (#20542)\"","user":{"login":"AlexKlimaj","id":2019539,"node_id":"MDQ6VXNlcjIwMTk1Mzk=","avatar_url":"https://avatars.githubusercontent.com/u/2019539?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexKlimaj","html_url":"https://github.com/AlexKlimaj","followers_url":"https://api.github.com/users/AlexKlimaj/followers","following_url":"https://api.github.com/users/AlexKlimaj/following{/other_user}","gists_url":"https://api.github.com/users/AlexKlimaj/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexKlimaj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexKlimaj/subscriptions","organizations_url":"https://api.github.com/users/AlexKlimaj/orgs","repos_url":"https://api.github.com/users/AlexKlimaj/repos","events_url":"https://api.github.com/users/AlexKlimaj/events{/privacy}","received_events_url":"https://api.github.com/users/AlexKlimaj/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2022-11-11T17:42:41Z","updated_at":"2022-11-16T01:46:44Z","closed_at":"2022-11-15T18:09:56Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20596","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20596","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20596.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20596.patch","merged_at":"2022-11-15T18:09:56Z"},"body":"This PR reverts #20542 which causes communication failure with QGC.","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20596/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20596/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20595","repository_url":"https://api.github.com/repos/PX4/PX4-Autopilot","labels_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20595/labels{/name}","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20595/comments","events_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20595/events","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20595","id":1445783958,"node_id":"PR_kwDOAFDaZs5CuC9J","number":20595,"title":"ekf2: cleanup terrain estimator init (shouldn't be valid by default)","user":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"labels":[{"id":10884838,"node_id":"MDU6TGFiZWwxMDg4NDgzOA==","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":666022583,"node_id":"MDU6TGFiZWw2NjYwMjI1ODM=","url":"https://api.github.com/repos/PX4/PX4-Autopilot/labels/EKF2","name":"EKF2","color":"1d76db","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2022-11-11T17:22:48Z","updated_at":"2022-11-14T14:29:48Z","closed_at":"2022-11-14T14:29:47Z","author_association":"MEMBER","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/pulls/20595","html_url":"https://github.com/PX4/PX4-Autopilot/pull/20595","diff_url":"https://github.com/PX4/PX4-Autopilot/pull/20595.diff","patch_url":"https://github.com/PX4/PX4-Autopilot/pull/20595.patch","merged_at":"2022-11-14T14:29:47Z"},"body":"- with `Ekf::initialiseFilter()` resetting _time_last_hagl_fuse the terrain estimate was technically valid regardless of any range or flow data availability\r\n- as a result optical flow fusion is able to start and stay active\r\n- only consider terrain estimate valid based on control status flags and recent fusion","reactions":{"url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20595/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PX4/PX4-Autopilot/issues/20595/timeline","performed_via_github_app":null,"state_reason":null},